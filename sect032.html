<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Analyse centrographique | Notes de cours GMQ405 : Modélisation et analyse spatiale</title>
  <meta name="description" content="Mettre le description du cours." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Analyse centrographique | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Mettre le description du cours." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Analyse centrographique | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  
  <meta name="twitter:description" content="Mettre le description du cours." />
  <meta name="twitter:image" content="/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio, département de géomatique appliquée, Université de Sherbrooke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect031.html"/>
<link rel="next" href="sect033.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GMQ405 : modélisation et analyse spatiale</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Comment lire ce manuel?</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en géomatique appliquée et utiliser R?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
</ul></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Manipulation des données spatiales dans R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Importation de données géographiques</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sect011.html"><a href="sect011.html#sect0111"><i class="fa fa-check"></i><b>1.1.1</b> Importation de données vectorielles</a></li>
<li class="chapter" data-level="1.1.2" data-path="sect011.html"><a href="sect011.html#sect0112"><i class="fa fa-check"></i><b>1.1.2</b> Importation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Manipulation de données vectorielles</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Fonctions relatives à la projection cartographique</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Fonctions d’opérations géométriques sur une couche</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect01213"><i class="fa fa-check"></i><b>1.2.3</b> Fonctions d’opérations géométriques entre deux couches</a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#sect0124"><i class="fa fa-check"></i><b>1.2.4</b> Fonctions de mesures géométriques et de récupération des coordonnées géographiques</a></li>
<li class="chapter" data-level="1.2.5" data-path="sect012.html"><a href="sect012.html#sect0125"><i class="fa fa-check"></i><b>1.2.5</b> Jointures spatiales</a></li>
<li class="chapter" data-level="1.2.6" data-path="sect012.html"><a href="sect012.html#sect0126"><i class="fa fa-check"></i><b>1.2.6</b> Requêtes spatiales</a></li>
<li class="chapter" data-level="1.2.7" data-path="sect012.html"><a href="sect012.html#sect0127"><i class="fa fa-check"></i><b>1.2.7</b> Manipulation des données attributaires</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Manipulation de données matricielles (<em>raster</em>)</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> Mosaïquage et découpage d’images</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Requêtes attributaires sur des images</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Exportation de données spatiales de R vers des formats géographiques</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Exportation de données vectorielles <code>sf</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Exportation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect015.html"><a href="sect015.html"><i class="fa fa-check"></i><b>1.5</b> Cartographie avec R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sect015.html"><a href="sect015.html#sect0151"><i class="fa fa-check"></i><b>1.5.1</b> Manipulation des couches géométriques</a></li>
<li class="chapter" data-level="1.5.2" data-path="sect015.html"><a href="sect015.html#sect0152"><i class="fa fa-check"></i><b>1.5.2</b> Cartes interactives</a></li>
<li class="chapter" data-level="1.5.3" data-path="sect015.html"><a href="sect015.html#sect0153"><i class="fa fa-check"></i><b>1.5.3</b> Mise en page d’une carte</a></li>
<li class="chapter" data-level="1.5.4" data-path="sect015.html"><a href="sect015.html#sect0154"><i class="fa fa-check"></i><b>1.5.4</b> Exportation d’une carte</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.6</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="1.7" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.7</b> Exercices de révision</a></li>
</ul></li>
<li class="part"><span><b>II Autocorrélation spatiale</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Autocorrélation spatiale</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion d’autocorrélation spatiale</a></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Matrices de pondération spatiale</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Matrices de contiguïté</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Matrices de proximité spatiale</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Standardisation des matrices de pondération spatiale en ligne</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Construction de matrices de pondération spatiale dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Autocorrélation spatiale globale</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Statistique du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Statistiques de comptage de jointure (<em>Join Count Statistics</em>)</a></li>
<li class="chapter" data-level="2.3.3" data-path="sect023.html"><a href="sect023.html#sect0233"><i class="fa fa-check"></i><b>2.3.3</b> Indice de Lee : autocorrélation spatiale dans un contexte bivarié</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Autocorrélation spatiale locale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#sect0241"><i class="fa fa-check"></i><b>2.4.1</b> Statistiques locales de Getis et Ord : repérer les points chauds et froids pour une variable continue</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#sect0242"><i class="fa fa-check"></i><b>2.4.2</b> Version locale du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#sect0243"><i class="fa fa-check"></i><b>2.4.3</b> Typologie basée sur le diagramme de Moran</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#sect0244"><i class="fa fa-check"></i><b>2.4.4</b> Version locale des statistiques de comptage de jointure (<em>Join Count Statistics</em>)</a></li>
<li class="chapter" data-level="2.4.5" data-path="sect024.html"><a href="sect024.html#sect0245"><i class="fa fa-check"></i><b>2.4.5</b> Version locale de l’indice de Lee</a></li>
<li class="chapter" data-level="2.4.6" data-path="sect024.html"><a href="sect024.html#sect0246"><i class="fa fa-check"></i><b>2.4.6</b> Typologie basée sur le diagramme de Moran dans un contexte bivarié</a></li>
<li class="chapter" data-level="2.4.7" data-path="sect024.html"><a href="sect024.html#sect0247"><i class="fa fa-check"></i><b>2.4.7</b> Autocorrélation locale pour une variable qualitative (catégorielle) : l’indicateur ELSA</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Méthodes de répartition ponctuelle</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Fréquence et densité des points dans l’espace d’étude</a></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Analyse centrographique</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0311"><i class="fa fa-check"></i><b>3.2.1</b> Paramètres de tendance centrale d’un semis de points</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0312"><i class="fa fa-check"></i><b>3.2.2</b> Paramètres de dispersion d’un semis de points</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0313"><i class="fa fa-check"></i><b>3.2.3</b> Mise en œuvre de l’analyse centrographique dans R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Forme d’un semis de points</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Méthode du plus proche voisin</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Méthode des quadrats</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Identification des agrégats spatiaux</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sect034.html"><a href="sect034.html#sect0341"><i class="fa fa-check"></i><b>3.4.1</b> Cartographie de la densité dans une maille irrégulière</a></li>
<li class="chapter" data-level="3.4.2" data-path="sect034.html"><a href="sect034.html#sect0342"><i class="fa fa-check"></i><b>3.4.2</b> Cartographie de la densité dans une maille régulière</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Méthodes de détection d’agrégats spatiaux et spatio-temporels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Agrégats d’entités spatiales ponctuelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sect041.html"><a href="sect041.html#sect0411"><i class="fa fa-check"></i><b>4.1.1</b> DBSCAN : agrégats spatiaux</a></li>
<li class="chapter" data-level="4.1.2" data-path="sect041.html"><a href="sect041.html#sect0412"><i class="fa fa-check"></i><b>4.1.2</b> ST-DBSCAN : agrégats spatio-temporels</a></li>
<li class="chapter" data-level="4.1.3" data-path="sect041.html"><a href="sect041.html#sect0414"><i class="fa fa-check"></i><b>4.1.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Méthodes de balayage de Kulldorff</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Objectifs de la méthode, types d’analyses, de modèles et d’agrégats</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Principes de base de la méthode</a></li>
<li class="chapter" data-level="4.2.3" data-path="sect042.html"><a href="sect042.html#sect043"><i class="fa fa-check"></i><b>4.2.3</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="4.4" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Mesures d’accessibilité spatiale selon les différents de modes de transport</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Notions relatives à l’analyse de réseau</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sect051.html"><a href="sect051.html#sect0511"><i class="fa fa-check"></i><b>5.1.1</b> Définition d’un réseau</a></li>
<li class="chapter" data-level="5.1.2" data-path="sect051.html"><a href="sect051.html#sect0512"><i class="fa fa-check"></i><b>5.1.2</b> Principaux problèmes résolus en analyse de réseau</a></li>
<li class="chapter" data-level="5.1.3" data-path="sect051.html"><a href="sect051.html#sect0513"><i class="fa fa-check"></i><b>5.1.3</b> Analyse de réseau et entités polygonales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Construction d’un réseau avec R5R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sect052.html"><a href="sect052.html#sect0521"><i class="fa fa-check"></i><b>5.2.1</b> Extraction des données spatiales pour R5R</a></li>
<li class="chapter" data-level="5.2.2" data-path="sect052.html"><a href="sect052.html#sect0522"><i class="fa fa-check"></i><b>5.2.2</b> Construction du réseau avec R5R</a></li>
<li class="chapter" data-level="5.2.3" data-path="sect052.html"><a href="sect052.html#sect0523"><i class="fa fa-check"></i><b>5.2.3</b> Calcul d’itinéraires avec R5R selon le mode de transport</a></li>
<li class="chapter" data-level="5.2.4" data-path="sect052.html"><a href="sect052.html#sect0524"><i class="fa fa-check"></i><b>5.2.4</b> Calcul de matrices OD selon différents modes de transport</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mesures d’accessibilité</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sect053.html"><a href="sect053.html#sect0531"><i class="fa fa-check"></i><b>5.3.1</b> Notion d’accessibilité</a></li>
<li class="chapter" data-level="5.3.2" data-path="sect053.html"><a href="sect053.html#sect0532"><i class="fa fa-check"></i><b>5.3.2</b> Accessibilité spatiale potentielle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Mesures d’accessibilité spatiale potentielle dans R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="sect054.html"><a href="sect054.html#sect0541"><i class="fa fa-check"></i><b>5.4.1</b> Accessibilité spatiale potentielle aux supermarchés</a></li>
<li class="chapter" data-level="5.4.2" data-path="sect054.html"><a href="sect054.html#sect0542"><i class="fa fa-check"></i><b>5.4.2</b> Accessibilité spatiale potentielle aux patinoires extérieures</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Analyses d’évènements localisés sur un réseau</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Cartographie de la densité d’évènements sur un réseau</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Explication du NKDE et du TNKDE</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Mesure d’autocorrélation spatiale sur un réseau</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sect063.html"><a href="sect063.html#sect0631"><i class="fa fa-check"></i><b>6.3.1</b> Getis et Ord</a></li>
<li class="chapter" data-level="6.3.2" data-path="sect063.html"><a href="sect063.html#sect0632"><i class="fa fa-check"></i><b>6.3.2</b> Typologie basée sur le diagramme de Moran</a></li>
<li class="chapter" data-level="6.3.3" data-path="sect063.html"><a href="sect063.html#sect0633"><i class="fa fa-check"></i><b>6.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> DBSCAN sur un réseau</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="sect064.html"><a href="sect064.html#sect0641"><i class="fa fa-check"></i><b>6.4.1</b> Explication du NKDE et du TNKDE</a></li>
<li class="chapter" data-level="6.4.2" data-path="sect064.html"><a href="sect064.html#sect0642"><i class="fa fa-check"></i><b>6.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="sect065.html"><a href="sect065.html"><i class="fa fa-check"></i><b>6.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="6.6" data-path="sect066.html"><a href="sect066.html"><i class="fa fa-check"></i><b>6.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Introduction aux modèles de régression spatiale</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Modèles économétriques spatiaux</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sect071.html"><a href="sect071.html#sect0711"><i class="fa fa-check"></i><b>7.1.1</b> Bref retour sur la régression linéaire multiple</a></li>
<li class="chapter" data-level="7.1.2" data-path="sect071.html"><a href="sect071.html#sect0712"><i class="fa fa-check"></i><b>7.1.2</b> Les différents modèles spatiaux autorégressifs</a></li>
<li class="chapter" data-level="7.1.3" data-path="sect071.html"><a href="sect071.html#sect0713"><i class="fa fa-check"></i><b>7.1.3</b> Quel modèle choisir?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Modèles généralisés additifs (GAM) avec une <em>spline</em> bivariée sur les coordonnées géographiques</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Principe de base d’un GAM intégrant l’espace</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Construction d’un modèle GAM dans R</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Régression géographiquement pondérée</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Principe de base</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Construction et analyse du modèle GWR dans R</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Méthodes de classification non supervisée spatiale</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Méthodes de classification non supervisée avec contrainte spatiale</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Algorithmes AZP</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Algorithme SKATER</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Algorithmes REDCAP</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Algorithme du <em>max-p-regions problem</em></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Méthodes de classification non supervisée avec une dimension spatiale</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Classification ascendante hiérarchique spatiale (<em>ClustGeo</em>)</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> <em>Spatial fuzzy c-means</em></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect083.html"><a href="sect083.html"><i class="fa fa-check"></i><b>8.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="8.4" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Méthodes d’interpolation spatiale</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Méthodes déterministes</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Interpolation polynomiale locale</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Interpolation de l’inverse à la distance (<em>IDW</em>)</a></li>
<li class="chapter" data-level="9.1.3" data-path="sect091.html"><a href="sect091.html#sect0913"><i class="fa fa-check"></i><b>9.1.3</b> Fonctions relationnelles</a></li>
<li class="chapter" data-level="9.1.4" data-path="sect091.html"><a href="sect091.html#sect0914"><i class="fa fa-check"></i><b>9.1.4</b> Fonctions conditionnelles</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Méthodes géostatistiques</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> Krigeage simple</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0922"><i class="fa fa-check"></i><b>9.2.2</b> Krigeage universel</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.3</b> Co-krigeage</a></li>
<li class="chapter" data-level="9.2.4" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.4</b> Krigeage résiduel</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Correction des exercices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect1001.html"><a href="sect1001.html"><i class="fa fa-check"></i><b>10.1</b> Exercices du chapitre 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect1001.html"><a href="sect1001.html#sect10011"><i class="fa fa-check"></i><b>10.1.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect1001.html"><a href="sect1001.html#sect10012"><i class="fa fa-check"></i><b>10.1.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="sect1001.html"><a href="sect1001.html#sect10013"><i class="fa fa-check"></i><b>10.1.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="sect1001.html"><a href="sect1001.html#sect10014"><i class="fa fa-check"></i><b>10.1.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect1002.html"><a href="sect1002.html"><i class="fa fa-check"></i><b>10.2</b> Exercices du chapitre 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect1002.html"><a href="sect1002.html#sect10021"><i class="fa fa-check"></i><b>10.2.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect1002.html"><a href="sect1002.html#sect10022"><i class="fa fa-check"></i><b>10.2.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.2.3" data-path="sect1002.html"><a href="sect1002.html#sect10023"><i class="fa fa-check"></i><b>10.2.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.2.4" data-path="sect1002.html"><a href="sect1002.html#sect10024"><i class="fa fa-check"></i><b>10.2.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect1003.html"><a href="sect1003.html"><i class="fa fa-check"></i><b>10.3</b> Exercices du chapitre 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sect1003.html"><a href="sect1003.html#sect10031"><i class="fa fa-check"></i><b>10.3.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="sect1003.html"><a href="sect1003.html#sect10032"><i class="fa fa-check"></i><b>10.3.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.3.3" data-path="sect1003.html"><a href="sect1003.html#sect10033"><i class="fa fa-check"></i><b>10.3.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sect1004.html"><a href="sect1004.html"><i class="fa fa-check"></i><b>10.4</b> Exercices du chapitre 4</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect1004.html"><a href="sect1004.html#sect10041"><i class="fa fa-check"></i><b>10.4.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect1004.html"><a href="sect1004.html#sect10042"><i class="fa fa-check"></i><b>10.4.2</b> Exercice 2</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect1005.html"><a href="sect1005.html"><i class="fa fa-check"></i><b>10.5</b> Exercices du chapitre 5</a></li>
<li class="chapter" data-level="10.6" data-path="sect1006.html"><a href="sect1006.html"><i class="fa fa-check"></i><b>10.6</b> Exercices du chapitre 6</a></li>
<li class="chapter" data-level="10.7" data-path="sect1007.html"><a href="sect1007.html"><i class="fa fa-check"></i><b>10.7</b> Exercices du chapitre 7</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sect1007.html"><a href="sect1007.html#sect10071"><i class="fa fa-check"></i><b>10.7.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.7.2" data-path="sect1007.html"><a href="sect1007.html#sect10072"><i class="fa fa-check"></i><b>10.7.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.7.3" data-path="sect1007.html"><a href="sect1007.html#sect10073"><i class="fa fa-check"></i><b>10.7.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="sect1008.html"><a href="sect1008.html"><i class="fa fa-check"></i><b>10.8</b> Exercices du chapitre 8</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="sect1008.html"><a href="sect1008.html#sect10081"><i class="fa fa-check"></i><b>10.8.1</b> Exercice 1</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="sect1009.html"><a href="sect1009.html"><i class="fa fa-check"></i><b>10.9</b> Exercices du chapitre 9</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours GMQ405 :
Modélisation et analyse spatiale</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect032" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Analyse centrographique<a href="sect032.html#sect032" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>L’analyse centrographique est une approche qui a été largement utilisée durant les décennies 1990 et 2000. Son utilisation est parfois critiquée pour deux raisons principales : 1) elle ne décrit que partiellement le semis de points; 2) aucun test d’inférence n’est calculé. Quoi qu’il en soit, elle permet d’explorer les données avant de se lancer dans des analyses plus avancées.</p>
<div class="bloc_notes">
<p><strong>Utilisation de l’analyse centrographique au Québec et dans le monde francophone</strong></p>
<p>Marius Thériault (géographe et professeur émérite à l’Université Laval) a largement contribué à la popularité de l’analyse centrographique au Québec et ailleurs. Il est le créateur de <em>MapStat</em>, un module développé avec le langage MapBasic intégré dans le logiciel SIG MapInfo permettant de réaliser une analyse centrographique avant même qu’elle soit implémentée dans ArcGIS. En guise d’exemple, les études suivantes utilisent l’analyse centrographique calculée avec <em>MapStat</em> <span class="citation">(<a href="#ref-lopez2015evolution">López Castro, Thériault et Vandersmissen 2015</a>; <a href="#ref-barbonne2007dynamique">Barbonne, Villeneuve et Thériault 2007</a>)</span>. Consultez-les au besoin.</p>
</div>
<div id="sect0311" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Paramètres de tendance centrale d’un semis de points<a href="sect032.html#sect0311" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les deux principaux paramètres de tendance centrale d’un semis de points sont le centre moyen et le point central qui peuvent être on non pondérés.</p>
<div id="sect03111" class="section level4 hasAnchor" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Centre moyen<a href="sect032.html#sect03111" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le centre moyen (<span class="math inline">\(cm\)</span>) est le centre de gravité du semis de points et correspond aux valeurs des moyennes arithmétiques des coordonnées géographiques (équation <a href="sect032.html#eq:CentreMoyen">(3.1)</a>).</p>
<p><span class="math display" id="eq:CentreMoyen">\[\begin{equation}  
(\bar{x}_{cm}, \bar{y}_{cm}) = \Biggl( \frac{\Sigma_{i=1}^n x_i}{n}, \frac{\Sigma_{i=1}^n y_i}{n}\Biggl)\text{ avec :}
\tag{3.1}
\end{equation}\]</span>
</p>
<ul>
<li><span class="math inline">\((\bar{x}_{cm}, \bar{y}_{cm})\)</span>, les coordonnées géographiques du point moyen.</li>
<li><span class="math inline">\(n\)</span>, le nombre de points dans la couche géographique.</li>
<li><span class="math inline">\(x_i\)</span> et <span class="math inline">\(y_j\)</span>, les coordonnées géographiques du point <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Il est possible de calculer le centre moyen en pondérant chacun des points du semis avec la valeur d’une variable donnée (équation <a href="sect032.html#eq:CentreMoyenPonderee">(3.2)</a>). Ainsi, l’importance accordée à chacun des points n’est pas la même. Par exemple, nous pourrions calculer le centre moyen pondéré (<span class="math inline">\(cmp\)</span>) des cliniques médicales d’une ville en pondérant chaque clinique par le nombre de médecins, ou encore le point moyen des hôpitaux pondéré par le nombre de lits. Autre exemple, avec un jeu de données sur les arbres dans une érablière, nous pourrions utiliser une pondération basée sur le diamètre à la hauteur de la poitrine (DHP) afin d’accorder un poids plus important aux arbres de plus « grand volume ».</p>
<div class="bloc_notes">
<p><strong>Pour un rappel sur le calcul d’une moyenne pondérée</strong>, consultez la section intitulée <a href="https://laeq.github.io/LivreMethoQuantBolR/sect027.html"><em>Statistiques descriptives pondérées</em></a> <span class="citation">(<a href="#ref-RBoldAir">Apparicio et Gelb 2022</a>)</span>.</p>
</div>
<p><span class="math display" id="eq:CentreMoyenPonderee">\[\begin{equation}  
(\bar{x}_{cmp}, \bar{y}_{cmp}) = \Biggl( \frac{\Sigma_{i=1}^n w_ix_i}{\Sigma_{i=1}^nw_i}, \frac{\Sigma_{i=1}^n w_iy_i}{\Sigma_{i=1}^nw_i}\Biggl) \text{ avec :}
\tag{3.2}
\end{equation}\]</span>
</p>
<ul>
<li><span class="math inline">\(n\)</span>, <span class="math inline">\(x_i\)</span> et <span class="math inline">\(y_j\)</span> étant définis plus haut.</li>
<li><span class="math inline">\((\bar{x}_w, \bar{y}_w)\)</span>, les coordonnées géographiques du point moyen pondéré.</li>
<li><span class="math inline">\(w_i\)</span>, la valeur de pondération associée au point <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Le centre moyen et le centre moyen pondéré sont des mesures très utiles pour comparer la distribution de plusieurs semis de points (de différents services et équipements collectifs par exemple) ou encore pour décrire l’évolution dans le temps de la répartition d’un semis de points. L’analyse du déplacement du centre moyen (pondéré) à différentes dates nous informe ainsi de l’évolution du phénomène à l’étude et plus spécifiquement, de son orientation et de sa direction.</p>
<div class="bloc_astuce">
<p><strong>Exemple d’utilisation temporelle du centre moyen pondéré</strong></p>
<p>Un exemple classique d’utilisation du centre moyen pondéré sur plusieurs années est l’évolution du centre moyen pondéré de la population des États-Unis de 1790 à 2020. Il est calculé à partir des centroïdes des comtés américains et de la population comme variable de pondération extraite des recensements de l’<em>US Census Bureau</em>. Bien entendu, le centre moyen pondéré se déplace vers l’ouest.</p>
<p>Vous pouvez consulter <a href="https://www.census.gov/library/visualizations/2020/geo/center-of-population-1790-2020.html">cette carte</a> ou visionner cette <a href="https://www.youtube.com/watch?v=D9XelnGyggI">courte vidéo YouTube ludique</a>.</p>
</div>
<p>Notez que les centres moyen et moyen pondéré peuvent aussi être calculés sur des données géographiques comprenant des valeurs d’élévation (<span class="math inline">\(x,y,z\)</span>) :</p>
<p><span class="math display" id="eq:PointMoyenZ1">\[\begin{equation}  
(\bar{x}_{cm}, \bar{y}_{cm}, \bar{z}_{cm}) = \Biggl( \frac{\Sigma_{i=1}^n x_i}{n}, \frac{\Sigma_{i=1}^n y_i}{n}, \frac{w_i\Sigma_{i=1}^n z_i}{n}\Biggl)
\tag{3.3}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:PointMoyenZ2">\[\begin{equation}  
(\bar{x}_{cmp}, \bar{y}_{cmp}, \bar{z}_{cmp}) = \Biggl( \frac{w_i\Sigma_{i=1}^n x_i}{\Sigma_{i=1}^nw_i}, \frac{w_i\Sigma_{i=1}^n y_i}{\Sigma_{i=1}^nw_i}, \frac{w_i\Sigma_{i=1}^n z_i}{\Sigma_{i=1}^nw_i}\Biggl)
\tag{3.4}
\end{equation}\]</span>
</p>
</div>
<div id="sect03112" class="section level4 hasAnchor" number="3.2.1.2">
<h4><span class="header-section-number">3.2.1.2</span> Point central<a href="sect032.html#sect03112" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le point central d’un semis de points (<span class="math inline">\(pc\)</span>) est celui qui minimise la somme des distances le séparant de tous les autres points (équation <a href="sect032.html#eq:PointCentral">(3.5)</a>). Tout comme le point moyen, il est aussi possible de calculer le point central pondéré (<span class="math inline">\(pcp\)</span>) (équation <a href="sect032.html#eq:PointCentralW">(3.6)</a>).</p>
<p><span class="math display" id="eq:PointCentral">\[\begin{equation}  
\text{Min}\Biggl(\Sigma_{i=1}^n \sqrt{(x_i-x_j)^2+(y_i-y_j)^2}\Biggl)\text{; avec }i \ne j
\tag{3.5}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:PointCentralW">\[\begin{equation}  
\text{Min}\Biggl(\Sigma_{i=1}^n w_i \sqrt{(x_i-x_j)^2+(y_i-y_j)^2}\Biggl)\text{; avec }i \ne j
\tag{3.6}
\end{equation}\]</span>
</p>
<div class="bloc_attention">
<p><strong>Différence entre point central et centre moyen</strong></p>
<p>Contrairement au centre moyen, le point central fait partie du semis de points initial.</p>
<p><strong>Utilité du point central pondéré</strong></p>
<p>Imaginez que des personnes étudiantes en géographie et en géomatique de toutes les universités du Québec souhaitent organiser une rencontre en présence. Calculer le point central, pondéré par le nombre de personnes étudiantes par établissement participant à la rencontre, permet d’identifier l’université la plus centrale. Idéalement, il faudrait calculer ce point central pondéré avec les distances temps calculés avec un réseau routier.</p>
</div>
</div>
</div>
<div id="sect0312" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Paramètres de dispersion d’un semis de points<a href="sect032.html#sect0312" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les deux principaux paramètres de dispersion d’un semis de points sont la distance standard et la distance standard pondérée. La dispersion d’un semis de points peut être représentée graphiquement avec une enveloppe convexe, un cercle de rayon de standard, une ellipse (avec ou sans pondération).</p>
<div id="sect03121" class="section level4 hasAnchor" number="3.2.2.1">
<h4><span class="header-section-number">3.2.2.1</span> Distance standard et distance standard pondérée<a href="sect032.html#sect03121" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En statistique univariée, l’écart-type (équation <a href="sect032.html#eq:ecartype">(3.7)</a>) est une mesure de dispersion bien connue : plus la valeur de l’écart-type est élevée, plus la dispersion des valeurs de la variable autour de la moyenne (<span class="math inline">\(\mu\)</span>) est importante.</p>
<p><span class="math display" id="eq:ecartype">\[\begin{equation}  
\sigma=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\mu)^2}{n}}
\tag{3.7}
\end{equation}\]</span>
</p>
<div class="bloc_notes">
<p><strong>Pour un rappel sur l’écart-type</strong>, consultez la section intitulée <a href="https://laeq.github.io/LivreMethoQuantBolR/sect025.html#sect0253"><em>Paramètres de dispersion</em></a> <span class="citation">(<a href="#ref-RBoldAir">Apparicio et Gelb 2022</a>)</span>.</p>
</div>
<p><strong>Distance standard (pondérée ou non) des <em>X</em> et des <em>Y</em></strong></p>
<p>De manière analogue à l’écart-type, nous pouvons calculer la distance standard pour les coordonnées <em>X</em> et pour les coordonnées <em>Y</em> des points, soit l’écart moyen respectif au centre moyen (équation <a href="sect032.html#eq:distancestandardxy">(3.8)</a>) ou au centre moyen pondéré (équation <a href="sect032.html#eq:distancestandardxyw">(3.9)</a>).</p>
<p><span class="math display" id="eq:distancestandardxy">\[\begin{equation}  
\sigma_x=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x}_{cm})^2}{n}} \text{ et }
\sigma_y=\sqrt{\frac{\sum_{i=1}^n (y_{i}-\bar{y}_{cm})^2}{n}}
\tag{3.8}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:distancestandardxyw">\[\begin{equation}  
\sigma_{xw}=\sqrt{\frac{\sum_{i=1}^n w_i(x_{i}-\bar{x}_{cmp})^2}{\sum_{i=1}^n{w_i}}} \text{ et } \sigma_{yw}=\sqrt{\frac{\sum_{i=1}^n w_i(y_{i}-\bar{y}_{cmp})^2}{\sum_{i=1}^n{w_i}}}
\tag{3.9}
\end{equation}\]</span>
</p>
<p><strong>Distance standard (pondérée ou non)</strong></p>
<p>Nous pouvons aussi calculer la distance standard (<span class="math inline">\(ds\)</span>) sans ou avec pondération (équations <a href="sect032.html#eq:distancestandard">(3.10)</a> et <a href="sect032.html#eq:distancestandardw">(3.11)</a>). Plus elle est forte, plus les points sont dispersés autour du centre moyen ou du centre moyen pondéré. Inversement, une faible distance standard indique une concentration de points autour du centre moyen.</p>
<p><span class="math display" id="eq:distancestandard">\[\begin{equation}  
ds=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x}_{cm})^2}{n} + \frac{\sum_{i=1}^n (y_{i}-\bar{y}_{cm})^2}{n}}
\tag{3.10}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:distancestandardw">\[\begin{equation}  
ds_w=\sqrt{\frac{\sum_{i=1}^n w_i(x_{i}-\bar{x}_{cmp})^2}{\sum_{i=1}^n w_i} + \frac{\sum_{i=1}^n w_i(y_{i}-\bar{y}_{cmp})^2}{\sum_{i=1}^n w_i}}
\tag{3.11}
\end{equation}\]</span>
</p>
<p>De nouveau, ces mesures peuvent être adaptées pour des points avec une élévation (<span class="math inline">\(x,y,z\)</span>) :</p>
<p><span class="math display" id="eq:distancestandardz">\[\begin{equation}  
ds=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x}_{cm})^2}{n} + \frac{\sum_{i=1}^n (y_{i}-\bar{y}_{cm})^2}{n} + \frac{\sum_{i=1}^n (z_{i}-\bar{z}_{cm})^2}{n}}
\tag{3.12}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:distancestandardwz">\[\begin{equation}  
ds_w=\sqrt{\frac{\sum_{i=1}^n w_i(x_{i}-\bar{x}_{cmp})^2}{\sum_{i=1}^n w_i} + \frac{\sum_{i=1}^n w_i(y_{i}-\bar{y}_{cmp})^2}{\sum_{i=1}^n w_i} + \frac{\sum_{i=1}^n w_i(z_{i}-\bar{z}_{cmp})^2}{\sum_{i=1}^n w_i}}
\tag{3.13}
\end{equation}\]</span>
</p>
</div>
<div id="sect03122" class="section level4 hasAnchor" number="3.2.2.2">
<h4><span class="header-section-number">3.2.2.2</span> Représenter la dispersion : cercle de distance standard et ellipse<a href="sect032.html#sect03122" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La dispersion d’un semis de points peut être représentée de quatre manières différentes :</p>
<ol style="list-style-type: decimal">
<li><p>Une enveloppe convexe des points décrite à la section <a href="sect012.html#sect01225">1.2.2.5</a>.</p></li>
<li><p>Un rectangle centré sur le centre moyen avec les déviations des coordonnées <em>X</em> et <em>Y</em> pondérées ou non (équations <a href="sect032.html#eq:distancestandardxy">(3.8)</a> et <a href="sect032.html#eq:distancestandardxyw">(3.9)</a> décrites précédemment). Dans le cas de données comprenant l’élévation, la forme géométrique est un parallélépipède rectangle.</p></li>
<li><p>Un cercle de rayon de distance standard pondérée ou non (équations <a href="sect032.html#eq:distancestandard">(3.10)</a> et <a href="sect032.html#eq:distancestandardw">(3.11)</a> décrites précédemment). Dans le cas de données comprenant l’élévation, la forme géométrique est une sphère de rayon de distance standard.</p></li>
<li><p>Une ellipse de distance standard pondérée ou non. Dans le cas de données comprenant l’élévation, la forme géométrique est un ellipsoïde.</p></li>
</ol>
<p><strong>Prenons un jeu de données fictives</strong> pour décrire ces quatre représentations graphiques. Imaginons que nous avons observé le parc de la Laurentie à Sherbrooke pour comprendre son utilisation. Pour collecter des données sur la localisation des personnes utilisatrices, nous aurions pu utiliser un questionnaire dans QFIELD ou ArcGIS Survey 123. La figure <a href="sect032.html#fig:PointsB">3.1</a> illustre la localisation de dix personnes (points rouges).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:PointsB"></span>
<img src="images/Chap03/CartePointsB.png" alt="Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke" width="100%" />
<p class="caption">
Figure 3.1: Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke
</p>
</div>
<p>À partir de ces dix points, nous obtenons :</p>
<ul>
<li><p>Les coordonnées du <strong>centre moyen</strong> qui sont égales à -8 007 869 et 5 685 921, soit simplement les moyennes des coordonnées <em>X</em> et <em>Y</em> des dix observations.</p></li>
<li><p>L’<strong>enveloppe convexe des points</strong> qui contient tous les points.</p></li>
<li><p><strong>Le rectangle construit avec les déviations standards des <em>X</em> et des <em>Y</em></strong> qui est centré sur le centre moyen. À partir de ce point, nous ajoutons à l’est et à l’ouest la valeur de la distance standard des <em>X</em> et au nord et au sud celle des <em>Y</em>. Les valeurs de ces distances standards sont égales à 32,60 et 52,20 mètres (voir les calculs au tableau <a href="sect032.html#tab:DonneesFictivesCasB">3.2</a>).</p></li>
<li><p>La <strong>distance standard</strong> est égale à 61,59 mètres (voir les calculs au tableau <a href="sect032.html#tab:DonneesFictivesCasB">3.2</a>). À partir de cette distance, nous traçons le cercle ayant comme rayon la distance standard.</p></li>
<li><p>L’<strong>ellipse de déviation de distance standard</strong> (figure <a href="sect032.html#fig:ExplicationEllipse">3.2</a>).</p></li>
</ul>
<table>
<caption>
<span id="tab:DonneesFictivesCasB">Tableau 3.2: </span>Calcul des distances standards des X et des Y et de la distance standard
</caption>
<thead>
<tr>
<th style="text-align:right;">
Pt
</th>
<th style="text-align:right;">
<span class="math inline">\(x_i\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(y_i\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((x_{i}-\bar{x}_{cm})^2\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((y_{i}-\bar{y}_{cm})^2\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((x_{i}-\bar{x}_{cm})^2+\)</span><span class="math inline">\((y_{i}-\bar{y}_{cm})^2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-8 007 877
</td>
<td style="text-align:right;">
5 686 000
</td>
<td style="text-align:right;">
52,80
</td>
<td style="text-align:right;">
6 347,70
</td>
<td style="text-align:right;">
6 400,50
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-8 007 843
</td>
<td style="text-align:right;">
5 685 993
</td>
<td style="text-align:right;">
716,90
</td>
<td style="text-align:right;">
5 298,00
</td>
<td style="text-align:right;">
6 014,90
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-8 007 836
</td>
<td style="text-align:right;">
5 685 976
</td>
<td style="text-align:right;">
1 082,00
</td>
<td style="text-align:right;">
3 046,30
</td>
<td style="text-align:right;">
4 128,30
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-8 007 859
</td>
<td style="text-align:right;">
5 685 928
</td>
<td style="text-align:right;">
98,90
</td>
<td style="text-align:right;">
60,30
</td>
<td style="text-align:right;">
159,20
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-8 007 911
</td>
<td style="text-align:right;">
5 685 935
</td>
<td style="text-align:right;">
1 770,20
</td>
<td style="text-align:right;">
214,60
</td>
<td style="text-align:right;">
1 984,80
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-8 007 913
</td>
<td style="text-align:right;">
5 685 871
</td>
<td style="text-align:right;">
1 934,80
</td>
<td style="text-align:right;">
2 461,00
</td>
<td style="text-align:right;">
4 395,80
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-8 007 888
</td>
<td style="text-align:right;">
5 685 855
</td>
<td style="text-align:right;">
365,70
</td>
<td style="text-align:right;">
4 363,40
</td>
<td style="text-align:right;">
4 729,10
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-8 007 835
</td>
<td style="text-align:right;">
5 685 857
</td>
<td style="text-align:right;">
1 185,00
</td>
<td style="text-align:right;">
4 016,80
</td>
<td style="text-align:right;">
5 201,80
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
-8 007 824
</td>
<td style="text-align:right;">
5 685 886
</td>
<td style="text-align:right;">
2 071,70
</td>
<td style="text-align:right;">
1 203,50
</td>
<td style="text-align:right;">
3 275,20
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-8 007 906
</td>
<td style="text-align:right;">
5 685 904
</td>
<td style="text-align:right;">
1 376,50
</td>
<td style="text-align:right;">
266,70
</td>
<td style="text-align:right;">
1 643,30
</td>
</tr>
<tr>
<td style="text-align:right;">
<span class="math inline">\(n =\)</span>
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:right;">
<span class="math inline">\(\text{Moyenne} =\)</span>
</td>
<td style="text-align:right;">
-8 007 869
</td>
<td style="text-align:right;">
5 685 921
</td>
<td style="text-align:right;">
1 065,45
</td>
<td style="text-align:right;">
2 727,83
</td>
<td style="text-align:right;">
3 793,28
</td>
</tr>
<tr>
<td style="text-align:right;">
<span class="math inline">\(\text{Racine carrée} =\)</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
32,60
</td>
<td style="text-align:right;">
52,20
</td>
<td style="text-align:right;">
61,59
</td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ExplicationEllipse"></span>
<img src="images/Chap03/ExplicationEllipse.png" alt="Trois éléments composant une ellipse" width="35%" />
<p class="caption">
Figure 3.2: Trois éléments composant une ellipse
</p>
</div>
<div class="bloc_attention">
<p><strong>Calcul des ellipses : des résultats qui varient d’un logiciel à l’autre…</strong></p>
<p>Il existe plusieurs solutions pour tracer une ellipse. Pour une discussion détaillée de ces différentes solutions, lisez le <a href="https://portailsig.org/content/qgis-des-ellipses-de-deviation-standard-sde-un-plugin-standard-deviational-ellipse-des-scrip.html">court texte très intéressant de Martin Leroux</a>.</p>
<ul>
<li>Ellipse de Yuill <span class="citation">(<a href="#ref-tveitesde">Tveite 2020</a>)</span>.</li>
<li>Ellipse basée sur la covariance implémentée dans <a href="https://pro.arcgis.com/en/pro-app/3.0/tool-reference/spatial-statistics/h-how-directional-distribution-standard-deviationa.htm">ArcGIS Pro</a>.</li>
<li>Ellipse de distance standard implémentée dans le logiciel <a href="https://www.icpsr.umich.edu/CrimeStat/">CrimeStat</a>.</li>
<li>Ellipse avec la correction proposée par Wang et ses collègues <span class="citation">(<a href="#ref-wang2015confidence">2015</a>)</span>.</li>
</ul>
<p>Notez qu’un plugin QGIS nommé <em>The QGIS Standard Deviational Ellipse Plugin</em> <span class="citation">(<a href="#ref-tveitesde">Tveite 2020</a>)</span> intègre plusieurs de ces méthodes. Les résultats varient ainsi d’un logiciel à l’autre selon la méthode implémentée. Autrement dit, pour un même jeu de données ponctuelles, les ellipses obtenues avec ArcGIS Pro, ArcMap 9.3, ArcMap 10.x et QGIS seront différentes.</p>
<p><strong>Quoi faire alors?</strong></p>
<p>Quelle que soit la méthode utilisée, l’ellipse est toujours centrée sur le point moyen et a toujours le même angle de rotation. Par contre, la taille de l’ellipse (superficie) varie. Par conséquent, si vous souhaitez comparer des ellipses différentes, assurez-vous toujours qu’elles sont toutes obtenues dans le même logiciel et avec la même solution.</p>
</div>
<div class="bloc_aller_loin">
<p><strong>Calcul de l’ellipse selon la méthode implémentée dans CrimeStat</strong></p>
<p>Ned Levine <span class="citation">(<a href="#ref-levine2006crime">2006</a>; <a href="#ref-levine2021crimestat">2021</a>)</span>, créateur du logiciel <a href="https://www.icpsr.umich.edu/CrimeStat/">CrimeStat</a>, propose les formulations suivantes pour le calcul d’une ellipse :</p>
<p><span class="math display" id="eq:CrimeStatRotation">\[\begin{equation}  
\theta = \frac{\text{arctan} \Biggl\{ \Bigl(\sum_{i=1}^nx_d^2-\sum_{i=1}^ny_d^2 \Bigl)+  \Bigr[\Bigl(\sum_{i=1}^nx_d^2-\sum_{i=1}^ny_d^2 \Bigl)^2 + 4 \Bigl(\sum_{i=1}^nx_dy_d \Bigl)^2\Bigr]^{1/2} \Biggl\}} {2 \sum_{i=1}^nx_dy_d}
\tag{3.14}
\end{equation}\]</span>
</p>
<p>avec <span class="math inline">\(\theta\)</span> est la rotation de l’ellipse, <span class="math inline">\(x_d = x_i-\bar{x}\)</span> et <span class="math inline">\(y_d = y_i-\bar{y}\)</span>.</p>
<p><span class="math display" id="eq:CrimeStatSigmaX">\[\begin{equation}  
\sigma_x =\sqrt{2\times \frac{\sum_{i=1}^n\Bigl((x_i-\bar{x}) \text{cos}\theta-(y_i-\bar{y})\text{sin}\theta\Bigl)^2}{n-2}}
\tag{3.15}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:CrimeStatSigmaY">\[\begin{equation}  
\sigma_y =\sqrt{2\times \frac{\sum_{i=1}^n\Bigl((x_i-\bar{x}) \text{sin}\theta-(y_i-\bar{y})\text{cos}\theta\Bigl)^2}{n-2}}
\tag{3.16}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:CrimeStatSuperficieLyLx">\[\begin{equation}  
l_x=2\sigma_x \text{ et }l_y=2\sigma_y \text{ et }S_e=\pi\sigma_x\sigma_y
\tag{3.17}
\end{equation}\]</span>
</p>
<p>avec <span class="math inline">\(l_x\)</span>, <span class="math inline">\(l_y\)</span> et <span class="math inline">\(S_e\)</span> étant les longueurs de axes <em>X</em> et <em>Y</em> et la superficie de l’ellipse.</p>
</div>
<p>Prenons quatre situations fictives de répartition de dix personnes utilisatrices du parc de la Laurentie à Sherbrooke :</p>
<ul>
<li><strong>Situation A</strong>. Les observations sont concentrées autour de l’aire de jeu.</li>
<li><strong>Situation B</strong>. Les observations sont dispersées dans la partie est du parc.</li>
<li><strong>Situation C</strong>. Les observations sont concentrées dans la partie nord du parc.</li>
<li><strong>Situation D</strong>. Les observations sont concentrées dans la partie nord du parc, excepté deux observations au sud.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:PointsABCD"></span>
<img src="images/Chap03/CartePointsABCD.png" alt="Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke (quatre situations)" width="100%" />
<p class="caption">
Figure 3.3: Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke (quatre situations)
</p>
</div>
<p>Les cercles et les ellipses de distance standard (<span class="math inline">\(ds\)</span>) centrés au centre moyen (<span class="math inline">\(cm\)</span>) sont représentés à la (figure <a href="sect032.html#fig:EllipsesCercleABCD">3.4</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:EllipsesCercleABCD"></span>
<img src="images/Chap03/CartePointsABCD_DS.png" alt="Ellipse et cercle de distance standard pour les quatre situations" width="100%" />
<p class="caption">
Figure 3.4: Ellipse et cercle de distance standard pour les quatre situations
</p>
</div>
</div>
<div id="sect03123" class="section level4 hasAnchor" number="3.2.2.3">
<h4><span class="header-section-number">3.2.2.3</span> Comparaison de la dispersion de deux semis de points dans deux régions différentes<a href="sect032.html#sect03123" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour comparer la dispersion de deux semis de points situés dans des régions de taille différente, il convient de supprimer les effets de taille des deux régions. Pour ce faire, nous divisons la <strong>distance standard</strong> ou la <strong>distance standard pondérée</strong> par la superficie de la région. Cette approche est donc très similaire au <a href="https://laeq.github.io/LivreMethoQuantBolR/sect025.html#sect0253">coefficient de variation</a> en statistique univariée, soit le rapport entre l’écart-type et la moyenne.</p>
<p>Par exemple, si nous comparons les dispersions des personnes utilisatrices du parc de la Laurentie (0,078 ha) et parc du Mont-Bellevue (409 ha). Inévitablement, la valeur de la distance standard est plus forte pour le parc du Mont-Bellevue que celle du parc de la Laurentie. Il faut donc diviser chaque distance standard par la superficie associée.</p>
</div>
<div id="sect03124" class="section level4 hasAnchor" number="3.2.2.4">
<h4><span class="header-section-number">3.2.2.4</span> Comparaison de la dispersion de deux semis de points dans la même région<a href="sect032.html#sect03124" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour comparer la distribution spatiale de deux semis de points situés dans la même région, nous comparons leur cercle ou leur ellipse respective (par exemple, des points représentant des accidents l’été versus l’hiver ou encore deux espèces végétales sur le même territoire).</p>
<p>Une démarche similaire peut être appliquée à deux groupes de population rattachés à des entités polygonales : ils ont la même distribution spatiale si les deux ellipses de distance pondérée se juxtaposent significativement. David W.S. Wong <span class="citation">(<a href="#ref-wong1999geostatistics">1999</a>)</span> propose d’ailleurs un indice dénommé <em>S</em> basé sur la comparaison des deux ellipses (équation <a href="sect032.html#eq:WongIndice2Groupes">(3.18)</a>). Le numérateur représente la surface d’intersection entre les deux ellipses tandis que le dénominateur représente leur surface d’union. L’indice varie de 0 à 1, soit respectivement d’une similitude parfaite à une dissemblance la plus grande entre les deux distributions spatiales :</p>
<ul>
<li>Si deux groupes de population ont des distributions spatiales identiques, les ellipses sont les mêmes et donc <span class="math inline">\(E_i \cap E_j = E_i \cup E_j = 1\)</span> et <span class="math inline">\(S_{ij} = 1 - 1 = 0\)</span>.</li>
<li>Si les deux groupes de population ont des distributions spatiales totalement différentes, les ellipses ne se touchent pas, alors <span class="math inline">\(E_i \cap E_j = 0\)</span> et la valeur de <span class="math inline">\(S = 1 - 0 = 1\)</span>.</li>
</ul>
<p>Bien évidemment, cet indice peut être étendu pour comparer les distributions de plus de deux groupes de population simultanément (équation <a href="sect032.html#eq:WongIndiceNGroupes">(3.19)</a>).</p>
<p><span class="math display" id="eq:WongIndice2Groupes">\[\begin{equation}  
S_{ij}=1-\frac{E_i \cap E_j}{E_i \cup E_j}
\tag{3.18}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:WongIndiceNGroupes">\[\begin{equation}  
S=1-\frac{E_1 \cap E_2 \cap E_3 \cap \text{…} \cap E_n}{E_1 \cup E_2 \cup E_3 \cup \text{…} \cup E_n}
\tag{3.19}
\end{equation}\]</span>
</p>
<p><strong>Voyons un exemple concret</strong> : calculons l’indice de Wong <span class="citation">(<a href="#ref-wong1999geostatistics">1999</a>)</span> (équation <a href="sect032.html#eq:WongIndice2Groupes">(3.18)</a>) pour les ellipses de distances standards pondérées par les effectifs de propriétaires et de locataires par secteur de recensement pour la ville de Sherbrooke en 2021 (figure <a href="sect032.html#fig:CarteProprioLoctaires">3.5</a>). D’emblée, nous constatons que les propriétaires ont une distribution plus dispersée que celle des locataires plus présents dans le centre de la ville.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CarteProprioLoctaires"></span>
<img src="GMQ405_files/figure-html/CarteProprioLoctaires-1.png" alt="Propriétaires et locataires dans la ville de Sherbrooke (avec ellipse de distance standard), 2021" width="85%" />
<p class="caption">
Figure 3.5: Propriétaires et locataires dans la ville de Sherbrooke (avec ellipse de distance standard), 2021
</p>
</div>
<p>Le code suivant permet d’obtenir l’indice de Wong <span class="citation">(<a href="#ref-wong1999geostatistics">1999</a>)</span>.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="sect032.html#cb292-1" tabindex="-1"></a><span class="do">## Importation des deux ellipses </span></span>
<span id="cb292-2"><a href="sect032.html#cb292-2" tabindex="-1"></a>E1 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/EllipseProprio.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>) </span>
<span id="cb292-3"><a href="sect032.html#cb292-3" tabindex="-1"></a>E2 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/EllipseLocataire.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>) </span>
<span id="cb292-4"><a href="sect032.html#cb292-4" tabindex="-1"></a><span class="do">## Intersection </span></span>
<span id="cb292-5"><a href="sect032.html#cb292-5" tabindex="-1"></a>Inter <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(E1, E2)</span>
<span id="cb292-6"><a href="sect032.html#cb292-6" tabindex="-1"></a><span class="do">## Union</span></span>
<span id="cb292-7"><a href="sect032.html#cb292-7" tabindex="-1"></a>Union <span class="ot">&lt;-</span> <span class="fu">st_union</span>(E1, E2)</span>
<span id="cb292-8"><a href="sect032.html#cb292-8" tabindex="-1"></a><span class="do">## Calcul de l&#39;indice de Wong</span></span>
<span id="cb292-9"><a href="sect032.html#cb292-9" tabindex="-1"></a>Wong <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ( <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(Inter)) <span class="sc">/</span> <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(Union)))</span>
<span id="cb292-10"><a href="sect032.html#cb292-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Valeur de l&#39;indice de Wong : &quot;</span>,<span class="fu">round</span>(Wong,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Valeur de l&#39;indice de Wong : 0.515&quot;</code></pre>
</div>
</div>
<div id="sect0313" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Mise en œuvre de l’analyse centrographique dans R<a href="sect032.html#sect0313" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect03131" class="section level4 hasAnchor" number="3.2.3.1">
<h4><span class="header-section-number">3.2.3.1</span> Calcul de mesures non pondérées<a href="sect032.html#sect03131" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour illustrer la mise en œuvre des différentes mesures de l’analyse centrographique dans R, nous utilisons un jeu de données ouvertes sur les <a href="https://donneesouvertes-sherbrooke.opendata.arcgis.com/datasets/64d19d62f0804f5896e4b24c32aea49d_0/explore?location=45.403468%2C-71.960143%2C12.00">incidents de sécurité publique de la ville de Sherbrooke</a>. Dans le code ci-dessous, nous importons les données et constituons une couche <code>sf</code> par année (2019 à 2022) et extrayons les coordonnées géographiques.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="sect032.html#cb294-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb294-2"><a href="sect032.html#cb294-2" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb294-3"><a href="sect032.html#cb294-3" tabindex="-1"></a><span class="do">## Importation des données </span></span>
<span id="cb294-4"><a href="sect032.html#cb294-4" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/Arrondissements.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb294-5"><a href="sect032.html#cb294-5" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/IncidentsSecuritePublique.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb294-6"><a href="sect032.html#cb294-6" tabindex="-1"></a><span class="do">## Changement de projection</span></span>
<span id="cb294-7"><a href="sect032.html#cb294-7" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Arrondissements, <span class="at">crs =</span> <span class="dv">3798</span>) </span>
<span id="cb294-8"><a href="sect032.html#cb294-8" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Incidents, <span class="at">crs =</span> <span class="dv">3798</span>)</span>
<span id="cb294-9"><a href="sect032.html#cb294-9" tabindex="-1"></a><span class="do">## Extaction des méfaits</span></span>
<span id="cb294-10"><a href="sect032.html#cb294-10" tabindex="-1"></a>Mefaits <span class="ot">&lt;-</span> <span class="fu">subset</span>(Incidents, DESCRIPTIO <span class="sc">==</span> <span class="st">&quot;Méfait&quot;</span>)</span>
<span id="cb294-11"><a href="sect032.html#cb294-11" tabindex="-1"></a><span class="co"># Méfaits par année</span></span>
<span id="cb294-12"><a href="sect032.html#cb294-12" tabindex="-1"></a>M2019 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Mefaits, ANNEE<span class="sc">==</span><span class="dv">2019</span>)</span>
<span id="cb294-13"><a href="sect032.html#cb294-13" tabindex="-1"></a>M2020 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Mefaits, ANNEE<span class="sc">==</span><span class="dv">2020</span>)</span>
<span id="cb294-14"><a href="sect032.html#cb294-14" tabindex="-1"></a>M2021 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Mefaits, ANNEE<span class="sc">==</span><span class="dv">2021</span>)</span>
<span id="cb294-15"><a href="sect032.html#cb294-15" tabindex="-1"></a>M2022 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Mefaits, ANNEE<span class="sc">==</span><span class="dv">2022</span>)</span>
<span id="cb294-16"><a href="sect032.html#cb294-16" tabindex="-1"></a><span class="co"># Coordonnées géographiques</span></span>
<span id="cb294-17"><a href="sect032.html#cb294-17" tabindex="-1"></a>xy<span class="fl">.2019</span> <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(M2019)</span>
<span id="cb294-18"><a href="sect032.html#cb294-18" tabindex="-1"></a>xy<span class="fl">.2020</span> <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(M2020)</span>
<span id="cb294-19"><a href="sect032.html#cb294-19" tabindex="-1"></a>xy<span class="fl">.2021</span> <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(M2021)</span>
<span id="cb294-20"><a href="sect032.html#cb294-20" tabindex="-1"></a>xy<span class="fl">.2022</span> <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(M2022)</span></code></pre></div>
<p>Les méfaits par année sont présentés à la figure <a href="sect032.html#fig:CarteMefaits">3.6</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CarteMefaits"></span>
<img src="GMQ405_files/figure-html/CarteMefaits-1.png" alt="Localisation des méfaits par année, ville de Sherbrooke, 2021" width="85%" />
<p class="caption">
Figure 3.6: Localisation des méfaits par année, ville de Sherbrooke, 2021
</p>
</div>
<p><strong>Centre moyen</strong></p>
<p>Avec la fonction <code>mean</code>, nous pouvons calculer les valeurs moyennes sur les coordonnées <em>X</em> et <em>Y</em>, puis créer un objet <code>sf</code> avec les centres moyens.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="sect032.html#cb295-1" tabindex="-1"></a><span class="do">## Récupération de la projection cartographique dans une variable</span></span>
<span id="cb295-2"><a href="sect032.html#cb295-2" tabindex="-1"></a>ProjCarto <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(Mefaits)</span>
<span id="cb295-3"><a href="sect032.html#cb295-3" tabindex="-1"></a><span class="do">## Calcul du centre moyen pour une année (2019)</span></span>
<span id="cb295-4"><a href="sect032.html#cb295-4" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]), <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>])))</span></code></pre></div>
<pre><code>## [1] 649990.3 157059.3</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="sect032.html#cb297-1" tabindex="-1"></a><span class="do">## Calcul pour toutes les années</span></span>
<span id="cb297-2"><a href="sect032.html#cb297-2" tabindex="-1"></a><span class="co"># vecteur pour les moyennes des X</span></span>
<span id="cb297-3"><a href="sect032.html#cb297-3" tabindex="-1"></a>X.moy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]), <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">1</span>]), <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">1</span>]), <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">1</span>]))</span>
<span id="cb297-4"><a href="sect032.html#cb297-4" tabindex="-1"></a><span class="co"># Vecteur pour les moyennes des Y</span></span>
<span id="cb297-5"><a href="sect032.html#cb297-5" tabindex="-1"></a>Y.moy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]), <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">2</span>]), <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">2</span>]), <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">2</span>]))</span>
<span id="cb297-6"><a href="sect032.html#cb297-6" tabindex="-1"></a><span class="co"># Enregistrement dans un objet sf</span></span>
<span id="cb297-7"><a href="sect032.html#cb297-7" tabindex="-1"></a>CentreMoyen <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Annee =</span> <span class="fu">c</span>(<span class="st">&quot;2019&quot;</span>, <span class="st">&quot;2020&quot;</span>, <span class="st">&quot;2021&quot;</span>, <span class="st">&quot;2022&quot;</span>),</span>
<span id="cb297-8"><a href="sect032.html#cb297-8" tabindex="-1"></a>                          <span class="at">X =</span> X.moy, </span>
<span id="cb297-9"><a href="sect032.html#cb297-9" tabindex="-1"></a>                          <span class="at">Y =</span> Y.moy,</span>
<span id="cb297-10"><a href="sect032.html#cb297-10" tabindex="-1"></a>                          <span class="at">CMx =</span> X.moy,  </span>
<span id="cb297-11"><a href="sect032.html#cb297-11" tabindex="-1"></a>                          <span class="at">CMy =</span> Y.moy)</span>
<span id="cb297-12"><a href="sect032.html#cb297-12" tabindex="-1"></a>CentreMoyen <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(CentreMoyen, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>), <span class="at">crs =</span> ProjCarto)</span>
<span id="cb297-13"><a href="sect032.html#cb297-13" tabindex="-1"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb297-14"><a href="sect032.html#cb297-14" tabindex="-1"></a><span class="fu">print</span>(CentreMoyen)</span></code></pre></div>
<pre><code>## Simple feature collection with 4 features and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 649696 ymin: 157059.3 xmax: 650663.7 ymax: 157544.8
## Projected CRS: NAD83 / MTQ Lambert
##   Annee      CMx      CMy                  geometry
## 1  2019 649990.3 157059.3 POINT (649990.3 157059.3)
## 2  2020 649696.0 157544.8   POINT (649696 157544.8)
## 3  2021 650663.7 157214.8 POINT (650663.7 157214.8)
## 4  2022 650442.5 157237.0   POINT (650442.5 157237)</code></pre>
<p><strong>Point central</strong></p>
<p>Le code ci-dessous illustre comment identifier le point central, qui fait partie du jeu de données, pour l’année 2019.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="sect032.html#cb299-1" tabindex="-1"></a><span class="do">## Calcul de la matrice de distances entre les points de l&#39;année 2019</span></span>
<span id="cb299-2"><a href="sect032.html#cb299-2" tabindex="-1"></a>DistMatrice2019 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(xy<span class="fl">.2019</span>, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>))</span>
<span id="cb299-3"><a href="sect032.html#cb299-3" tabindex="-1"></a><span class="do">## Somme de chaque ligne de la matrice, soit la somme des distances à tous les autres points</span></span>
<span id="cb299-4"><a href="sect032.html#cb299-4" tabindex="-1"></a>M2019<span class="sc">$</span>DistATous <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(DistMatrice2019)</span>
<span id="cb299-5"><a href="sect032.html#cb299-5" tabindex="-1"></a><span class="do">## Sélection du point avec plus petite distance à tous les autres</span></span>
<span id="cb299-6"><a href="sect032.html#cb299-6" tabindex="-1"></a>PointCentral2019 <span class="ot">&lt;-</span> <span class="fu">subset</span>(M2019, M2019<span class="sc">$</span>DistATous<span class="sc">==</span><span class="fu">min</span>(M2019<span class="sc">$</span>DistATous))</span></code></pre></div>
<p><strong>Distance standard sur les coordonnées <em>X</em> et <em>Y</em> et distance standard combinée</strong></p>
<p>Le code ci-dessous permet de calculer les trois distances standards.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="sect032.html#cb300-1" tabindex="-1"></a><span class="do">## Calcul de la distance standard pour une année (2019)</span></span>
<span id="cb300-2"><a href="sect032.html#cb300-2" tabindex="-1"></a><span class="co"># Distance standard sur les coordonnées X et Y</span></span>
<span id="cb300-3"><a href="sect032.html#cb300-3" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb300-4"><a href="sect032.html#cb300-4" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 3732.173 2593.207</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="sect032.html#cb302-1" tabindex="-1"></a><span class="co"># Distance standard</span></span>
<span id="cb302-2"><a href="sect032.html#cb302-2" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb302-3"><a href="sect032.html#cb302-3" tabindex="-1"></a>            (xy<span class="fl">.2019</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 4544.649</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="sect032.html#cb304-1" tabindex="-1"></a><span class="do">## Calcul pour toutes les années et enregistrement des centres moyens dans de nouveaux champs</span></span>
<span id="cb304-2"><a href="sect032.html#cb304-2" tabindex="-1"></a>CentreMoyen<span class="sc">$</span>DS.X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb304-3"><a href="sect032.html#cb304-3" tabindex="-1"></a>                      <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2020</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb304-4"><a href="sect032.html#cb304-4" tabindex="-1"></a>                      <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2021</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb304-5"><a href="sect032.html#cb304-5" tabindex="-1"></a>                      <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2022</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb304-6"><a href="sect032.html#cb304-6" tabindex="-1"></a></span>
<span id="cb304-7"><a href="sect032.html#cb304-7" tabindex="-1"></a>CentreMoyen<span class="sc">$</span>DS.Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb304-8"><a href="sect032.html#cb304-8" tabindex="-1"></a>                       <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2020</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb304-9"><a href="sect032.html#cb304-9" tabindex="-1"></a>                       <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2021</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb304-10"><a href="sect032.html#cb304-10" tabindex="-1"></a>                       <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2022</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb304-11"><a href="sect032.html#cb304-11" tabindex="-1"></a></span>
<span id="cb304-12"><a href="sect032.html#cb304-12" tabindex="-1"></a>CentreMoyen<span class="sc">$</span>DS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb304-13"><a href="sect032.html#cb304-13" tabindex="-1"></a>                              (xy<span class="fl">.2019</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>)),</span>
<span id="cb304-14"><a href="sect032.html#cb304-14" tabindex="-1"></a>                    <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2020</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb304-15"><a href="sect032.html#cb304-15" tabindex="-1"></a>                              (xy<span class="fl">.2020</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>)),<span class="sc">+</span></span>
<span id="cb304-16"><a href="sect032.html#cb304-16" tabindex="-1"></a>                    <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2021</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb304-17"><a href="sect032.html#cb304-17" tabindex="-1"></a>                              (xy<span class="fl">.2021</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>)),<span class="sc">+</span></span>
<span id="cb304-18"><a href="sect032.html#cb304-18" tabindex="-1"></a>                    <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2022</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb304-19"><a href="sect032.html#cb304-19" tabindex="-1"></a>                              (xy<span class="fl">.2022</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>)))</span>
<span id="cb304-20"><a href="sect032.html#cb304-20" tabindex="-1"></a><span class="do">## Visualisation des résultats</span></span>
<span id="cb304-21"><a href="sect032.html#cb304-21" tabindex="-1"></a><span class="fu">head</span>(CentreMoyen)</span></code></pre></div>
<pre><code>## Simple feature collection with 4 features and 6 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 649696 ymin: 157059.3 xmax: 650663.7 ymax: 157544.8
## Projected CRS: NAD83 / MTQ Lambert
##   Annee      CMx      CMy                  geometry     DS.X     DS.Y       DS
## 1  2019 649990.3 157059.3 POINT (649990.3 157059.3) 3732.173 2593.207 4544.649
## 2  2020 649696.0 157544.8   POINT (649696 157544.8) 4134.913 2393.048 4777.466
## 3  2021 650663.7 157214.8 POINT (650663.7 157214.8) 3374.821 2294.171 4080.764
## 4  2022 650442.5 157237.0   POINT (650442.5 157237) 3601.208 2170.215 4204.585</code></pre>
<p><strong>Représentations graphiques de la dispersion</strong></p>
<p>Une fois que la couche <code>sf</code> des centres moyens avec les trois champs pour la distance standard est créée, il suffit de tracer un rectangle et un cercle de distance standard.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="sect032.html#cb306-1" tabindex="-1"></a><span class="do">## Enveloppe convexe</span></span>
<span id="cb306-2"><a href="sect032.html#cb306-2" tabindex="-1"></a>sf.Enveloppes <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="fu">data.frame</span>(<span class="at">Id=</span><span class="fu">c</span>(<span class="st">&quot;2019&quot;</span>, <span class="st">&quot;2020&quot;</span>, <span class="st">&quot;2021&quot;</span>, <span class="st">&quot;2022&quot;</span>)),</span>
<span id="cb306-3"><a href="sect032.html#cb306-3" tabindex="-1"></a>                    <span class="at">geometry =</span> <span class="fu">c</span>(<span class="fu">st_convex_hull</span>(<span class="fu">st_union</span>(M2019)),</span>
<span id="cb306-4"><a href="sect032.html#cb306-4" tabindex="-1"></a>                                 <span class="fu">st_convex_hull</span>(<span class="fu">st_union</span>(M2020)),</span>
<span id="cb306-5"><a href="sect032.html#cb306-5" tabindex="-1"></a>                                 <span class="fu">st_convex_hull</span>(<span class="fu">st_union</span>(M2021)),</span>
<span id="cb306-6"><a href="sect032.html#cb306-6" tabindex="-1"></a>                                 <span class="fu">st_convex_hull</span>(<span class="fu">st_union</span>(M2022))))</span>
<span id="cb306-7"><a href="sect032.html#cb306-7" tabindex="-1"></a><span class="do">## Rectangle avec les distances standards sur les coordonnées X et Y</span></span>
<span id="cb306-8"><a href="sect032.html#cb306-8" tabindex="-1"></a><span class="co">#&#39; Fonction pour tracer le rectangle</span></span>
<span id="cb306-9"><a href="sect032.html#cb306-9" tabindex="-1"></a><span class="co">#&#39; @param MoyX coordonnées X du centre moyen.</span></span>
<span id="cb306-10"><a href="sect032.html#cb306-10" tabindex="-1"></a><span class="co">#&#39; @param MoyY coordonnées Y du centre moyen.</span></span>
<span id="cb306-11"><a href="sect032.html#cb306-11" tabindex="-1"></a><span class="co">#&#39; @param SDx distance standard sur les coordonnées X.</span></span>
<span id="cb306-12"><a href="sect032.html#cb306-12" tabindex="-1"></a><span class="co">#&#39; @param SDy distance standard sur les coordonnées Y.</span></span>
<span id="cb306-13"><a href="sect032.html#cb306-13" tabindex="-1"></a><span class="co">#&#39; @param crs projection cartographique.</span></span>
<span id="cb306-14"><a href="sect032.html#cb306-14" tabindex="-1"></a>CreationRec <span class="ot">&lt;-</span> <span class="cf">function</span>(MoyX, MoyY, SDx, SDy, ProjCarto){</span>
<span id="cb306-15"><a href="sect032.html#cb306-15" tabindex="-1"></a>  pt1 <span class="ot">=</span> <span class="fu">c</span>(MoyX <span class="sc">-</span> SDx, MoyY <span class="sc">-</span> SDy)</span>
<span id="cb306-16"><a href="sect032.html#cb306-16" tabindex="-1"></a>  pt2 <span class="ot">=</span> <span class="fu">c</span>(MoyX <span class="sc">-</span> SDx, MoyY <span class="sc">+</span> SDy)</span>
<span id="cb306-17"><a href="sect032.html#cb306-17" tabindex="-1"></a>  pt3 <span class="ot">=</span> <span class="fu">c</span>(MoyX <span class="sc">+</span> SDx, MoyY <span class="sc">+</span> SDy)</span>
<span id="cb306-18"><a href="sect032.html#cb306-18" tabindex="-1"></a>  pt4 <span class="ot">=</span> <span class="fu">c</span>(MoyX <span class="sc">+</span> SDx, MoyY <span class="sc">-</span> SDy)</span>
<span id="cb306-19"><a href="sect032.html#cb306-19" tabindex="-1"></a>  Rectangle <span class="ot">=</span> <span class="fu">st_polygon</span>(<span class="fu">list</span>(<span class="fu">rbind</span>(pt1, pt2, pt3, pt4, pt1)))</span>
<span id="cb306-20"><a href="sect032.html#cb306-20" tabindex="-1"></a>  Rectangle <span class="ot">=</span> <span class="fu">st_sfc</span>(Rectangle)</span>
<span id="cb306-21"><a href="sect032.html#cb306-21" tabindex="-1"></a>  <span class="fu">st_crs</span>(Rectangle) <span class="ot">=</span> ProjCarto</span>
<span id="cb306-22"><a href="sect032.html#cb306-22" tabindex="-1"></a>  <span class="fu">return</span>(Rectangle)</span>
<span id="cb306-23"><a href="sect032.html#cb306-23" tabindex="-1"></a>}</span>
<span id="cb306-24"><a href="sect032.html#cb306-24" tabindex="-1"></a>MoyX <span class="ot">&lt;-</span> CentreMoyen<span class="sc">$</span>CMx</span>
<span id="cb306-25"><a href="sect032.html#cb306-25" tabindex="-1"></a>MoyY <span class="ot">&lt;-</span> CentreMoyen<span class="sc">$</span>CMy</span>
<span id="cb306-26"><a href="sect032.html#cb306-26" tabindex="-1"></a>SDx <span class="ot">&lt;-</span> CentreMoyen<span class="sc">$</span>DS.X</span>
<span id="cb306-27"><a href="sect032.html#cb306-27" tabindex="-1"></a>SDy <span class="ot">&lt;-</span> CentreMoyen<span class="sc">$</span>DS.Y</span>
<span id="cb306-28"><a href="sect032.html#cb306-28" tabindex="-1"></a>sf.Rectangles <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="fu">data.frame</span>(<span class="at">Id=</span><span class="fu">c</span>(<span class="st">&quot;2019&quot;</span>, <span class="st">&quot;2020&quot;</span>, <span class="st">&quot;2021&quot;</span>, <span class="st">&quot;2022&quot;</span>)),</span>
<span id="cb306-29"><a href="sect032.html#cb306-29" tabindex="-1"></a>                    <span class="at">geometry =</span> <span class="fu">c</span>(<span class="fu">CreationRec</span>(MoyX[<span class="dv">1</span>], MoyY[<span class="dv">1</span>], SDx[<span class="dv">1</span>], SDy[<span class="dv">1</span>], ProjCarto),</span>
<span id="cb306-30"><a href="sect032.html#cb306-30" tabindex="-1"></a>                                 <span class="fu">CreationRec</span>(MoyX[<span class="dv">2</span>], MoyY[<span class="dv">2</span>], SDx[<span class="dv">2</span>], SDy[<span class="dv">2</span>], ProjCarto),</span>
<span id="cb306-31"><a href="sect032.html#cb306-31" tabindex="-1"></a>                                 <span class="fu">CreationRec</span>(MoyX[<span class="dv">3</span>], MoyY[<span class="dv">3</span>], SDx[<span class="dv">3</span>], SDy[<span class="dv">3</span>], ProjCarto),</span>
<span id="cb306-32"><a href="sect032.html#cb306-32" tabindex="-1"></a>                                 <span class="fu">CreationRec</span>(MoyX[<span class="dv">4</span>], MoyY[<span class="dv">4</span>], SDx[<span class="dv">4</span>], SDy[<span class="dv">4</span>], ProjCarto)))</span>
<span id="cb306-33"><a href="sect032.html#cb306-33" tabindex="-1"></a><span class="do">## Cercle de distance standard avec la fonction st_buffer</span></span>
<span id="cb306-34"><a href="sect032.html#cb306-34" tabindex="-1"></a>sf.CercleDS <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(CentreMoyen, <span class="at">dist =</span> CentreMoyen<span class="sc">$</span>DS)</span></code></pre></div>
<p>Le calcul de l’ellipse est un peu plus complexe. Par conséquent, nous avons écrit deux fonctions :</p>
<ul>
<li><code>CreateEllipse</code> qui construit une ellipse à partir d’une couche <code>sf</code> de points.</li>
<li><code>CreateEllipse_gp</code> qui construit des ellipses à partir d’une couche <code>sf</code> de points en fonction d’une colonne indiquant différents groupes de points (ici, les différentes années).</li>
</ul>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="sect032.html#cb307-1" tabindex="-1"></a><span class="do">## Appel des deux fonctions dans le fichier ellipses.R</span></span>
<span id="cb307-2"><a href="sect032.html#cb307-2" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;code_complementaire/ellipses.R&quot;</span>)</span>
<span id="cb307-3"><a href="sect032.html#cb307-3" tabindex="-1"></a><span class="do">## Création d&#39;une ellipse pour une année </span></span>
<span id="cb307-4"><a href="sect032.html#cb307-4" tabindex="-1"></a>sf.Ellipse2019 <span class="ot">&lt;-</span> <span class="fu">CreateEllipse</span>(M2019)</span>
<span id="cb307-5"><a href="sect032.html#cb307-5" tabindex="-1"></a><span class="do">## Création de plusieurs ellipses regroupées selon les différentes années</span></span>
<span id="cb307-6"><a href="sect032.html#cb307-6" tabindex="-1"></a>sf.Ellipse <span class="ot">&lt;-</span> <span class="fu">CreateEllipse_gp</span>(<span class="at">points =</span> Mefaits, <span class="at">group =</span> <span class="st">&quot;ANNEE&quot;</span>)</span>
<span id="cb307-7"><a href="sect032.html#cb307-7" tabindex="-1"></a><span class="fu">head</span>(sf.Ellipse)</span></code></pre></div>
<pre><code>## Simple feature collection with 4 features and 12 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 643833.8 ymin: 153377.3 xmax: 655559 ymax: 160937.9
## Projected CRS: NAD83 / MTQ Lambert
##        CMx      CMy   Sigmax   Sigmay       Lx        Ly     Aire    Theta
## 1 649990.3 157059.3 3055.157 5683.790 6110.315 11367.580 54553357 64.60944
## 2 649696.0 157544.8 3154.712 5994.647 6309.423 11989.294 59411858 75.81068
## 3 650663.7 157214.8 3128.891 4869.299 6257.783  9738.598 47863757 76.14675
## 4 650442.5 157237.0 2540.594 5406.184 5081.187 10812.368 43149511 68.52718
##   ThetaCorr  Major  Minor                       geometry ANNEE
## 1  64.60944 SigmaY SigmaX POLYGON ((655125.1 159496.4...  2019
## 2  75.81068 SigmaY SigmaX POLYGON ((655507.7 159014.3...  2020
## 3  76.14675 SigmaY SigmaX POLYGON ((655391.4 158380.7...  2021
## 4  68.52718 SigmaY SigmaX POLYGON ((655473.5 159216, ...  2022</code></pre>
<p>Les quatre représentations de la dispersion sont présentées à la figure <a href="sect032.html#fig:RepresentationDispersion">3.7</a> : 1) enveloppe convexe (gris), 2) cercle de distance standard (bleu), 3) rectangle de distance standard sur les X et Y (noir) et 4) ellipse de distance standard (rouge).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:RepresentationDispersion"></span>
<img src="GMQ405_files/figure-html/RepresentationDispersion-1.png" alt="Représentations de la dispersion des méfaits pour les quatre années" width="85%" />
<p class="caption">
Figure 3.7: Représentations de la dispersion des méfaits pour les quatre années
</p>
</div>
</div>
<div id="sect03132" class="section level4 hasAnchor" number="3.2.3.2">
<h4><span class="header-section-number">3.2.3.2</span> Calcul de mesures pondérées<a href="sect032.html#sect03132" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour illustrer le calcul des mesures pondérées, nous utilisons des données sur les effectifs du premier et du dernier déciles de revenu après impôt des familles économiques pour les secteurs de recensement de la ville de Sherbrooke en 2021 (figure <a href="sect032.html#fig:CartesDecilesPremierDernier">3.8</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CartesDecilesPremierDernier"></span>
<img src="GMQ405_files/figure-html/CartesDecilesPremierDernier-1.png" alt="Déciles extrêmes de revenu après impôt des familles économiques" width="85%" />
<p class="caption">
Figure 3.8: Déciles extrêmes de revenu après impôt des familles économiques
</p>
</div>
<p>Le code suivant permet d’importer et de structurer les données, puis de calculer les différentes mesures (centre moyen pondéré et distance standard pondérée).</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="sect032.html#cb309-1" tabindex="-1"></a><span class="do">## Importation et structuration des données</span></span>
<span id="cb309-2"><a href="sect032.html#cb309-2" tabindex="-1"></a>dfdecile <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/chap03/DataDecilesSR.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb309-3"><a href="sect032.html#cb309-3" tabindex="-1"></a>dfdecile<span class="sc">$</span>SRIDU <span class="ot">&lt;-</span> <span class="fu">substr</span>(dfdecile<span class="sc">$</span>SRIDU, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb309-4"><a href="sect032.html#cb309-4" tabindex="-1"></a>SR <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/Recen2021Sherbrooke.gpkg&quot;</span>,</span>
<span id="cb309-5"><a href="sect032.html#cb309-5" tabindex="-1"></a>              <span class="at">layer =</span> <span class="st">&quot;DR_SherbSRDonnees2021&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb309-6"><a href="sect032.html#cb309-6" tabindex="-1"></a>SR <span class="ot">&lt;-</span> <span class="fu">merge</span>(SR[,<span class="fu">c</span>(<span class="st">&quot;SRIDU&quot;</span>)], dfdecile, <span class="at">by =</span> <span class="st">&quot;SRIDU&quot;</span>)</span>
<span id="cb309-7"><a href="sect032.html#cb309-7" tabindex="-1"></a>ProjCarto <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(SR)</span>
<span id="cb309-8"><a href="sect032.html#cb309-8" tabindex="-1"></a><span class="do">## Coordonnées géographiques des secteurs de recensement</span></span>
<span id="cb309-9"><a href="sect032.html#cb309-9" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_point_on_surface</span>(SR))</span>
<span id="cb309-10"><a href="sect032.html#cb309-10" tabindex="-1"></a><span class="do">## Pondérations pour les deux déciles</span></span>
<span id="cb309-11"><a href="sect032.html#cb309-11" tabindex="-1"></a>wd1  <span class="ot">&lt;-</span> SR<span class="sc">$</span>D1</span>
<span id="cb309-12"><a href="sect032.html#cb309-12" tabindex="-1"></a>wd10 <span class="ot">&lt;-</span> SR<span class="sc">$</span>D10</span>
<span id="cb309-13"><a href="sect032.html#cb309-13" tabindex="-1"></a><span class="do">## Sommes des pondérations</span></span>
<span id="cb309-14"><a href="sect032.html#cb309-14" tabindex="-1"></a>swd1  <span class="ot">&lt;-</span> <span class="fu">sum</span>(wd1)</span>
<span id="cb309-15"><a href="sect032.html#cb309-15" tabindex="-1"></a>swd10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(wd10)</span>
<span id="cb309-16"><a href="sect032.html#cb309-16" tabindex="-1"></a><span class="do">## Calcul du centre pondéré</span></span>
<span id="cb309-17"><a href="sect032.html#cb309-17" tabindex="-1"></a>XmoyD1  <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy[,<span class="dv">1</span>]<span class="sc">*</span>wd1) <span class="sc">/</span> swd1</span>
<span id="cb309-18"><a href="sect032.html#cb309-18" tabindex="-1"></a>XmoyD10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy[,<span class="dv">1</span>]<span class="sc">*</span>wd10) <span class="sc">/</span> swd10</span>
<span id="cb309-19"><a href="sect032.html#cb309-19" tabindex="-1"></a>YmoyD1  <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy[,<span class="dv">2</span>]<span class="sc">*</span>wd1) <span class="sc">/</span> swd1</span>
<span id="cb309-20"><a href="sect032.html#cb309-20" tabindex="-1"></a>YmoyD10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy[,<span class="dv">2</span>]<span class="sc">*</span>wd10) <span class="sc">/</span> swd10</span>
<span id="cb309-21"><a href="sect032.html#cb309-21" tabindex="-1"></a>CentreMoyenPond <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Decile =</span> <span class="fu">c</span>(<span class="st">&quot;Premier&quot;</span>, <span class="st">&quot;Dernier&quot;</span>),</span>
<span id="cb309-22"><a href="sect032.html#cb309-22" tabindex="-1"></a>                          <span class="at">X =</span> <span class="fu">c</span>(XmoyD1, XmoyD10), </span>
<span id="cb309-23"><a href="sect032.html#cb309-23" tabindex="-1"></a>                          <span class="at">Y =</span> <span class="fu">c</span>(YmoyD1, YmoyD10),</span>
<span id="cb309-24"><a href="sect032.html#cb309-24" tabindex="-1"></a>                          <span class="at">CMwx =</span> <span class="fu">c</span>(XmoyD1, XmoyD10),  </span>
<span id="cb309-25"><a href="sect032.html#cb309-25" tabindex="-1"></a>                          <span class="at">CMwy =</span> <span class="fu">c</span>(YmoyD1, YmoyD10))</span>
<span id="cb309-26"><a href="sect032.html#cb309-26" tabindex="-1"></a>CentreMoyenPond <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(CentreMoyenPond, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>), <span class="at">crs =</span> ProjCarto)</span>
<span id="cb309-27"><a href="sect032.html#cb309-27" tabindex="-1"></a><span class="do">## Calcul de la distance standard pondérée</span></span>
<span id="cb309-28"><a href="sect032.html#cb309-28" tabindex="-1"></a>sdD1  <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">sum</span>(wd1<span class="sc">*</span>(xy[,<span class="dv">1</span>]<span class="sc">-</span> XmoyD1)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> swd1) <span class="sc">+</span> (<span class="fu">sum</span>(wd1<span class="sc">*</span>(xy[,<span class="dv">2</span>]<span class="sc">-</span> YmoyD1)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> swd1))</span>
<span id="cb309-29"><a href="sect032.html#cb309-29" tabindex="-1"></a>sdD10 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">sum</span>(wd10<span class="sc">*</span>(xy[,<span class="dv">1</span>]<span class="sc">-</span> XmoyD10)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> swd1) <span class="sc">+</span> (<span class="fu">sum</span>(wd10<span class="sc">*</span>(xy[,<span class="dv">2</span>]<span class="sc">-</span> YmoyD10)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> swd10))</span>
<span id="cb309-30"><a href="sect032.html#cb309-30" tabindex="-1"></a><span class="do">## Zones tampons avec la distance standard pondérée</span></span>
<span id="cb309-31"><a href="sect032.html#cb309-31" tabindex="-1"></a>CentreMoyenPond<span class="sc">$</span>SDw <span class="ot">&lt;-</span> <span class="fu">c</span>(sdD1, sdD10)</span>
<span id="cb309-32"><a href="sect032.html#cb309-32" tabindex="-1"></a>sf.CercleDSW <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(CentreMoyenPond, <span class="at">dist =</span> CentreMoyenPond<span class="sc">$</span>SDw)</span>
<span id="cb309-33"><a href="sect032.html#cb309-33" tabindex="-1"></a></span>
<span id="cb309-34"><a href="sect032.html#cb309-34" tabindex="-1"></a><span class="do">## Calcul de l&#39;ellipse pondérée pour le premier décile</span></span>
<span id="cb309-35"><a href="sect032.html#cb309-35" tabindex="-1"></a>SR.points <span class="ot">&lt;-</span> <span class="fu">st_point_on_surface</span>(SR)</span>
<span id="cb309-36"><a href="sect032.html#cb309-36" tabindex="-1"></a>ellipse.D1 <span class="ot">&lt;-</span> <span class="fu">CreateEllipse</span>(SR.points, <span class="at">w =</span> SR.points<span class="sc">$</span>D1)</span>
<span id="cb309-37"><a href="sect032.html#cb309-37" tabindex="-1"></a>ellipse.D10 <span class="ot">&lt;-</span> <span class="fu">CreateEllipse</span>(SR.points, <span class="at">w =</span> SR.points<span class="sc">$</span>D10)</span>
<span id="cb309-38"><a href="sect032.html#cb309-38" tabindex="-1"></a></span>
<span id="cb309-39"><a href="sect032.html#cb309-39" tabindex="-1"></a><span class="co"># Carte 1 : premier décile</span></span>
<span id="cb309-40"><a href="sect032.html#cb309-40" tabindex="-1"></a>Carte1 <span class="ot">=</span> <span class="fu">tm_shape</span>(SR)<span class="sc">+</span></span>
<span id="cb309-41"><a href="sect032.html#cb309-41" tabindex="-1"></a>              <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;whitesmoke&quot;</span>, <span class="at">border.col =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb309-42"><a href="sect032.html#cb309-42" tabindex="-1"></a>          <span class="fu">tm_shape</span>(CentreMoyenPond[<span class="dv">1</span>,])<span class="sc">+</span></span>
<span id="cb309-43"><a href="sect032.html#cb309-43" tabindex="-1"></a>              <span class="fu">tm_dots</span>(<span class="at">size =</span> .<span class="dv">5</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb309-44"><a href="sect032.html#cb309-44" tabindex="-1"></a>          <span class="fu">tm_shape</span>(sf.CercleDSW[<span class="dv">1</span>,])<span class="sc">+</span></span>
<span id="cb309-45"><a href="sect032.html#cb309-45" tabindex="-1"></a>              <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)<span class="sc">+</span>      </span>
<span id="cb309-46"><a href="sect032.html#cb309-46" tabindex="-1"></a>          <span class="fu">tm_shape</span>(ellipse.D1)<span class="sc">+</span></span>
<span id="cb309-47"><a href="sect032.html#cb309-47" tabindex="-1"></a>              <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)<span class="sc">+</span>    </span>
<span id="cb309-48"><a href="sect032.html#cb309-48" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">&quot;A. Premier décile (le plus pauvre)&quot;</span>,</span>
<span id="cb309-49"><a href="sect032.html#cb309-49" tabindex="-1"></a>            <span class="at">main.title.size =</span> .<span class="dv">9</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb309-50"><a href="sect032.html#cb309-50" tabindex="-1"></a><span class="co"># Carte 2 : dernier décile</span></span>
<span id="cb309-51"><a href="sect032.html#cb309-51" tabindex="-1"></a>Carte2 <span class="ot">=</span> <span class="fu">tm_shape</span>(SR)<span class="sc">+</span></span>
<span id="cb309-52"><a href="sect032.html#cb309-52" tabindex="-1"></a>              <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;whitesmoke&quot;</span>, <span class="at">border.col =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb309-53"><a href="sect032.html#cb309-53" tabindex="-1"></a>          <span class="fu">tm_shape</span>(CentreMoyenPond[<span class="dv">2</span>,])<span class="sc">+</span></span>
<span id="cb309-54"><a href="sect032.html#cb309-54" tabindex="-1"></a>              <span class="fu">tm_dots</span>(<span class="at">size =</span> .<span class="dv">5</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb309-55"><a href="sect032.html#cb309-55" tabindex="-1"></a>          <span class="fu">tm_shape</span>(sf.CercleDSW[<span class="dv">2</span>,])<span class="sc">+</span></span>
<span id="cb309-56"><a href="sect032.html#cb309-56" tabindex="-1"></a>              <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)<span class="sc">+</span>         </span>
<span id="cb309-57"><a href="sect032.html#cb309-57" tabindex="-1"></a>          <span class="fu">tm_shape</span>(ellipse.D10)<span class="sc">+</span></span>
<span id="cb309-58"><a href="sect032.html#cb309-58" tabindex="-1"></a>              <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)<span class="sc">+</span>    </span>
<span id="cb309-59"><a href="sect032.html#cb309-59" tabindex="-1"></a> <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">&quot;B. Dernier décile (le plus riche)&quot;</span>,</span>
<span id="cb309-60"><a href="sect032.html#cb309-60" tabindex="-1"></a>            <span class="at">main.title.size =</span> .<span class="dv">9</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb309-61"><a href="sect032.html#cb309-61" tabindex="-1"></a><span class="fu">tm_credits</span>(<span class="st">&quot;Source : recensement de 2021, Statistique Canada</span><span class="sc">\n</span><span class="st">Auteur : Jéremy Lécartemplace.&quot;</span>, </span>
<span id="cb309-62"><a href="sect032.html#cb309-62" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>), <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">align =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb309-63"><a href="sect032.html#cb309-63" tabindex="-1"></a><span class="co"># Combinaison des deux cartes</span></span>
<span id="cb309-64"><a href="sect032.html#cb309-64" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte1, Carte2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:MesuresPonderees"></span>
<img src="GMQ405_files/figure-html/MesuresPonderees-1.png" alt="Cercles de distance standard et ellipses pondérés" width="85%" />
<p class="caption">
Figure 3.9: Cercles de distance standard et ellipses pondérés
</p>
</div>
</div>
</div>
</div>
<h3>Références</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-RBoldAir" class="csl-entry">
Apparicio, Philippe et Jérémy Gelb. 2022. <em>Méthodes quantitatives en sciences sociales : un grand bol d’R</em>. FabriqueREL, Licence CC BY-SA. <a href="https://laeq.github.io/LivreMethoQuantBolR/">https://laeq.github.io/LivreMethoQuantBolR/</a>.
</div>
<div id="ref-barbonne2007dynamique" class="csl-entry">
Barbonne, Rémy, Paul Villeneuve et Marius Thériault. 2007. <span>« La dynamique spatiale des march<span>é</span>s locaux de l’emploi au sein du champ m<span>é</span>tropolitain de Qu<span>é</span>bec, 1981–2001. »</span> <em>The Canadian Geographer/Le G<span>é</span>ographe canadien</em> 51 (3). Wiley Online Library: 303‑322. <a href="https://doi.org/10.1111/j.1541-0064.2007.00180.x">https://doi.org/10.1111/j.1541-0064.2007.00180.x</a>.
</div>
<div id="ref-levine2006crime" class="csl-entry">
Levine, Ned. 2006. <span>« Crime mapping and the Crimestat program. »</span> <em>Geographical analysis</em> 38 (1): 41‑56. <a href="https://doi.org/10.1111/j.0016-7363.2005.00673.x">https://doi.org/10.1111/j.0016-7363.2005.00673.x</a>.
</div>
<div id="ref-levine2021crimestat" class="csl-entry">
———. 2021. <span>« CrimeStat IV. »</span> In <em>The Encyclopedia of Research Methods in Criminology and Criminal Justice</em>, sous la dir. de JC Barnes et David R Forde, 1:28‑32. John Wiley &amp; Sons. <a href="https://doi.org/10.1002/9781119111931.ch6">https://doi.org/10.1002/9781119111931.ch6</a>.
</div>
<div id="ref-lopez2015evolution" class="csl-entry">
López Castro, Marco Antonio, Marius Thériault et Marie-Hélène Vandersmissen. 2015. <span>« <span>É</span>volution de la mobilit<span>é</span> des membres de familles monoparentales dans la r<span>é</span>gion m<span>é</span>tropolitaine de Qu<span>é</span>bec de 1996 <span>à</span> 2006: comparaison entre les m<span>é</span>nages matricentriques et patricentriques. »</span> <em>Cahiers de g<span>é</span>ographie du Qu<span>é</span>bec</em> 59 (167): 209‑250. <a href="https://doi.org/10.7202/1036355ar">https://doi.org/10.7202/1036355ar</a>.
</div>
<div id="ref-tveitesde" class="csl-entry">
Tveite, Håvard. 2020. <span>« The <span>QGIS</span> <span>Standard</span> <span>Deviational</span> <span>Ellipse</span> Plugin. »</span> <a href="http://plugins.qgis.org/plugins/SDEllipse/" class="uri">http://plugins.qgis.org/plugins/SDEllipse/</a>.
</div>
<div id="ref-wang2015confidence" class="csl-entry">
Wang, Bin, Wenzhong Shi et Zelang Miao. 2015. <span>« Confidence analysis of standard deviational ellipse and its extension into higher dimensional Euclidean space. »</span> <em>PloS one</em> 10 (3): e0118537. <a href="https://doi.org/10.1371%2Fjournal.pone.0118537">https://doi.org/10.1371%2Fjournal.pone.0118537</a>.
</div>
<div id="ref-wong1999geostatistics" class="csl-entry">
Wong, David WS. 1999. <span>« Geostatistics as measures of spatial segregation. »</span> <em>Urban geography</em> 20 (7): 635‑647. <a href="https://doi.org/10.2747/0272-3638.20.7.635">https://doi.org/10.2747/0272-3638.20.7.635</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect031.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect033.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["GMQ405.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
