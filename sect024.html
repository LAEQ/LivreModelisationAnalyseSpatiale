<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Autocorrélation spatiale locale | Notes de cours GMQ405 : Modélisation et analyse spatiale</title>
  <meta name="description" content="Mettre le description du cours." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Autocorrélation spatiale locale | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Mettre le description du cours." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Autocorrélation spatiale locale | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  
  <meta name="twitter:description" content="Mettre le description du cours." />
  <meta name="twitter:image" content="/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio, département de géomatique appliquée, Université de Sherbrooke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect023.html"/>
<link rel="next" href="sect025.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GMQ405 : modélisation et analyse spatiale</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Comment lire ce manuel?</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en géomatique appliquée et utiliser R?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
</ul></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Manipulation des données spatiales dans R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Importation de données géographiques</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sect011.html"><a href="sect011.html#sect0111"><i class="fa fa-check"></i><b>1.1.1</b> Importation de données vectorielles</a></li>
<li class="chapter" data-level="1.1.2" data-path="sect011.html"><a href="sect011.html#sect0112"><i class="fa fa-check"></i><b>1.1.2</b> Importation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Manipulation de données vectorielles</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Fonctions relatives à la projection cartographique</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Fonctions d’opérations géométriques sur une couche</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect01213"><i class="fa fa-check"></i><b>1.2.3</b> Fonctions d’opérations géométriques entre deux couches</a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#sect0124"><i class="fa fa-check"></i><b>1.2.4</b> Fonctions de mesures géométriques et de récupération des coordonnées géographiques</a></li>
<li class="chapter" data-level="1.2.5" data-path="sect012.html"><a href="sect012.html#sect0125"><i class="fa fa-check"></i><b>1.2.5</b> Jointures spatiales</a></li>
<li class="chapter" data-level="1.2.6" data-path="sect012.html"><a href="sect012.html#sect0126"><i class="fa fa-check"></i><b>1.2.6</b> Requêtes spatiales</a></li>
<li class="chapter" data-level="1.2.7" data-path="sect012.html"><a href="sect012.html#sect0127"><i class="fa fa-check"></i><b>1.2.7</b> Manipulation des données attributaires</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Manipulation de données matricielles (<em>raster</em>)</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> Mosaïquage et découpage d’images</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Requêtes attributaires sur des images</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Exportation de données spatiales de R vers des formats géographiques</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Exportation de données vectorielles <code>sf</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Exportation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect015.html"><a href="sect015.html"><i class="fa fa-check"></i><b>1.5</b> Cartographie avec R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sect015.html"><a href="sect015.html#sect0151"><i class="fa fa-check"></i><b>1.5.1</b> Manipulation des couches géométriques</a></li>
<li class="chapter" data-level="1.5.2" data-path="sect015.html"><a href="sect015.html#sect0152"><i class="fa fa-check"></i><b>1.5.2</b> Cartes interactives</a></li>
<li class="chapter" data-level="1.5.3" data-path="sect015.html"><a href="sect015.html#sect0153"><i class="fa fa-check"></i><b>1.5.3</b> Mise en page d’une carte</a></li>
<li class="chapter" data-level="1.5.4" data-path="sect015.html"><a href="sect015.html#sect0154"><i class="fa fa-check"></i><b>1.5.4</b> Exportation d’une carte</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.6</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="1.7" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.7</b> Exercices de révision</a></li>
</ul></li>
<li class="part"><span><b>II Autocorrélation spatiale</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Autocorrélation spatiale</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion d’autocorrélation spatiale</a></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Matrices de pondération spatiale</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Matrices de contiguïté</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Matrices de proximité spatiale</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Standardisation des matrices de pondération spatiale en ligne</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Construction de matrices de pondération spatiale dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Autocorrélation spatiale globale</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Statistique du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Statistiques de comptage de jointure (<em>Join Count Statistics</em>)</a></li>
<li class="chapter" data-level="2.3.3" data-path="sect023.html"><a href="sect023.html#sect0233"><i class="fa fa-check"></i><b>2.3.3</b> Indice de Lee : autocorrélation spatiale dans un contexte bivarié</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Autocorrélation spatiale locale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#sect0241"><i class="fa fa-check"></i><b>2.4.1</b> Statistiques locales de Getis et Ord : repérer les points chauds et froids pour une variable continue</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#sect0242"><i class="fa fa-check"></i><b>2.4.2</b> Version locale du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#sect0243"><i class="fa fa-check"></i><b>2.4.3</b> Typologie basée sur le diagramme de Moran</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#sect0244"><i class="fa fa-check"></i><b>2.4.4</b> Version locale des statistiques de comptage de jointure (<em>Join Count Statistics</em>)</a></li>
<li class="chapter" data-level="2.4.5" data-path="sect024.html"><a href="sect024.html#sect0245"><i class="fa fa-check"></i><b>2.4.5</b> Version locale de l’indice de Lee</a></li>
<li class="chapter" data-level="2.4.6" data-path="sect024.html"><a href="sect024.html#sect0246"><i class="fa fa-check"></i><b>2.4.6</b> Typologie basée sur le diagramme de Moran dans un contexte bivarié</a></li>
<li class="chapter" data-level="2.4.7" data-path="sect024.html"><a href="sect024.html#sect0247"><i class="fa fa-check"></i><b>2.4.7</b> Autocorrélation locale pour une variable qualitative (catégorielle) : l’indicateur ELSA</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Méthodes de répartition ponctuelle</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Fréquence et densité des points dans l’espace d’étude</a></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Analyse centrographique</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0311"><i class="fa fa-check"></i><b>3.2.1</b> Paramètres de tendance centrale d’un semis de points</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0312"><i class="fa fa-check"></i><b>3.2.2</b> Paramètres de dispersion d’un semis de points</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0313"><i class="fa fa-check"></i><b>3.2.3</b> Mise en œuvre de l’analyse centrographique dans R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Forme d’un semis de points</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Méthode du plus proche voisin</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Méthode des quadrats</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Identification des agrégats spatiaux</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sect034.html"><a href="sect034.html#sect0341"><i class="fa fa-check"></i><b>3.4.1</b> Cartographie de la densité dans une maille irrégulière</a></li>
<li class="chapter" data-level="3.4.2" data-path="sect034.html"><a href="sect034.html#sect0342"><i class="fa fa-check"></i><b>3.4.2</b> Cartographie de la densité dans une maille régulière</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Méthodes de détection d’agrégats spatiaux et spatio-temporels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Agrégats d’entités spatiales ponctuelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sect041.html"><a href="sect041.html#sect0411"><i class="fa fa-check"></i><b>4.1.1</b> DBSCAN : agrégats spatiaux</a></li>
<li class="chapter" data-level="4.1.2" data-path="sect041.html"><a href="sect041.html#sect0412"><i class="fa fa-check"></i><b>4.1.2</b> ST-DBSCAN : agrégats spatio-temporels</a></li>
<li class="chapter" data-level="4.1.3" data-path="sect041.html"><a href="sect041.html#sect0414"><i class="fa fa-check"></i><b>4.1.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Méthodes de balayage de Kulldorff</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Objectifs de la méthode, types d’analyses, de modèles et d’agrégats</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Principes de base de la méthode</a></li>
<li class="chapter" data-level="4.2.3" data-path="sect042.html"><a href="sect042.html#sect043"><i class="fa fa-check"></i><b>4.2.3</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="4.4" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Mesures d’accessibilité spatiale selon les différents de modes de transport</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Notions relatives à l’analyse de réseau</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sect051.html"><a href="sect051.html#sect0511"><i class="fa fa-check"></i><b>5.1.1</b> Définition d’un réseau</a></li>
<li class="chapter" data-level="5.1.2" data-path="sect051.html"><a href="sect051.html#sect0512"><i class="fa fa-check"></i><b>5.1.2</b> Principaux problèmes résolus en analyse de réseau</a></li>
<li class="chapter" data-level="5.1.3" data-path="sect051.html"><a href="sect051.html#sect0513"><i class="fa fa-check"></i><b>5.1.3</b> Analyse de réseau et entités polygonales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Construction d’un réseau avec R5R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sect052.html"><a href="sect052.html#sect0521"><i class="fa fa-check"></i><b>5.2.1</b> Extraction des données spatiales pour R5R</a></li>
<li class="chapter" data-level="5.2.2" data-path="sect052.html"><a href="sect052.html#sect0522"><i class="fa fa-check"></i><b>5.2.2</b> Construction du réseau avec R5R</a></li>
<li class="chapter" data-level="5.2.3" data-path="sect052.html"><a href="sect052.html#sect0523"><i class="fa fa-check"></i><b>5.2.3</b> Calcul d’itinéraires avec R5R selon le mode de transport</a></li>
<li class="chapter" data-level="5.2.4" data-path="sect052.html"><a href="sect052.html#sect0524"><i class="fa fa-check"></i><b>5.2.4</b> Calcul de matrices OD selon différents modes de transport</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mesures d’accessibilité</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sect053.html"><a href="sect053.html#sect0531"><i class="fa fa-check"></i><b>5.3.1</b> Notion d’accessibilité</a></li>
<li class="chapter" data-level="5.3.2" data-path="sect053.html"><a href="sect053.html#sect0532"><i class="fa fa-check"></i><b>5.3.2</b> Accessibilité spatiale potentielle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Mesures d’accessibilité spatiale potentielle dans R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="sect054.html"><a href="sect054.html#sect0541"><i class="fa fa-check"></i><b>5.4.1</b> Accessibilité spatiale potentielle aux supermarchés</a></li>
<li class="chapter" data-level="5.4.2" data-path="sect054.html"><a href="sect054.html#sect0542"><i class="fa fa-check"></i><b>5.4.2</b> Accessibilité spatiale potentielle aux patinoires extérieures</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Analyses d’évènements localisés sur un réseau</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Cartographie de la densité d’évènements sur un réseau</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Explication du NKDE et du TNKDE</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Mesure d’autocorrélation spatiale sur un réseau</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sect063.html"><a href="sect063.html#sect0631"><i class="fa fa-check"></i><b>6.3.1</b> Getis et Ord</a></li>
<li class="chapter" data-level="6.3.2" data-path="sect063.html"><a href="sect063.html#sect0632"><i class="fa fa-check"></i><b>6.3.2</b> Typologie basée sur le diagramme de Moran</a></li>
<li class="chapter" data-level="6.3.3" data-path="sect063.html"><a href="sect063.html#sect0633"><i class="fa fa-check"></i><b>6.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> DBSCAN sur un réseau</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="sect064.html"><a href="sect064.html#sect0641"><i class="fa fa-check"></i><b>6.4.1</b> Explication du NKDE et du TNKDE</a></li>
<li class="chapter" data-level="6.4.2" data-path="sect064.html"><a href="sect064.html#sect0642"><i class="fa fa-check"></i><b>6.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="sect065.html"><a href="sect065.html"><i class="fa fa-check"></i><b>6.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="6.6" data-path="sect066.html"><a href="sect066.html"><i class="fa fa-check"></i><b>6.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Introduction aux modèles de régression spatiale</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Modèles économétriques spatiaux</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sect071.html"><a href="sect071.html#sect0711"><i class="fa fa-check"></i><b>7.1.1</b> Bref retour sur la régression linéaire multiple</a></li>
<li class="chapter" data-level="7.1.2" data-path="sect071.html"><a href="sect071.html#sect0712"><i class="fa fa-check"></i><b>7.1.2</b> Les différents modèles spatiaux autorégressifs</a></li>
<li class="chapter" data-level="7.1.3" data-path="sect071.html"><a href="sect071.html#sect0713"><i class="fa fa-check"></i><b>7.1.3</b> Quel modèle choisir?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Modèles généralisés additifs (GAM) avec une <em>spline</em> bivariée sur les coordonnées géographiques</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Principe de base d’un GAM intégrant l’espace</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Construction d’un modèle GAM dans R</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Régression géographiquement pondérée</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Principe de base</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Construction et analyse du modèle GWR dans R</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Méthodes de classification non supervisée spatiale</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Méthodes de classification non supervisée avec contrainte spatiale</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Algorithmes AZP</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Algorithme SKATER</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Algorithmes REDCAP</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Algorithme du <em>max-p-regions problem</em></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Méthodes de classification non supervisée avec une dimension spatiale</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Classification ascendante hiérarchique spatiale (<em>ClustGeo</em>)</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> <em>Spatial fuzzy c-means</em></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect083.html"><a href="sect083.html"><i class="fa fa-check"></i><b>8.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="8.4" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Méthodes d’interpolation spatiale</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Méthodes déterministes</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Interpolation polynomiale locale</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Interpolation de l’inverse à la distance (<em>IDW</em>)</a></li>
<li class="chapter" data-level="9.1.3" data-path="sect091.html"><a href="sect091.html#sect0913"><i class="fa fa-check"></i><b>9.1.3</b> Fonctions relationnelles</a></li>
<li class="chapter" data-level="9.1.4" data-path="sect091.html"><a href="sect091.html#sect0914"><i class="fa fa-check"></i><b>9.1.4</b> Fonctions conditionnelles</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Méthodes géostatistiques</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> Krigeage simple</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0922"><i class="fa fa-check"></i><b>9.2.2</b> Krigeage universel</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.3</b> Co-krigeage</a></li>
<li class="chapter" data-level="9.2.4" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.4</b> Krigeage résiduel</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Correction des exercices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect1001.html"><a href="sect1001.html"><i class="fa fa-check"></i><b>10.1</b> Exercices du chapitre 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect1001.html"><a href="sect1001.html#sect10011"><i class="fa fa-check"></i><b>10.1.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect1001.html"><a href="sect1001.html#sect10012"><i class="fa fa-check"></i><b>10.1.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="sect1001.html"><a href="sect1001.html#sect10013"><i class="fa fa-check"></i><b>10.1.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="sect1001.html"><a href="sect1001.html#sect10014"><i class="fa fa-check"></i><b>10.1.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect1002.html"><a href="sect1002.html"><i class="fa fa-check"></i><b>10.2</b> Exercices du chapitre 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect1002.html"><a href="sect1002.html#sect10021"><i class="fa fa-check"></i><b>10.2.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect1002.html"><a href="sect1002.html#sect10022"><i class="fa fa-check"></i><b>10.2.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.2.3" data-path="sect1002.html"><a href="sect1002.html#sect10023"><i class="fa fa-check"></i><b>10.2.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.2.4" data-path="sect1002.html"><a href="sect1002.html#sect10024"><i class="fa fa-check"></i><b>10.2.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect1003.html"><a href="sect1003.html"><i class="fa fa-check"></i><b>10.3</b> Exercices du chapitre 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sect1003.html"><a href="sect1003.html#sect10031"><i class="fa fa-check"></i><b>10.3.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="sect1003.html"><a href="sect1003.html#sect10032"><i class="fa fa-check"></i><b>10.3.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.3.3" data-path="sect1003.html"><a href="sect1003.html#sect10033"><i class="fa fa-check"></i><b>10.3.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sect1004.html"><a href="sect1004.html"><i class="fa fa-check"></i><b>10.4</b> Exercices du chapitre 4</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect1004.html"><a href="sect1004.html#sect10041"><i class="fa fa-check"></i><b>10.4.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect1004.html"><a href="sect1004.html#sect10042"><i class="fa fa-check"></i><b>10.4.2</b> Exercice 2</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect1005.html"><a href="sect1005.html"><i class="fa fa-check"></i><b>10.5</b> Exercices du chapitre 5</a></li>
<li class="chapter" data-level="10.6" data-path="sect1006.html"><a href="sect1006.html"><i class="fa fa-check"></i><b>10.6</b> Exercices du chapitre 6</a></li>
<li class="chapter" data-level="10.7" data-path="sect1007.html"><a href="sect1007.html"><i class="fa fa-check"></i><b>10.7</b> Exercices du chapitre 7</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sect1007.html"><a href="sect1007.html#sect10071"><i class="fa fa-check"></i><b>10.7.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.7.2" data-path="sect1007.html"><a href="sect1007.html#sect10072"><i class="fa fa-check"></i><b>10.7.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.7.3" data-path="sect1007.html"><a href="sect1007.html#sect10073"><i class="fa fa-check"></i><b>10.7.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="sect1008.html"><a href="sect1008.html"><i class="fa fa-check"></i><b>10.8</b> Exercices du chapitre 8</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="sect1008.html"><a href="sect1008.html#sect10081"><i class="fa fa-check"></i><b>10.8.1</b> Exercice 1</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="sect1009.html"><a href="sect1009.html"><i class="fa fa-check"></i><b>10.9</b> Exercices du chapitre 9</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours GMQ405 :
Modélisation et analyse spatiale</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect024" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Autocorrélation spatiale locale<a href="sect024.html#sect024" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nous avons vu que les statistiques d’autocorrélation spatiale globale comme le <em>I</em> de Moran (section <a href="sect023.html#sect0231">2.3.1</a>), les statistiques de comptage de jointures (section <a href="sect023.html#sect0232">2.3.2</a>) et l’indice de Lee (section <a href="sect023.html#sect0233">2.3.3</a>) renvoient une valeur pour l’ensemble de l’espace d’étude. Une fois démontrée la présence d’autocorrélation spatiale globale (positive ou négative), il est pertinent de réaliser une analyse de l’autocorrélation spatiale locale afin de vérifier si chaque entité spatiale est significativement (dis)semblable de celles voisines ou proches. Comme l’indique le terme <em>locale</em>, les mesures d’autocorrélation spatiale locale renvoient des valeurs pour chacune des entités spatiales.</p>
<div id="sect0241" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Statistiques locales de Getis et Ord : repérer les points chauds et froids pour une variable continue<a href="sect024.html#sect0241" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect02411" class="section level4 hasAnchor" number="2.4.1.1">
<h4><span class="header-section-number">2.4.1.1</span> Formulation des statistiques locale de Getis et Ord<a href="sect024.html#sect02411" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Les statistiques locales de Getis et Ord permettent d’évaluer la similarité d’une entité spatiale avec celles voisines ou proches en fonction <strong>d’une variable continue</strong> <span class="citation">(<a href="#ref-getis1992analysis">Getis et Ord 1992</a>; <a href="#ref-ord1995local">Ord et Getis 1995</a>)</span>. Autrement dit, elles nous informent si les valeurs fortes et les valeurs faibles d’une variable continue se regroupent significativement dans l’espace, et ce, avec n’importe quel type de matrice de contiguïté, de proximité, de plus proches voisins, etc. Cartographier ces statistiques permet alors de vérifier simultanément l’existence d’agrégats spatiaux de valeurs fortes (<strong>points chauds</strong>) et d’agrégats spatiaux de valeurs faibles (<strong>points froids</strong>).</p>
<p>Il existe deux versions légèrement différentes de ces mesures locales <span class="citation">(<a href="#ref-getis1992analysis">Getis et Ord 1992</a>; <a href="#ref-ord1995local">Ord et Getis 1995</a>)</span> :</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(G_i\)</span> tient compte uniquement des entités voisines ou proches à l’entité spatiale <span class="math inline">\(i\)</span>. Ainsi, <span class="math inline">\(\Sigma_{j=1}^n w_{ij}x_j\)</span> représente la moyenne pondérée (par les poids de la matrice de pondération spatiale standardisée en ligne) de la variable continue <span class="math inline">\(X\)</span> dans les entités voisines ou proches.</p></li>
<li><p><span class="math inline">\(G_i^*\)</span> tient compte à la fois des valeurs des entités voisines ou proches, mais aussi de celle de <span class="math inline">\(i\)</span>.</p></li>
</ol>
<p>Toutefois, nous cartographions rarement les valeurs de <span class="math inline">\(G_i\)</span> et de <span class="math inline">\(G_i^*\)</span>, mais plutôt celles de <span class="math inline">\(Z(G_i)\)</span> et de <span class="math inline">\(Z(G_i^*)\)</span> (équations <a href="sect024.html#eq:LocalGetis">(2.20)</a> et <a href="sect024.html#eq:LocalGetisStar">(2.21)</a>) qui représentent la cote Z qui, lorsque positive, indique un agrégat de valeurs plus élevées que la moyenne, et qui, lorsque négative, indique un agrégat de valeurs plus faibles que la moyenne <span class="citation">(<a href="#ref-bivand2018comparing">Bivand et Wong 2018</a>)</span>.</p>
<p>À première vue, ces deux formules peuvent sembler quelque peu complexes! Retenez simplement que le numérateur est la différence entre <span class="math inline">\(G_i\)</span> ou <span class="math inline">\(G_i^*\)</span> et la valeur attendue de <span class="math inline">\(G_i\)</span> ou de <span class="math inline">\(G_i^*\)</span> pour une distribution aléatoire (soit globalement la moyenne de la variable), tandis que le dénominateur représente l’écart-type de <span class="math inline">\(G_i\)</span> ou de <span class="math inline">\(G_i^*\)</span>.</p>
<p><span class="math display" id="eq:LocalGetis">\[\begin{equation}  
Z(G_i) = \frac{\bigr[ \Sigma_{j=1}^n w_{ij}x_j \bigr] - \bigr[ (\Sigma_{j=1}^nw_{ij}) \bar x_i \bigr]}
{s_i \sqrt{ \Bigr[ \Bigl((n-1)\Sigma_{j=1}^nw_{ij}^2-(\Sigma_{j=1}^nw_{ij})^2\Bigl) \Bigr] / (n-1) } } = \frac{G_i - \mathbb{E}(G_i)}{\sqrt{Var(G_i)}} \text{, }i \neq j
\tag{2.20}
\end{equation}\]</span>
</p>
<p><span class="math display">\[\text{avec } \bar x_i=\frac{\Sigma_{j=1}^nx_j}{n-1}  \text{, et } s_i = \sqrt{ \frac{\Sigma_{j=1}^nx_j^2}{n-1}-\bar x^2} \text{, } i \neq j\]</span>
<span class="math display" id="eq:LocalGetisStar">\[\begin{equation}  
Z(G_i^*) = \frac{\bigr[ \Sigma_{j=1}^n w_{ij}x_j \bigr] - \bigr[ (\Sigma_{j=1}^nw_{ij}) \bar x^* \bigr]}
{s^* \sqrt{ \Bigr[ \Bigl((n-1)\Sigma_{j=1}^nw_{ij}^2-(\Sigma_{j=1}^nw_{ij})^2\Bigl) \Bigr] / (n-1) } } = \frac{G_i^* - \mathbb{E}(G_i^*)}{\sqrt{Var(G_i^*)}}\text{, tous }
\tag{2.21}
\end{equation}\]</span>
</p>
<p><span class="math display">\[\text{avec } \bar x^*=\frac{\Sigma_{j=1}^nx_j}{n}  \text{, et } s^* = \sqrt{ \frac{\Sigma_{j=1}^nx_j^2}{n}-\bar x^{*2}} \text{, tous } j\]</span>
avec :</p>
<ul>
<li><p><em>n</em>, le nombre d’entités spatiales dans la couche géographique;</p></li>
<li><p><span class="math inline">\(w_{ij}\)</span>, la valeur de la pondération spatiale entre les entités spatiales <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>;</p></li>
<li><p><span class="math inline">\(x_j\)</span>, la valeur de variable continue <span class="math inline">\(X\)</span> pour l’entité spatiale <span class="math inline">\(j\)</span>;</p></li>
<li><p><span class="math inline">\(\bar{x^*}\)</span>, la valeur moyenne de la variable pour toutes les observations;</p></li>
<li><p><span class="math inline">\(\bar{x_i}\)</span>, la valeur moyenne de la variable pour toutes les observations sauf <span class="math inline">\(i\)</span>.</p></li>
</ul>
<div class="bloc_astuce">
<p><strong>Deux manières de calculer <span class="math inline">\(Z(G_i)\)</span> et <span class="math inline">\(Z(G_i^*)\)</span> avec le <em>package</em> <code>spdep</code></strong></p>
<ul>
<li><p>la fonction <code>localG</code> vous renvoie les valeurs de cote Z (<em>Z-score</em> en anglais) des statistiques de Getis et Ord avec les formules décrites plus haut.</p></li>
<li><p>la fonction <code>localG_perm</code> permet de les obtenir avec la méthode Monte-Carlo (avec habituellement 999 permutations).</p></li>
</ul>
<p><strong>Cartographie des cotes Z</strong></p>
<p>À partir des cotes Z, utilisez les bornes des classes suivantes et la palette de couleurs <code>-RdBu</code> :</p>
<ul>
<li>Minimum à -3,29 : point froid significatif avec <em>p</em> &lt; 0,001 (bleu foncé)</li>
<li>-3,29 à -2,58 : point froid significatif avec <em>p</em> &lt; 0,01 (bleu)</li>
<li>-2,58 à -1,96 : point froid significatif avec <em>p</em> &lt; 0,05 (bleu pâle)</li>
<li>-1,96 à 1,96 : non significatif, (gris)</li>
<li>1,96 à 2,58 : point chaud significatif avec <em>p</em> &lt; 0,05 (rouge pâle)</li>
<li>2,58 à 3,29 : point chaud significatif avec <em>p</em> &lt; 0,01 (rouge)</li>
<li>3,29 à Maximum : point chaud significatif avec *p &lt;0 ,001 (rouge foncé)</li>
</ul>
<p>Avec la palette <code>-RdBu</code>, les points froids et les points chauds sont respectivement bleus et rouges comme les pastilles de votre robinet! Bref, un beau travail de plomberie!</p>
<p>Pour un rappel sur la cote Z et les valeurs de <em>p</em> associées, consultez <a href="https://pro.arcgis.com/fr/pro-app/latest/tool-reference/spatial-statistics/what-is-a-z-score-what-is-a-p-value.htm">ce lien</a>.</p>
</div>
</div>
<div id="sect02412" class="section level4 hasAnchor" number="2.4.1.2">
<h4><span class="header-section-number">2.4.1.2</span> Mise en œuvre dans R<a href="sect024.html#sect02412" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La syntaxe ci-dessous calcule les deux statistiques locales avec <code>localG</code> et <code>localG_perm</code> pour le revenu moyen des ménages pour les aires de diffusion de 2021 de la ville de Sherbrooke.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="sect024.html#cb260-1" tabindex="-1"></a>Rook1 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(AD.DR, <span class="at">queen=</span><span class="cn">FALSE</span>)</span>
<span id="cb260-2"><a href="sect024.html#cb260-2" tabindex="-1"></a><span class="do">## Matrice de pondération</span></span>
<span id="cb260-3"><a href="sect024.html#cb260-3" tabindex="-1"></a>W.RookG    <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Rook1, <span class="at">zero.policy=</span><span class="cn">TRUE</span>)</span>
<span id="cb260-4"><a href="sect024.html#cb260-4" tabindex="-1"></a>W.RookStar <span class="ot">&lt;-</span><span class="fu">nb2listw</span>(<span class="fu">include.self</span>(Rook1), <span class="at">zero.policy=</span><span class="cn">TRUE</span>) <span class="co"># matrice incluant elle-même</span></span>
<span id="cb260-5"><a href="sect024.html#cb260-5" tabindex="-1"></a><span class="do">## Calcul du Z(Gi) et du Z(Gi*)</span></span>
<span id="cb260-6"><a href="sect024.html#cb260-6" tabindex="-1"></a>localGetis     <span class="ot">&lt;-</span> <span class="fu">localG</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.RookG)</span>
<span id="cb260-7"><a href="sect024.html#cb260-7" tabindex="-1"></a>localGetisStar <span class="ot">&lt;-</span> <span class="fu">localG</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.RookStar)</span>
<span id="cb260-8"><a href="sect024.html#cb260-8" tabindex="-1"></a><span class="do">## Calcul avec la méthode Monte-Carlo (999 permutations)</span></span>
<span id="cb260-9"><a href="sect024.html#cb260-9" tabindex="-1"></a>localGetis.MC999     <span class="ot">&lt;-</span> <span class="fu">localG_perm</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.RookG, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb260-10"><a href="sect024.html#cb260-10" tabindex="-1"></a>localGetis.StarMC999 <span class="ot">&lt;-</span> <span class="fu">localG_perm</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.RookStar, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb260-11"><a href="sect024.html#cb260-11" tabindex="-1"></a><span class="do">## Sommaires statistiques</span></span>
<span id="cb260-12"><a href="sect024.html#cb260-12" tabindex="-1"></a><span class="fu">summary</span>(localGetis)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -3.80885 -1.70432 -0.09828 -0.04120  1.41123  3.91835</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="sect024.html#cb262-1" tabindex="-1"></a><span class="fu">summary</span>(localGetisStar)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -4.04870 -1.88689 -0.13297 -0.03841  1.54641  4.10379</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="sect024.html#cb264-1" tabindex="-1"></a><span class="fu">summary</span>(localGetis.MC999)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -3.80885 -1.70432 -0.09828 -0.04120  1.41123  3.91835</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="sect024.html#cb266-1" tabindex="-1"></a><span class="fu">summary</span>(localGetis.StarMC999)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -4.04870 -1.88689 -0.13297 -0.03841  1.54641  4.10379</code></pre>
<p>Cartographions ces valeurs et repérons les regroupements de valeurs significativement fortes et faibles avec les statistiques de Getis et Ord (figures <a href="sect024.html#fig:GetisLocaleClassique">2.26</a> et <a href="sect024.html#fig:GetisLocaleMC">2.27</a>). Les quatre cartes sont très semblables et permettent de repérer un regroupement de valeurs faibles dans le centre-ville et un autre de valeurs fortes dans l’est de la ville.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="sect024.html#cb268-1" tabindex="-1"></a><span class="do">## Enregistrons les résultats dans deux nouveaux champs de la couche des AD</span></span>
<span id="cb268-2"><a href="sect024.html#cb268-2" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis <span class="ot">&lt;-</span> localGetis</span>
<span id="cb268-3"><a href="sect024.html#cb268-3" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetisStar <span class="ot">&lt;-</span> localGetisStar</span>
<span id="cb268-4"><a href="sect024.html#cb268-4" tabindex="-1"></a><span class="co"># Définition des intervalles et des noms des classes</span></span>
<span id="cb268-5"><a href="sect024.html#cb268-5" tabindex="-1"></a>classes.intervalles <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="fl">3.29</span>, <span class="sc">-</span><span class="fl">2.58</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>, <span class="fl">2.58</span>, <span class="fl">3.29</span>, <span class="cn">Inf</span>)</span>
<span id="cb268-6"><a href="sect024.html#cb268-6" tabindex="-1"></a>classes.noms <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Point froid (p = 0,001)&quot;</span>, </span>
<span id="cb268-7"><a href="sect024.html#cb268-7" tabindex="-1"></a>                 <span class="st">&quot;Point froid (p = 0,01)&quot;</span>, </span>
<span id="cb268-8"><a href="sect024.html#cb268-8" tabindex="-1"></a>                 <span class="st">&quot;Point froid (p = 0,05)&quot;</span>, </span>
<span id="cb268-9"><a href="sect024.html#cb268-9" tabindex="-1"></a>                 <span class="st">&quot;Non significatif&quot;</span>,</span>
<span id="cb268-10"><a href="sect024.html#cb268-10" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,05)&quot;</span>, </span>
<span id="cb268-11"><a href="sect024.html#cb268-11" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,01)&quot;</span>, </span>
<span id="cb268-12"><a href="sect024.html#cb268-12" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,001)&quot;</span>)</span>
<span id="cb268-13"><a href="sect024.html#cb268-13" tabindex="-1"></a><span class="co"># Création d&#39;un champ avec les noms des classes</span></span>
<span id="cb268-14"><a href="sect024.html#cb268-14" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetisP <span class="ot">&lt;-</span> <span class="fu">cut</span>(AD.DR<span class="sc">$</span>RevMed_localGetis, </span>
<span id="cb268-15"><a href="sect024.html#cb268-15" tabindex="-1"></a>                                <span class="at">breaks =</span> classes.intervalles, </span>
<span id="cb268-16"><a href="sect024.html#cb268-16" tabindex="-1"></a>                                <span class="at">labels =</span> classes.noms)</span>
<span id="cb268-17"><a href="sect024.html#cb268-17" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetisStarP <span class="ot">&lt;-</span> <span class="fu">cut</span>(AD.DR<span class="sc">$</span>RevMed_localGetisStar, </span>
<span id="cb268-18"><a href="sect024.html#cb268-18" tabindex="-1"></a>                                  <span class="at">breaks =</span> classes.intervalles, </span>
<span id="cb268-19"><a href="sect024.html#cb268-19" tabindex="-1"></a>                                  <span class="at">labels =</span> classes.noms)</span>
<span id="cb268-20"><a href="sect024.html#cb268-20" tabindex="-1"></a><span class="do">## Cartographie pour le Z(Gi)</span></span>
<span id="cb268-21"><a href="sect024.html#cb268-21" tabindex="-1"></a>Carte1 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb268-22"><a href="sect024.html#cb268-22" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_localGetisP&quot;</span>, </span>
<span id="cb268-23"><a href="sect024.html#cb268-23" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">&quot;Z(Gi)&quot;</span>, <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb268-24"><a href="sect024.html#cb268-24" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span><span class="cn">FALSE</span>)</span>
<span id="cb268-25"><a href="sect024.html#cb268-25" tabindex="-1"></a><span class="do">## Cartographie pour le Z(Gi)*</span></span>
<span id="cb268-26"><a href="sect024.html#cb268-26" tabindex="-1"></a>Carte2 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb268-27"><a href="sect024.html#cb268-27" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_localGetisStarP&quot;</span>, </span>
<span id="cb268-28"><a href="sect024.html#cb268-28" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">&quot;Z(Gi*)&quot;</span>,  <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb268-29"><a href="sect024.html#cb268-29" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb268-30"><a href="sect024.html#cb268-30" tabindex="-1"></a>          <span class="fu">tm_credits</span>(<span class="st">&quot;Auteurs : Geoffroy et Jessie Chaux.&quot;</span>, </span>
<span id="cb268-31"><a href="sect024.html#cb268-31" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>), <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">align =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb268-32"><a href="sect024.html#cb268-32" tabindex="-1"></a><span class="do">## Composition avec les deux cartes</span></span>
<span id="cb268-33"><a href="sect024.html#cb268-33" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte1, Carte2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GetisLocaleClassique"></span>
<img src="GMQ405_files/figure-html/GetisLocaleClassique-1.png" alt="Points chauds et froids du revenu médian des ménages selon les statistiques de Getis et Ord (méthode classique)" width="85%" />
<p class="caption">
Figure 2.26: Points chauds et froids du revenu médian des ménages selon les statistiques de Getis et Ord (méthode classique)
</p>
</div>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="sect024.html#cb269-1" tabindex="-1"></a><span class="do">## Enregistrons les résultats dans deux champs de la couche des AD</span></span>
<span id="cb269-2"><a href="sect024.html#cb269-2" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis.MC999 <span class="ot">&lt;-</span> localGetis.MC999</span>
<span id="cb269-3"><a href="sect024.html#cb269-3" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis.StarMC999 <span class="ot">&lt;-</span> localGetis.StarMC999</span>
<span id="cb269-4"><a href="sect024.html#cb269-4" tabindex="-1"></a>coupures <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="fl">3.29</span>, <span class="sc">-</span><span class="fl">2.58</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>, <span class="fl">2.58</span>, <span class="fl">3.29</span>, <span class="cn">Inf</span>)</span>
<span id="cb269-5"><a href="sect024.html#cb269-5" tabindex="-1"></a><span class="co"># Définition des intervalles et des noms des classes</span></span>
<span id="cb269-6"><a href="sect024.html#cb269-6" tabindex="-1"></a>classes.intervalles <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="fl">3.29</span>, <span class="sc">-</span><span class="fl">2.58</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>, <span class="fl">2.58</span>, <span class="fl">3.29</span>, <span class="cn">Inf</span>)</span>
<span id="cb269-7"><a href="sect024.html#cb269-7" tabindex="-1"></a>classes.noms <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Point froid (p = 0,05)&quot;</span>, </span>
<span id="cb269-8"><a href="sect024.html#cb269-8" tabindex="-1"></a>                 <span class="st">&quot;Point froid (p = 0,01)&quot;</span>, </span>
<span id="cb269-9"><a href="sect024.html#cb269-9" tabindex="-1"></a>                 <span class="st">&quot;Point froid (p = 0,001)&quot;</span>, </span>
<span id="cb269-10"><a href="sect024.html#cb269-10" tabindex="-1"></a>                 <span class="st">&quot;Non significatif&quot;</span>,</span>
<span id="cb269-11"><a href="sect024.html#cb269-11" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,05)&quot;</span>, </span>
<span id="cb269-12"><a href="sect024.html#cb269-12" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,01)&quot;</span>, </span>
<span id="cb269-13"><a href="sect024.html#cb269-13" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,001)&quot;</span>)</span>
<span id="cb269-14"><a href="sect024.html#cb269-14" tabindex="-1"></a><span class="co"># Création d&#39;un champ avec les noms des classes</span></span>
<span id="cb269-15"><a href="sect024.html#cb269-15" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis.MC999P <span class="ot">&lt;-</span> <span class="fu">cut</span>(AD.DR<span class="sc">$</span>RevMed_localGetis.MC999, </span>
<span id="cb269-16"><a href="sect024.html#cb269-16" tabindex="-1"></a>                                <span class="at">breaks =</span> classes.intervalles, </span>
<span id="cb269-17"><a href="sect024.html#cb269-17" tabindex="-1"></a>                                <span class="at">labels =</span> classes.noms)</span>
<span id="cb269-18"><a href="sect024.html#cb269-18" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis.StarMC999P <span class="ot">&lt;-</span> <span class="fu">cut</span>(AD.DR<span class="sc">$</span>RevMed_localGetis.StarMC999, </span>
<span id="cb269-19"><a href="sect024.html#cb269-19" tabindex="-1"></a>                                  <span class="at">breaks =</span> classes.intervalles, </span>
<span id="cb269-20"><a href="sect024.html#cb269-20" tabindex="-1"></a>                                  <span class="at">labels =</span> classes.noms)</span>
<span id="cb269-21"><a href="sect024.html#cb269-21" tabindex="-1"></a><span class="do">## Cartographie pour le Z(Gi) Mont-Carlo</span></span>
<span id="cb269-22"><a href="sect024.html#cb269-22" tabindex="-1"></a>Carte3 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb269-23"><a href="sect024.html#cb269-23" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_localGetis.MC999&quot;</span>, </span>
<span id="cb269-24"><a href="sect024.html#cb269-24" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">&quot;Z(Gi)&quot;</span>, <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb269-25"><a href="sect024.html#cb269-25" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span><span class="cn">FALSE</span>)</span>
<span id="cb269-26"><a href="sect024.html#cb269-26" tabindex="-1"></a><span class="do">## Cartographie pour le Z(Gi)* Mont-Carlo</span></span>
<span id="cb269-27"><a href="sect024.html#cb269-27" tabindex="-1"></a>Carte4 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb269-28"><a href="sect024.html#cb269-28" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_localGetis.StarMC999&quot;</span>,</span>
<span id="cb269-29"><a href="sect024.html#cb269-29" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">&quot;Z(Gi*)&quot;</span>, <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb269-30"><a href="sect024.html#cb269-30" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb269-31"><a href="sect024.html#cb269-31" tabindex="-1"></a>          <span class="fu">tm_credits</span>(<span class="st">&quot;Auteurs : Geoffroy et Jessie Chaux.&quot;</span>, </span>
<span id="cb269-32"><a href="sect024.html#cb269-32" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>), <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">align =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb269-33"><a href="sect024.html#cb269-33" tabindex="-1"></a><span class="do">## Composition avec les deux cartes</span></span>
<span id="cb269-34"><a href="sect024.html#cb269-34" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte3, Carte4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GetisLocaleMC"></span>
<img src="GMQ405_files/figure-html/GetisLocaleMC-1.png" alt="Points chauds et froids du revenu médian des ménages selon les statistiques de Getis et Ord (999 permutations Monte-Carlo)" width="85%" />
<p class="caption">
Figure 2.27: Points chauds et froids du revenu médian des ménages selon les statistiques de Getis et Ord (999 permutations Monte-Carlo)
</p>
</div>
</div>
</div>
<div id="sect0242" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Version locale du <em>I</em> de Moran<a href="sect024.html#sect0242" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect02421" class="section level4 hasAnchor" number="2.4.2.1">
<h4><span class="header-section-number">2.4.2.1</span> Formulation de la version locale du <em>I</em> de Moran<a href="sect024.html#sect02421" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Une version locale du <em>I</em> de Moran (<span class="math inline">\(I_i\)</span>) a été proposée par Luc Anselin <span class="citation">(<a href="#ref-anselin1995local">1995</a>)</span>. Elle permet de vérifier si une entité spatiale est voisine ou proche – dépendamment de la matrice spatiale utilisée – d’entités spatiales avec des valeurs semblables (contexte d’autocorrélation spatiale locale positive) ou dissemblables (contexte d’autocorrélation spatiale locale négative). Le <em>I</em> de Moran local s’écrit :</p>
<p><span class="math display" id="eq:LocalIMoran">\[\begin{equation}  
I_i = \frac{(x_i-\bar{X})\Sigma_{j=1}^n w_{ij}(x_j-\bar{X})}
{\frac{1}{n} \Sigma_{i=1}^n(x_i-\bar{X})^2} =  \frac{z_i \Sigma_{j=1}^n z_j}{\frac{1}{n}\Sigma_{i=1}^n z_i^2} \text{, } i \ne j
\tag{2.22}
\end{equation}\]</span>
</p>
<p>avec :</p>
<ul>
<li><span class="math inline">\(z_i\)</span> étant la valeur de la variable continue centrée <span class="math inline">\(X\)</span> pour l’entité spatiale <span class="math inline">\(i\)</span>, c’est-à-dire simplement l’écart de <span class="math inline">\(i\)</span> à la moyenne de <span class="math inline">\(X\)</span> (<span class="math inline">\(x_i - \bar X\)</span>).</li>
<li><span class="math inline">\(z_j\)</span> étant la valeur de la variable centrée de <span class="math inline">\(X\)</span> pour l’entité spatiale <span class="math inline">\(j\)</span>.</li>
<li><span class="math inline">\(w_{ij}\)</span> étant la valeur de la matrice de pondération spatiale standardisée en ligne entre <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>.</li>
<li><span class="math inline">\(n\)</span> étant le nombre d’entités spatiales dans la couche géographique.</li>
</ul>
<p>Comme pour la version globale, il est possible de tester la significativité du <em>I</em> de Moran local de manière classique (selon la loi normale) ou avec l’approche Monte-Carlo (avec habituellement 999 permutations).</p>
<div class="bloc_aller_loin">
<p><strong>Test de significativité du <em>I</em> de Moran local</strong>.</p>
<p>Pour comprendre les différentes variantes pour tester la significativité <span class="citation">(<a href="#ref-anselin1995local">Anselin 1995</a>; <a href="#ref-sokal1998local">Sokal, Oden et Thomson 1998</a>)</span>, consultez Bivand et Wong <span class="citation">(<a href="#ref-bivand2018comparing">2018</a>)</span> ou l’ouvrage de Dubé et Legros <span class="citation">(<a href="#ref-dube2014econometrie">2014</a>)</span>.</p>
</div>
</div>
<div id="sect02422" class="section level4 hasAnchor" number="2.4.2.2">
<h4><span class="header-section-number">2.4.2.2</span> Mise en œuvre dans R<a href="sect024.html#sect02422" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le calcul du <em>I</em> de Moran local s’opère avec les fonctions <code>localmoran</code> et <code>localMoranI.mc</code> du <em>package</em> <code>spdep</code> (voir la syntaxe ci-dessous). Comme pour la version globale, les résultats du <em>I</em> de Moran local sont les mêmes pour les deux fonctions, seules les valeurs de <em>p</em> peuvent varier.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="sect024.html#cb270-1" tabindex="-1"></a><span class="do">## Calcul du I de Moran local</span></span>
<span id="cb270-2"><a href="sect024.html#cb270-2" tabindex="-1"></a>localMoranI <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(AD.DR<span class="sc">$</span>RevMedMenage,  <span class="co"># variable</span></span>
<span id="cb270-3"><a href="sect024.html#cb270-3" tabindex="-1"></a>                          W.RookG)             <span class="co"># matrice de pondération spatiale</span></span>
<span id="cb270-4"><a href="sect024.html#cb270-4" tabindex="-1"></a><span class="do">## Calcul du I de Moran local avec la méthode Monte-Carlo</span></span>
<span id="cb270-5"><a href="sect024.html#cb270-5" tabindex="-1"></a>localMoranI.mc <span class="ot">&lt;-</span> <span class="fu">localmoran_perm</span>(AD.DR<span class="sc">$</span>RevMedMenage, <span class="co"># variable</span></span>
<span id="cb270-6"><a href="sect024.html#cb270-6" tabindex="-1"></a>                             W.RookG,                 <span class="co"># matrice de pondération spatiale</span></span>
<span id="cb270-7"><a href="sect024.html#cb270-7" tabindex="-1"></a>                             <span class="at">nsim =</span> <span class="dv">999</span>)              <span class="co"># nombre de permutations       </span></span>
<span id="cb270-8"><a href="sect024.html#cb270-8" tabindex="-1"></a><span class="do">## Sommaires statistiques</span></span>
<span id="cb270-9"><a href="sect024.html#cb270-9" tabindex="-1"></a><span class="fu">summary</span>(localMoranI)</span></code></pre></div>
<pre><code>##        Ii                E.Ii                Var.Ii               Z.Ii        
##  Min.   :-0.90053   Min.   :-3.054e-02   Min.   :0.0000003   Min.   :-1.9962  
##  1st Qu.: 0.08313   1st Qu.:-5.368e-03   1st Qu.:0.0370546   1st Qu.: 0.4539  
##  Median : 0.49029   Median :-2.755e-03   Median :0.1339044   Median : 1.4404  
##  Mean   : 0.61678   Mean   :-4.032e-03   Mean   :0.2149974   Mean   : 1.2503  
##  3rd Qu.: 0.97602   3rd Qu.:-8.287e-04   3rd Qu.:0.2510284   3rd Qu.: 2.1938  
##  Max.   : 3.37625   Max.   :-8.000e-09   Max.   :1.8207164   Max.   : 3.9184  
##  Pr(z != E(Ii))     
##  Min.   :0.0000892  
##  1st Qu.:0.0282519  
##  Median :0.1268505  
##  Mean   :0.2467939  
##  3rd Qu.:0.3948293  
##  Max.   :0.9833048</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="sect024.html#cb272-1" tabindex="-1"></a><span class="fu">summary</span>(localMoranI.mc)</span></code></pre></div>
<pre><code>##        Ii                E.Ii               Var.Ii               Z.Ii        
##  Min.   :-0.90053   Min.   :-0.058188   Min.   :0.0000003   Min.   :-2.0332  
##  1st Qu.: 0.08313   1st Qu.:-0.010128   1st Qu.:0.0375368   1st Qu.: 0.4642  
##  Median : 0.49029   Median :-0.001649   Median :0.1398072   Median : 1.4106  
##  Mean   : 0.61678   Mean   :-0.003791   Mean   :0.2188416   Mean   : 1.2348  
##  3rd Qu.: 0.97602   3rd Qu.: 0.003411   3rd Qu.:0.2629827   3rd Qu.: 2.1764  
##  Max.   : 3.37625   Max.   : 0.045807   Max.   :1.8108976   Max.   : 3.9578  
##  Pr(z != E(Ii))      Pr(z != E(Ii)) Sim Pr(folded) Sim     Skewness       
##  Min.   :0.0000757   Min.   :0.0020     Min.   :0.001   Min.   :-0.41706  
##  1st Qu.:0.0295274   1st Qu.:0.0260     1st Qu.:0.013   1st Qu.:-0.22856  
##  Median :0.1307912   Median :0.1260     Median :0.063   Median :-0.09602  
##  Mean   :0.2485652   Mean   :0.2519     Mean   :0.126   Mean   :-0.01144  
##  3rd Qu.:0.3899629   3rd Qu.:0.3960     3rd Qu.:0.198   3rd Qu.: 0.21232  
##  Max.   :0.9994472   Max.   :0.9920     Max.   :0.496   Max.   : 0.45522  
##     Kurtosis      
##  Min.   :-0.5256  
##  1st Qu.:-0.2482  
##  Median :-0.1564  
##  Mean   :-0.1545  
##  3rd Qu.:-0.0797  
##  Max.   : 0.2533</code></pre>
<p>Avec la cartographie du <em>I</em> de Moran local, nous repérons localement l’autocorrélation spatiale positive (valeurs similaires, fortes ou faibles localement) et l’autocorrélation spatiale négative (valeurs dissemblables localement) (figure <a href="sect024.html#fig:Chap02CartoIMoranLocal">2.28</a>).</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="sect024.html#cb274-1" tabindex="-1"></a><span class="do">## Ajout de champs pour le I de Moran local</span></span>
<span id="cb274-2"><a href="sect024.html#cb274-2" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_IlocalMoran.MC999 <span class="ot">&lt;-</span> localMoranI.mc[, <span class="dv">1</span>]</span>
<span id="cb274-3"><a href="sect024.html#cb274-3" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_IlocalMoran.MC999p <span class="ot">&lt;-</span> localMoranI.mc[, <span class="dv">5</span>]</span>
<span id="cb274-4"><a href="sect024.html#cb274-4" tabindex="-1"></a><span class="do">## Cartographie</span></span>
<span id="cb274-5"><a href="sect024.html#cb274-5" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb274-6"><a href="sect024.html#cb274-6" tabindex="-1"></a>Carte1 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb274-7"><a href="sect024.html#cb274-7" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_IlocalMoran.MC999&quot;</span>, <span class="at">title=</span><span class="st">&quot;I Moran local&quot;</span>, </span>
<span id="cb274-8"><a href="sect024.html#cb274-8" tabindex="-1"></a>                        <span class="at">style=</span><span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb274-9"><a href="sect024.html#cb274-9" tabindex="-1"></a>         <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb274-10"><a href="sect024.html#cb274-10" tabindex="-1"></a></span>
<span id="cb274-11"><a href="sect024.html#cb274-11" tabindex="-1"></a>Carte2 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb274-12"><a href="sect024.html#cb274-12" tabindex="-1"></a>              <span class="fu">tm_polygons</span>(<span class="at">col=</span> <span class="st">&quot;RevMed_IlocalMoran.MC999p&quot;</span>, <span class="at">title=</span><span class="st">&quot;valeur de p&quot;</span>,</span>
<span id="cb274-13"><a href="sect024.html#cb274-13" tabindex="-1"></a>                    <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;gray&quot;</span>),  <span class="at">lwd =</span> <span class="dv">1</span>, </span>
<span id="cb274-14"><a href="sect024.html#cb274-14" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="cn">Inf</span>),</span>
<span id="cb274-15"><a href="sect024.html#cb274-15" tabindex="-1"></a>                    <span class="at">title =</span><span class="st">&quot;En %&quot;</span>)<span class="sc">+</span></span>
<span id="cb274-16"><a href="sect024.html#cb274-16" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb274-17"><a href="sect024.html#cb274-17" tabindex="-1"></a><span class="do">## Combinaison des deux cartes</span></span>
<span id="cb274-18"><a href="sect024.html#cb274-18" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte1, Carte2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Chap02CartoIMoranLocal"></span>
<img src="GMQ405_files/figure-html/Chap02CartoIMoranLocal-1.png" alt="Cartographie du *I* de Moran local et de la valeur de p associée" width="85%" />
<p class="caption">
Figure 2.28: Cartographie du <em>I</em> de Moran local et de la valeur de p associée
</p>
</div>
</div>
</div>
<div id="sect0243" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Typologie basée sur le diagramme de Moran<a href="sect024.html#sect0243" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect02431" class="section level4 hasAnchor" number="2.4.3.1">
<h4><span class="header-section-number">2.4.3.1</span> Formulation de la typologie basée sur le diagramme de Moran dans un contexte univarié<a href="sect024.html#sect02431" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La typologie basée sur le diagramme de Moran a été proposée par Luc Anselin <span class="citation">(<a href="#ref-anselin1996chapter">1996</a>)</span>. L’idée est fort simple, mais extrêmement efficace! Avant tout, la variable continue est centrée réduite (cote <span class="math inline">\(z\)</span>, <em>z-score</em> en anglais). Pour un rappel sur la cote <span class="math inline">\(z\)</span>, consultez la <a href="https://laeq.github.io/LivreMethoQuantBolR/sect025.html#sect02552">section suivante</a> <span class="citation">(<a href="#ref-RBoldAir">Apparicio et Gelb 2022</a>)</span>. La moyenne est ainsi égale à 0 et l’écart-type à 1. Puis, il s’agit de construire un nuage de points entre :</p>
<ol style="list-style-type: decimal">
<li>Les valeurs de la variable centrée réduite (Z) <strong>sur l’axe des X</strong> pour les entités spatiales de la couche géographique.</li>
<li>Les valeurs de la variable centrée réduite spatialement décalée obtenues avec les pondération spatiale de la matrice <span class="math inline">\(W\)</span> (voir l’encadré ci-dessous).</li>
</ol>
<div class="bloc_notes">
<p><strong>Comment calculer une variable spatialement décalée avec une matrice de pondération spatiale?</strong></p>
<p>À la figure <a href="sect024.html#fig:Chap02FigureVariableSpatialementDecalee">2.29</a>, nous détaillons le calcul de la valeur d’une variable spatialement décalée pour l’entité spatiale <strong>A</strong> à partir d’une matrice de contiguïté (selon le partage d’un segment) standardisée en ligne. Notez que <strong>A</strong> a quatre voisins (b, c, d et e).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Chap02FigureVariableSpatialementDecalee"></span>
<img src="images/Chap02/FigureVariableSpatialementDecalee.png" alt="Illustration du calcul d'une variable spatialement décalée" width="65%" />
<p class="caption">
Figure 2.29: Illustration du calcul d’une variable spatialement décalée
</p>
</div>
<p>Dans R, la syntaxe est fort simple pour créer une cote <span class="math inline">\(z\)</span> et une variable spatiale décalée :</p>
<p><code>zx &lt;- (x - mean(x))/sd(x)     # variable X centrée réduite (cote z)</code></p>
<p><code>wzx &lt;- lag.listw(listW,zx)    # variable X centrée réduite spatialement décalée</code></p>
</div>
<p>Analysons les différents éléments du diagramme de Moran à la figure <a href="sect024.html#fig:NuagePointsMoran">2.30</a> :</p>
<ul>
<li>La droite régression résume la relation linéaire entre la variable spatialement décalée (<span class="math inline">\(W.ZX\)</span>) et l’originale (<span class="math inline">\(ZX\)</span>). D’ailleurs, le coefficient de régression pour la variable <span class="math inline">\(ZX\)</span>, soit la pente de la droite, équivaut au <em>I</em> de Moran!</li>
<li>Les traits pointillés représentent les moyennes des deux variables, toutes deux égales à 0 puisqu’elles sont centrées-réduites (cote <span class="math inline">\(z\)</span>).</li>
</ul>
<p>Pour analyser ce nuage, nous le décomposons en quatre quadrants :</p>
<ol style="list-style-type: decimal">
<li><p>Le quadrant <strong>HH (<em>High-High</em>)</strong> en haut à droite regroupe des entités spatiales avec des valeurs <strong>fortes</strong> (H) qui sont voisines ou proches d’autres entités spatiales avec aussi des valeurs <strong>fortes</strong> (H). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale positive avec des valeurs fortes (HH)</strong>.</p></li>
<li><p>Le quadrant <strong>LL (<em>Low-Low</em>)</strong> en bas à gauche regroupe des entités spatiales avec des valeurs <strong>faibles</strong> (L) qui sont voisines ou proches d’autres entités spatiales avec aussi des valeurs <strong>faibles</strong> (L). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale positive avec des valeurs faibles (LL)</strong>.</p></li>
<li><p>Le quadrant <strong>HL (<em>High-Low</em>)</strong> en bas à droite regroupe des entités spatiales avec des valeurs <strong>fortes</strong> (H) qui sont voisines ou proches d’autres entités spatiales avec des valeurs <strong>faibles</strong> (L). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale négative (HL)</strong>. Avec humour, un collègue économiste qualifie ce quadrant de <strong>village gaulois</strong> (Obélix, Astérix et leurs compagnons sont très forts et ils sont entourés de voisins romains plus faibles…).</p></li>
<li><p>Le quadrant <strong>LH (<em>Low-High</em>)</strong> en haut à gauche regroupe des entités spatiales avec des valeurs <strong>faibles</strong> (L) qui sont voisines ou proches d’autres entités spatiales avec des valeurs <strong>fortes</strong> (H). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale négative (LH)</strong>.</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:NuagePointsMoran"></span>
<img src="GMQ405_files/figure-html/NuagePointsMoran-1.png" alt="Diagramme de Moran" width="85%" />
<p class="caption">
Figure 2.30: Diagramme de Moran
</p>
</div>
</div>
<div id="sect02432" class="section level4 hasAnchor" number="2.4.3.2">
<h4><span class="header-section-number">2.4.3.2</span> Mise en œuvre dans R<a href="sect024.html#sect02432" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour créer le diagramme de Moran, nous avons écrit la fonction <code>DiagMoranUnivarie</code>.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="sect024.html#cb275-1" tabindex="-1"></a><span class="do">## Réalisation du diagramme de Moran avec la fonction DiagMoranUnivarie</span></span>
<span id="cb275-2"><a href="sect024.html#cb275-2" tabindex="-1"></a><span class="fu">DiagMoranUnivarie</span>(</span>
<span id="cb275-3"><a href="sect024.html#cb275-3" tabindex="-1"></a>  <span class="at">x =</span> AD.DR<span class="sc">$</span>RevMedMenage,</span>
<span id="cb275-4"><a href="sect024.html#cb275-4" tabindex="-1"></a>  <span class="at">listW =</span> W.Rook,</span>
<span id="cb275-5"><a href="sect024.html#cb275-5" tabindex="-1"></a>  <span class="at">titre =</span> <span class="st">&quot;Diagramme de Moran (matrice de contiguïté selon le partage d&#39;un segment)&quot;</span>,</span>
<span id="cb275-6"><a href="sect024.html#cb275-6" tabindex="-1"></a>  <span class="at">titreAxeX =</span> <span class="st">&quot;ZX : Revenu médian des ménages centré réduit&quot;</span>,</span>
<span id="cb275-7"><a href="sect024.html#cb275-7" tabindex="-1"></a>  <span class="at">titreAxeY =</span> <span class="st">&quot;WZ : Variable ZX spatialement décalée&quot;</span>,</span>
<span id="cb275-8"><a href="sect024.html#cb275-8" tabindex="-1"></a>  <span class="at">AfficheAide=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Reste à déterminer si l’autocorrélation spatiale locale pour ces quatre quadrants est significative. Rien de plus simple, il suffit d’utiliser la valeur de <em>p</em> du <em>I</em> de Moran local (section <a href="sect024.html#sect0242">2.4.2</a>). Nous choisissons un seuil de signification (habituellement <em>p</em> = 0,05) et obtenons ainsi la typologie comprenant cinq catégories :</p>
<ul>
<li>Autocorrélation spatiale locale positive et significative (<em>p</em> &lt; 0,05).
<ol style="list-style-type: decimal">
<li>HH</li>
<li>LL</li>
</ol></li>
<li>Autocorrélation spatiale locale négative et significative (<em>p</em> &lt; 0,05).
<ol start="3" style="list-style-type: decimal">
<li>HL</li>
<li>LH</li>
</ol></li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Autocorrélation spatiale locale non significative (<em>p</em> &gt; 0,05).</li>
</ol>
<p>Le code R ci-dessous permet d’obtenir la typologie de l’autocorrélation spatiale avec le <em>I</em> de Moran local pour le revenu médian des ménages avec une matrice de contiguïté selon le partage d’un segment (<em>Rook</em>). La figure <a href="sect024.html#fig:TypoIMoran">2.31</a> dénote surtout une autocorrélation spatiale positive importante (respectivement 25 et 47 aires de diffusion classées <em>HH</em> et <em>LL</em>), comparativement à l’autocorrélation spatiale négative qui ne comprend qu’une aire de diffusion (LH).</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="sect024.html#cb276-1" tabindex="-1"></a><span class="do">## Cote Z (variable centrée réduite)</span></span>
<span id="cb276-2"><a href="sect024.html#cb276-2" tabindex="-1"></a>zx <span class="ot">&lt;-</span> (AD.DR<span class="sc">$</span>RevMedMenage <span class="sc">-</span> <span class="fu">mean</span>(AD.DR<span class="sc">$</span>RevMedMenage))<span class="sc">/</span><span class="fu">sd</span>(AD.DR<span class="sc">$</span>RevMedMenage)</span>
<span id="cb276-3"><a href="sect024.html#cb276-3" tabindex="-1"></a><span class="do">## variable X centrée réduite spatialement décalée avec une matrice Rook</span></span>
<span id="cb276-4"><a href="sect024.html#cb276-4" tabindex="-1"></a>wzx <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(W.Rook, zx)    </span>
<span id="cb276-5"><a href="sect024.html#cb276-5" tabindex="-1"></a><span class="do">## I de Moran local (notez que vous pouvez aussi utiliser la fonction localmoran_perm)</span></span>
<span id="cb276-6"><a href="sect024.html#cb276-6" tabindex="-1"></a>localMoranI   <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.Rook)</span>
<span id="cb276-7"><a href="sect024.html#cb276-7" tabindex="-1"></a><span class="co">#localMoranI.mc   &lt;- localmoran_perm(AD.DR$RevMedMenage, W.Rook, n=999)</span></span>
<span id="cb276-8"><a href="sect024.html#cb276-8" tabindex="-1"></a>plocalMoranI  <span class="ot">&lt;-</span> localMoranI[, <span class="dv">5</span>]</span>
<span id="cb276-9"><a href="sect024.html#cb276-9" tabindex="-1"></a><span class="do">## Choix d&#39;un seuil de signification</span></span>
<span id="cb276-10"><a href="sect024.html#cb276-10" tabindex="-1"></a>signif <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb276-11"><a href="sect024.html#cb276-11" tabindex="-1"></a><span class="do">## Construction de la typologie</span></span>
<span id="cb276-12"><a href="sect024.html#cb276-12" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wzx <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;1. HH&quot;</span>, <span class="cn">NA</span>)</span>
<span id="cb276-13"><a href="sect024.html#cb276-13" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wzx <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;2. LL&quot;</span>, Typologie)</span>
<span id="cb276-14"><a href="sect024.html#cb276-14" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wzx <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;3. HL&quot;</span>, Typologie)</span>
<span id="cb276-15"><a href="sect024.html#cb276-15" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wzx <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;4. LH&quot;</span>, Typologie)</span>
<span id="cb276-16"><a href="sect024.html#cb276-16" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(plocalMoranI <span class="sc">&gt;</span> signif, <span class="st">&quot;Non sign&quot;</span>, Typologie)  <span class="co"># Non significatif</span></span>
<span id="cb276-17"><a href="sect024.html#cb276-17" tabindex="-1"></a><span class="do">## Enregistrement de la typologie dans un champ</span></span>
<span id="cb276-18"><a href="sect024.html#cb276-18" tabindex="-1"></a>AD.DR<span class="sc">$</span>TypoIMoran.RevMedian <span class="ot">&lt;-</span> Typologie</span>
<span id="cb276-19"><a href="sect024.html#cb276-19" tabindex="-1"></a><span class="fu">table</span>(AD.DR<span class="sc">$</span>TypoIMoran.RevMedian, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>## 
##    1. HH    2. LL    4. LH Non sign     &lt;NA&gt; 
##       33       48        1      167        0</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="sect024.html#cb278-1" tabindex="-1"></a><span class="do">## Couleurs</span></span>
<span id="cb278-2"><a href="sect024.html#cb278-2" tabindex="-1"></a>Couleurs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#FF0000&quot;</span>, <span class="st">&quot;#0000FF&quot;</span>, <span class="st">&quot;#f4ada8&quot;</span>, <span class="st">&quot;#a7adf9&quot;</span>, <span class="st">&quot;#eeeeee&quot;</span>)</span>
<span id="cb278-3"><a href="sect024.html#cb278-3" tabindex="-1"></a><span class="fu">names</span>(Couleurs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1. HH&quot;</span>,<span class="st">&quot;2. LL&quot;</span>,<span class="st">&quot;3. HL&quot;</span>,<span class="st">&quot;4. LH&quot;</span>,<span class="st">&quot;Non sign&quot;</span>)</span>
<span id="cb278-4"><a href="sect024.html#cb278-4" tabindex="-1"></a><span class="do">## Cartographie</span></span>
<span id="cb278-5"><a href="sect024.html#cb278-5" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb278-6"><a href="sect024.html#cb278-6" tabindex="-1"></a><span class="fu">tm_shape</span>(AD.DR) <span class="sc">+</span> </span>
<span id="cb278-7"><a href="sect024.html#cb278-7" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;TypoIMoran.RevMedian&quot;</span>, </span>
<span id="cb278-8"><a href="sect024.html#cb278-8" tabindex="-1"></a>              <span class="at">palette =</span> Couleurs, </span>
<span id="cb278-9"><a href="sect024.html#cb278-9" tabindex="-1"></a>              <span class="at">title =</span><span class="st">&quot;Autocorrélation spatiale locale&quot;</span>)<span class="sc">+</span></span>
<span id="cb278-10"><a href="sect024.html#cb278-10" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:TypoIMoran"></span>
<img src="GMQ405_files/figure-html/TypoIMoran-1.png" alt="Typologie de l'autocorrélation spatiale locale avec le *I* de Moran local" width="85%" />
<p class="caption">
Figure 2.31: Typologie de l’autocorrélation spatiale locale avec le <em>I</em> de Moran local
</p>
</div>
<div class="bloc_attention">
<p><strong>Ne pas confondre les statistiques locales de Getis et Ord et la typologie avec le <em>I</em> de Moran local</strong>.</p>
<p>Succinctement, ces deux familles de mesures renvoient deux typologies différentes :</p>
<ul>
<li>Le <em>I</em> de Moran local comprend cinq classes : HH, LL, HL, LH et non significatif.</li>
<li>Les statistiques locales de Getis et Ord comprennent trois classes : points chauds (sensiblement l’équivalent de HH), points froids (sensiblement l’équivalent de LL) et non significatifs.</li>
</ul>
</div>
</div>
</div>
<div id="sect0244" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Version locale des statistiques de comptage de jointure (<em>Join Count Statistics</em>)<a href="sect024.html#sect0244" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Une version locale des statistiques de comptage de jointure a été proposée par Luc Anselin et Xun Li <span class="citation">(<a href="#ref-anselin2019operational">2019</a>)</span>. Au même titre que la version locale du <em>I</em> de Moran, elle consiste à désagréger localement le calcul de l’indicateur global. Pour chaque observation, nous comptons ainsi le nombre de paires 0-0 (WW) ou 1-1 (BB) pour une variable binaire.</p>
<p>Pour déterminer si les associations 0-0 et 1-1 sont plus fréquentes que celles attendues du hasard, il est recommandé d’utiliser un test d’inférence par permutations. Ce test n’est actuellement pas implémenté dans <code>spdep</code>, mais il est disponible dans le <em>package</em> <code>rgeoda</code> avec la fonction <code>local_joincount</code>. Nous reprenons ici l’exemple des deux variables identifiant une majorité de locataires (<code>loc_maj</code>) ou de propriétaires (<code>proprio_maj</code>) pour les aires de diffusion de la ville de Sherbrooke.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="sect024.html#cb279-1" tabindex="-1"></a><span class="fu">library</span>(rgeoda)</span>
<span id="cb279-2"><a href="sect024.html#cb279-2" tabindex="-1"></a><span class="do">## Définition de la matrice de contiguïté avec rgeoda</span></span>
<span id="cb279-3"><a href="sect024.html#cb279-3" tabindex="-1"></a>wmat <span class="ot">&lt;-</span> <span class="fu">queen_weights</span>(ADSherb)</span>
<span id="cb279-4"><a href="sect024.html#cb279-4" tabindex="-1"></a><span class="do">## Création de deux variables binaires avec des valeurs de 0 et 1</span></span>
<span id="cb279-5"><a href="sect024.html#cb279-5" tabindex="-1"></a><span class="do">## pour les locataires et propriétaires</span></span>
<span id="cb279-6"><a href="sect024.html#cb279-6" tabindex="-1"></a>ADSherb<span class="sc">$</span>loc_maj <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ADSherb<span class="sc">$</span>Locataire <span class="sc">&gt;</span> ADSherb<span class="sc">$</span>Proprietaire, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb279-7"><a href="sect024.html#cb279-7" tabindex="-1"></a>ADSherb<span class="sc">$</span>proprio_maj <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ADSherb<span class="sc">$</span>Proprietaire <span class="sc">&gt;</span> ADSherb<span class="sc">$</span>Locataire, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb279-8"><a href="sect024.html#cb279-8" tabindex="-1"></a><span class="do">## Calcul de la version locale du join count test</span></span>
<span id="cb279-9"><a href="sect024.html#cb279-9" tabindex="-1"></a>testLoc <span class="ot">&lt;-</span> <span class="fu">local_joincount</span>(wmat, ADSherb[<span class="st">&quot;loc_maj&quot;</span>], <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb279-10"><a href="sect024.html#cb279-10" tabindex="-1"></a>testPro <span class="ot">&lt;-</span> <span class="fu">local_joincount</span>(wmat, ADSherb[<span class="st">&quot;proprio_maj&quot;</span>], <span class="at">permutations =</span> <span class="dv">999</span>)</span></code></pre></div>
<p>Avec le code ci-dessous, nous cartographions les AD en fonction des seuils de significativité de la version locale du test.
Sans surprise, les AD avec une autocorrélation spatiale significative sont les suivantes :</p>
<ul>
<li>celles au centre de la ville de Sherbrooke avec une majorité de locataires (figure <a href="sect024.html#fig:LocalJointCountStatCarto">2.32</a>.a);</li>
<li>celles de l’ouest de la ville avec une majorité de propriétaires (figure <a href="sect024.html#fig:LocalJointCountStatCarto">2.32</a>.b).</li>
</ul>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="sect024.html#cb280-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb280-2"><a href="sect024.html#cb280-2" tabindex="-1"></a><span class="do">## Sauvegarde des résultats</span></span>
<span id="cb280-3"><a href="sect024.html#cb280-3" tabindex="-1"></a>ADSherb<span class="sc">$</span>testLoc_pvals <span class="ot">&lt;-</span> testLoc<span class="sc">$</span>p_vals</span>
<span id="cb280-4"><a href="sect024.html#cb280-4" tabindex="-1"></a>ADSherb<span class="sc">$</span>testPro_pvals <span class="ot">&lt;-</span> testPro<span class="sc">$</span>p_vals</span>
<span id="cb280-5"><a href="sect024.html#cb280-5" tabindex="-1"></a><span class="do">## Calcul d&#39;une variable avec les seuils de significativité pour les locataires</span></span>
<span id="cb280-6"><a href="sect024.html#cb280-6" tabindex="-1"></a>ADSherb<span class="sc">$</span>clusterLoc <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb280-7"><a href="sect024.html#cb280-7" tabindex="-1"></a>  ADSherb<span class="sc">$</span>testLoc_pvals <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> ADSherb<span class="sc">$</span>testLoc_pvals <span class="sc">&gt;=</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb280-8"><a href="sect024.html#cb280-8" tabindex="-1"></a>  ADSherb<span class="sc">$</span>testLoc_pvals <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb280-9"><a href="sect024.html#cb280-9" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb280-10"><a href="sect024.html#cb280-10" tabindex="-1"></a>)</span>
<span id="cb280-11"><a href="sect024.html#cb280-11" tabindex="-1"></a>ADSherb<span class="sc">$</span>clusterLoc <span class="ot">&lt;-</span> <span class="fu">factor</span>(ADSherb<span class="sc">$</span>clusterLoc, </span>
<span id="cb280-12"><a href="sect024.html#cb280-12" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb280-13"><a href="sect024.html#cb280-13" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Non significatif (p &gt; 0,05)&quot;</span>, </span>
<span id="cb280-14"><a href="sect024.html#cb280-14" tabindex="-1"></a>                                     <span class="st">&quot;p = 0,05&quot;</span>,<span class="st">&quot;p = 0,01&quot;</span>))</span>
<span id="cb280-15"><a href="sect024.html#cb280-15" tabindex="-1"></a><span class="do">## Calcul d&#39;une variable avec les seuils de significativité pour les propriétaires</span></span>
<span id="cb280-16"><a href="sect024.html#cb280-16" tabindex="-1"></a>ADSherb<span class="sc">$</span>clusterPro <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb280-17"><a href="sect024.html#cb280-17" tabindex="-1"></a>  ADSherb<span class="sc">$</span>testPro_pvals <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> ADSherb<span class="sc">$</span>testPro_pvals <span class="sc">&gt;=</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb280-18"><a href="sect024.html#cb280-18" tabindex="-1"></a>  ADSherb<span class="sc">$</span>testPro_pvals <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb280-19"><a href="sect024.html#cb280-19" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb280-20"><a href="sect024.html#cb280-20" tabindex="-1"></a>)</span>
<span id="cb280-21"><a href="sect024.html#cb280-21" tabindex="-1"></a>ADSherb<span class="sc">$</span>clusterPro <span class="ot">&lt;-</span> <span class="fu">factor</span>(ADSherb<span class="sc">$</span>clusterPro, </span>
<span id="cb280-22"><a href="sect024.html#cb280-22" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb280-23"><a href="sect024.html#cb280-23" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Non significatif (p &gt; 0,05)&quot;</span>, </span>
<span id="cb280-24"><a href="sect024.html#cb280-24" tabindex="-1"></a>                                     <span class="st">&quot;p = 0,05&quot;</span>,<span class="st">&quot;p = 0,01&quot;</span>))</span>
<span id="cb280-25"><a href="sect024.html#cb280-25" tabindex="-1"></a></span>
<span id="cb280-26"><a href="sect024.html#cb280-26" tabindex="-1"></a><span class="do">## Cartographie des résultats</span></span>
<span id="cb280-27"><a href="sect024.html#cb280-27" tabindex="-1"></a>Carte1 <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(ADSherb) <span class="sc">+</span> </span>
<span id="cb280-28"><a href="sect024.html#cb280-28" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb280-29"><a href="sect024.html#cb280-29" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&quot;clusterLoc&quot;</span>, </span>
<span id="cb280-30"><a href="sect024.html#cb280-30" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#f0f0f0&quot;</span>, <span class="st">&quot;#fc9272&quot;</span>, <span class="st">&quot;#de2d26&quot;</span>),</span>
<span id="cb280-31"><a href="sect024.html#cb280-31" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Seuil de significativité&quot;</span>)<span class="sc">+</span></span>
<span id="cb280-32"><a href="sect024.html#cb280-32" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame=</span><span class="cn">FALSE</span>,</span>
<span id="cb280-33"><a href="sect024.html#cb280-33" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb280-34"><a href="sect024.html#cb280-34" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>, <span class="st">&quot;center&quot;</span>),</span>
<span id="cb280-35"><a href="sect024.html#cb280-35" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;a. Locataires majoritaires&quot;</span>,</span>
<span id="cb280-36"><a href="sect024.html#cb280-36" tabindex="-1"></a>            <span class="at">title.size =</span> <span class="dv">1</span>)</span>
<span id="cb280-37"><a href="sect024.html#cb280-37" tabindex="-1"></a>Carte2 <span class="ot">&lt;-</span>  <span class="fu">tm_shape</span>(ADSherb) <span class="sc">+</span> </span>
<span id="cb280-38"><a href="sect024.html#cb280-38" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb280-39"><a href="sect024.html#cb280-39" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&quot;clusterPro&quot;</span>, </span>
<span id="cb280-40"><a href="sect024.html#cb280-40" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#f0f0f0&quot;</span>, <span class="st">&quot;#fc9272&quot;</span>, <span class="st">&quot;#de2d26&quot;</span>),</span>
<span id="cb280-41"><a href="sect024.html#cb280-41" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Seuil de significativité&quot;</span>)<span class="sc">+</span></span>
<span id="cb280-42"><a href="sect024.html#cb280-42" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame=</span><span class="cn">FALSE</span>,</span>
<span id="cb280-43"><a href="sect024.html#cb280-43" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb280-44"><a href="sect024.html#cb280-44" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>, <span class="st">&quot;center&quot;</span>),</span>
<span id="cb280-45"><a href="sect024.html#cb280-45" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;b. Propriétaires majoritaires&quot;</span>,</span>
<span id="cb280-46"><a href="sect024.html#cb280-46" tabindex="-1"></a>            <span class="at">title.size =</span> <span class="dv">1</span>)</span>
<span id="cb280-47"><a href="sect024.html#cb280-47" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte1, Carte2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:LocalJointCountStatCarto"></span>
<img src="GMQ405_files/figure-html/LocalJointCountStatCarto-1.png" alt="Cartographie de la version locale des statistiques de comptage de jointure" width="85%" />
<p class="caption">
Figure 2.32: Cartographie de la version locale des statistiques de comptage de jointure
</p>
</div>
</div>
<div id="sect0245" class="section level3 hasAnchor" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Version locale de l’indice de Lee<a href="sect024.html#sect0245" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect02451" class="section level4 hasAnchor" number="2.4.5.1">
<h4><span class="header-section-number">2.4.5.1</span> Formulation de la version locale de l’indice de Lee<a href="sect024.html#sect02451" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dans le cas de l’autocorrélation spatiale bivariée, l’indice de Lee dispose aussi d’une version locale. Plus exactement, la version globale de l’indice correspond à l’agrégation des contributions locales de chaque observation. En cartographiant ces contributions locales, il est possible de se faire une idée de la relation spatiale entre les deux variables à l’étude. La version locale de l’indice est définie par l’équation suivante.</p>
<p><span class="math display" id="eq:LocalLee">\[\begin{equation}
L_i=\frac{n \cdot\left[\left(\sum_i w_{i j}\left(x_j-\bar{x}\right)\right)\left(\sum_i w_{i j}\left(y_j-\bar{y}\right)\right)\right]}{\sqrt{\sum_i\left(x_i-\bar{x}\right)^2} \sqrt{\sum_i\left(y_i-\bar{y}\right)^2}}=\frac{n \cdot\left(\tilde{x}_i-\bar{x}\right)\left(\tilde{y}_i-\bar{y}\right)}{\sqrt{\sum_i\left(x_i-\bar{x}\right)^2} \sqrt{\sum_i\left(y_i-\bar{y}\right)^2}}
\tag{2.23}
\end{equation}\]</span>
</p>
<p>Avec :</p>
<ul>
<li><span class="math inline">\(n\)</span>, le nombre d’observations;</li>
<li><span class="math inline">\(W_{ij}\)</span>, la valeur de la pondération spatiale entre les entités spatiales <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>;</li>
<li><span class="math inline">\(\bar{x}\)</span>, la moyenne de la variable <em>x</em>;</li>
<li><span class="math inline">\(\bar{y}\)</span>, la moyenne de la variable <em>y</em>.</li>
</ul>
</div>
<div id="sect02452" class="section level4 hasAnchor" number="2.4.5.2">
<h4><span class="header-section-number">2.4.5.2</span> Mise en œuvre dans R<a href="sect024.html#sect02452" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Reprenons notre exemple précédent sur les pollutions atmosphériques à Lyon. Nous avions observé que le dioxyde d’azote partageait un patron d’autocorrélation spatiale positif fort avec les particules fines, et un patron moins prononcé avec le bruit. Nous allons observer ces deux relations à l’échelle locale.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="sect024.html#cb281-1" tabindex="-1"></a><span class="fu">library</span>(geocmeans)</span>
<span id="cb281-2"><a href="sect024.html#cb281-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;LyonIris&quot;</span>)</span>
<span id="cb281-3"><a href="sect024.html#cb281-3" tabindex="-1"></a><span class="do">## Liste de variables à analyser</span></span>
<span id="cb281-4"><a href="sect024.html#cb281-4" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Lden&quot;</span>,<span class="st">&quot;NO2&quot;</span>,<span class="st">&quot;PM25&quot;</span>,<span class="st">&quot;VegHautPrt&quot;</span>)</span>
<span id="cb281-5"><a href="sect024.html#cb281-5" tabindex="-1"></a><span class="do">## Matrice de pondération spatiale Queen standardisée</span></span>
<span id="cb281-6"><a href="sect024.html#cb281-6" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(LyonIris, <span class="at">queen =</span> <span class="cn">TRUE</span>)</span>
<span id="cb281-7"><a href="sect024.html#cb281-7" tabindex="-1"></a>Wmat <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb, <span class="at">style =</span> <span class="st">&#39;W&#39;</span>)</span>
<span id="cb281-8"><a href="sect024.html#cb281-8" tabindex="-1"></a><span class="do">## Calcul de la version locale de l&#39;indice de Lee entre </span></span>
<span id="cb281-9"><a href="sect024.html#cb281-9" tabindex="-1"></a><span class="co"># NO2 et PM25</span></span>
<span id="cb281-10"><a href="sect024.html#cb281-10" tabindex="-1"></a>Lee_1 <span class="ot">&lt;-</span> <span class="fu">lee</span>(LyonIris<span class="sc">$</span>NO2, LyonIris<span class="sc">$</span>PM25, <span class="at">listw =</span> Wmat, <span class="at">n =</span> <span class="fu">nrow</span>(LyonIris))</span>
<span id="cb281-11"><a href="sect024.html#cb281-11" tabindex="-1"></a><span class="co"># NO2 et DBA</span></span>
<span id="cb281-12"><a href="sect024.html#cb281-12" tabindex="-1"></a>Lee_2  <span class="ot">&lt;-</span> <span class="fu">lee</span>(LyonIris<span class="sc">$</span>NO2, LyonIris<span class="sc">$</span>Lden, <span class="at">listw =</span> Wmat, <span class="at">n =</span> <span class="fu">nrow</span>(LyonIris))</span></code></pre></div>
<p>Dans le <em>package</em> <code>spdep</code>, aucune fonction ne permet de calculer un test d’inférence pour les valeurs locales de Lee. Nous pouvons cependant assez facilement obtenir des pseudo valeurs de <em>p</em> en réalisant 999 permutations aléatoires et en comptant combien de fois les valeurs obtenues au hasard sont plus grandes ou plus petites que celles obtenues dans les données initiales.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="sect024.html#cb282-1" tabindex="-1"></a><span class="do">## Nous créons une matrice à deux colonnes remplies de zéros qui </span></span>
<span id="cb282-2"><a href="sect024.html#cb282-2" tabindex="-1"></a><span class="do">## servira à compter le nombre de fois où les valeurs des permutations </span></span>
<span id="cb282-3"><a href="sect024.html#cb282-3" tabindex="-1"></a><span class="do">## sont au-dessus ou en dessous des valeurs réelles</span></span>
<span id="cb282-4"><a href="sect024.html#cb282-4" tabindex="-1"></a>p_vals_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(LyonIris)),</span>
<span id="cb282-5"><a href="sect024.html#cb282-5" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(LyonIris))</span>
<span id="cb282-6"><a href="sect024.html#cb282-6" tabindex="-1"></a>                  )</span>
<span id="cb282-7"><a href="sect024.html#cb282-7" tabindex="-1"></a>p_vals_2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(LyonIris)),</span>
<span id="cb282-8"><a href="sect024.html#cb282-8" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(LyonIris))</span>
<span id="cb282-9"><a href="sect024.html#cb282-9" tabindex="-1"></a>                  )</span>
<span id="cb282-10"><a href="sect024.html#cb282-10" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(LyonIris)</span>
<span id="cb282-11"><a href="sect024.html#cb282-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>){</span>
<span id="cb282-12"><a href="sect024.html#cb282-12" tabindex="-1"></a>  <span class="co"># Permutation aléatoire de l&#39;ordre des observations</span></span>
<span id="cb282-13"><a href="sect024.html#cb282-13" tabindex="-1"></a>  perm_data <span class="ot">&lt;-</span> LyonIris[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(LyonIris)),]</span>
<span id="cb282-14"><a href="sect024.html#cb282-14" tabindex="-1"></a>  <span class="co"># Calcul de l&#39;indice de Lee sur les données permutées</span></span>
<span id="cb282-15"><a href="sect024.html#cb282-15" tabindex="-1"></a>  Lee_1_perm <span class="ot">&lt;-</span> <span class="fu">lee</span>(perm_data<span class="sc">$</span>NO2, perm_data<span class="sc">$</span>PM25, <span class="at">listw =</span> Wmat, <span class="at">n =</span> N)</span>
<span id="cb282-16"><a href="sect024.html#cb282-16" tabindex="-1"></a>  Lee_2_perm  <span class="ot">&lt;-</span> <span class="fu">lee</span>(perm_data<span class="sc">$</span>NO2, perm_data<span class="sc">$</span>Lden, <span class="at">listw =</span> Wmat, <span class="at">n =</span> N)</span>
<span id="cb282-17"><a href="sect024.html#cb282-17" tabindex="-1"></a>  <span class="co"># Test pour vérifier si les valeurs obtenues sont plus grandes</span></span>
<span id="cb282-18"><a href="sect024.html#cb282-18" tabindex="-1"></a>  test1 <span class="ot">&lt;-</span> Lee_1<span class="sc">$</span>localL <span class="sc">&lt;</span> Lee_1_perm<span class="sc">$</span>localL</span>
<span id="cb282-19"><a href="sect024.html#cb282-19" tabindex="-1"></a>  test2 <span class="ot">&lt;-</span> Lee_2<span class="sc">$</span>localL <span class="sc">&lt;</span> Lee_2_perm<span class="sc">$</span>localL</span>
<span id="cb282-20"><a href="sect024.html#cb282-20" tabindex="-1"></a>  <span class="co"># Ajout du résultat aux matrices de valeurs de p</span></span>
<span id="cb282-21"><a href="sect024.html#cb282-21" tabindex="-1"></a>  p_vals_1[,<span class="dv">1</span>] <span class="ot">&lt;-</span> p_vals_1[,<span class="dv">1</span>] <span class="sc">+</span> test1</span>
<span id="cb282-22"><a href="sect024.html#cb282-22" tabindex="-1"></a>  p_vals_2[,<span class="dv">1</span>] <span class="ot">&lt;-</span> p_vals_2[,<span class="dv">1</span>] <span class="sc">+</span> test2</span>
<span id="cb282-23"><a href="sect024.html#cb282-23" tabindex="-1"></a>  <span class="co"># Test pour vérifier si les valeurs obtenues sont plus petites</span></span>
<span id="cb282-24"><a href="sect024.html#cb282-24" tabindex="-1"></a>  test1 <span class="ot">&lt;-</span> Lee_1<span class="sc">$</span>localL <span class="sc">&gt;</span> Lee_1_perm<span class="sc">$</span>localL</span>
<span id="cb282-25"><a href="sect024.html#cb282-25" tabindex="-1"></a>  test2 <span class="ot">&lt;-</span> Lee_2<span class="sc">$</span>localL <span class="sc">&gt;</span> Lee_2_perm<span class="sc">$</span>localL</span>
<span id="cb282-26"><a href="sect024.html#cb282-26" tabindex="-1"></a>  <span class="co"># Ajout du résultat aux matrices de valeurs de p</span></span>
<span id="cb282-27"><a href="sect024.html#cb282-27" tabindex="-1"></a>  p_vals_1[,<span class="dv">2</span>] <span class="ot">&lt;-</span> p_vals_1[,<span class="dv">2</span>] <span class="sc">+</span> test1</span>
<span id="cb282-28"><a href="sect024.html#cb282-28" tabindex="-1"></a>  p_vals_2[,<span class="dv">2</span>] <span class="ot">&lt;-</span> p_vals_2[,<span class="dv">2</span>] <span class="sc">+</span> test2</span>
<span id="cb282-29"><a href="sect024.html#cb282-29" tabindex="-1"></a>}</span>
<span id="cb282-30"><a href="sect024.html#cb282-30" tabindex="-1"></a></span>
<span id="cb282-31"><a href="sect024.html#cb282-31" tabindex="-1"></a><span class="do">## Ajout des données originales</span></span>
<span id="cb282-32"><a href="sect024.html#cb282-32" tabindex="-1"></a>LyonIris<span class="sc">$</span>Lee1 <span class="ot">&lt;-</span> Lee_1<span class="sc">$</span>localL</span>
<span id="cb282-33"><a href="sect024.html#cb282-33" tabindex="-1"></a>LyonIris<span class="sc">$</span>Lee2 <span class="ot">&lt;-</span> Lee_2<span class="sc">$</span>localL</span>
<span id="cb282-34"><a href="sect024.html#cb282-34" tabindex="-1"></a>LyonIris<span class="sc">$</span>Lee1_p_higher <span class="ot">&lt;-</span> p_vals_1[,<span class="dv">1</span>] <span class="sc">/</span> <span class="dv">999</span></span>
<span id="cb282-35"><a href="sect024.html#cb282-35" tabindex="-1"></a>LyonIris<span class="sc">$</span>Lee1_p_lower <span class="ot">&lt;-</span> p_vals_1[,<span class="dv">2</span>] <span class="sc">/</span> <span class="dv">999</span></span>
<span id="cb282-36"><a href="sect024.html#cb282-36" tabindex="-1"></a>LyonIris<span class="sc">$</span>Lee2_p_higher <span class="ot">&lt;-</span> p_vals_2[,<span class="dv">1</span>] <span class="sc">/</span> <span class="dv">999</span></span>
<span id="cb282-37"><a href="sect024.html#cb282-37" tabindex="-1"></a>LyonIris<span class="sc">$</span>Lee2_p_lower <span class="ot">&lt;-</span> p_vals_2[,<span class="dv">2</span>] <span class="sc">/</span> <span class="dv">999</span></span>
<span id="cb282-38"><a href="sect024.html#cb282-38" tabindex="-1"></a></span>
<span id="cb282-39"><a href="sect024.html#cb282-39" tabindex="-1"></a><span class="do">## Cartographie des résultats avec deux cartes dans lesquelles</span></span>
<span id="cb282-40"><a href="sect024.html#cb282-40" tabindex="-1"></a><span class="do">## les valeurs non significatives au seuil 0,01 sont représentées en gris clair.</span></span>
<span id="cb282-41"><a href="sect024.html#cb282-41" tabindex="-1"></a>test_sign1 <span class="ot">&lt;-</span> LyonIris<span class="sc">$</span>Lee1_p_higher <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">|</span> LyonIris<span class="sc">$</span>Lee1_p_lower <span class="sc">&lt;</span> <span class="fl">0.01</span></span>
<span id="cb282-42"><a href="sect024.html#cb282-42" tabindex="-1"></a>map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(LyonIris)<span class="sc">+</span><span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb282-43"><a href="sect024.html#cb282-43" tabindex="-1"></a>  <span class="fu">tm_shape</span>(<span class="fu">subset</span>(LyonIris, test_sign1)) <span class="sc">+</span> </span>
<span id="cb282-44"><a href="sect024.html#cb282-44" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&#39;Lee1&#39;</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">style =</span> <span class="st">&#39;kmeans&#39;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">palette =</span> <span class="st">&#39;-RdBu&#39;</span>,</span>
<span id="cb282-45"><a href="sect024.html#cb282-45" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">&#39;Indice de Lee&#39;</span>, <span class="at">legend.format =</span> <span class="fu">list</span>(<span class="st">&#39;digits&#39;</span> <span class="ot">=</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb282-46"><a href="sect024.html#cb282-46" tabindex="-1"></a>  <span class="fu">tm_shape</span>(<span class="fu">subset</span>(LyonIris, <span class="sc">!</span>test_sign1)) <span class="sc">+</span> </span>
<span id="cb282-47"><a href="sect024.html#cb282-47" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&#39;lightgrey&#39;</span>)<span class="sc">+</span> </span>
<span id="cb282-48"><a href="sect024.html#cb282-48" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">FALSE</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb282-49"><a href="sect024.html#cb282-49" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;a. NO2 versus PM25&quot;</span>, <span class="at">title.size =</span> .<span class="dv">75</span>)<span class="sc">+</span></span>
<span id="cb282-50"><a href="sect024.html#cb282-50" tabindex="-1"></a>  <span class="fu">tm_credits</span>(<span class="at">text=</span><span class="st">&quot;Gris : non significatif (p &gt; 0,001).&quot;</span>,</span>
<span id="cb282-51"><a href="sect024.html#cb282-51" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;RIGHT&quot;</span>, <span class="st">&quot;BOTTOM&quot;</span>))</span>
<span id="cb282-52"><a href="sect024.html#cb282-52" tabindex="-1"></a></span>
<span id="cb282-53"><a href="sect024.html#cb282-53" tabindex="-1"></a>test_sign2 <span class="ot">&lt;-</span> LyonIris<span class="sc">$</span>Lee2_p_higher <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">|</span> LyonIris<span class="sc">$</span>Lee2_p_lower <span class="sc">&lt;</span> <span class="fl">0.01</span></span>
<span id="cb282-54"><a href="sect024.html#cb282-54" tabindex="-1"></a>map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(LyonIris)<span class="sc">+</span><span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb282-55"><a href="sect024.html#cb282-55" tabindex="-1"></a>  <span class="fu">tm_shape</span>(<span class="fu">subset</span>(LyonIris, test_sign2)) <span class="sc">+</span> </span>
<span id="cb282-56"><a href="sect024.html#cb282-56" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&#39;Lee2&#39;</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">style =</span> <span class="st">&#39;kmeans&#39;</span>, <span class="at">palette =</span> <span class="st">&#39;-RdBu&#39;</span>,</span>
<span id="cb282-57"><a href="sect024.html#cb282-57" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">&#39;Indice de Lee&#39;</span>, <span class="at">legend.format =</span> <span class="fu">list</span>(<span class="st">&#39;digits&#39;</span> <span class="ot">=</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb282-58"><a href="sect024.html#cb282-58" tabindex="-1"></a>  <span class="fu">tm_shape</span>(<span class="fu">subset</span>(LyonIris, <span class="sc">!</span>test_sign2)) <span class="sc">+</span> </span>
<span id="cb282-59"><a href="sect024.html#cb282-59" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&#39;lightgrey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb282-60"><a href="sect024.html#cb282-60" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">FALSE</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb282-61"><a href="sect024.html#cb282-61" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;b. NO2 versus Lden&quot;</span>, <span class="at">title.size =</span> .<span class="dv">75</span>)<span class="sc">+</span></span>
<span id="cb282-62"><a href="sect024.html#cb282-62" tabindex="-1"></a>  <span class="fu">tm_credits</span>(<span class="at">text=</span><span class="st">&quot;Gris : non significatif (p &gt; 0,001).&quot;</span>,</span>
<span id="cb282-63"><a href="sect024.html#cb282-63" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;RIGHT&quot;</span>, <span class="st">&quot;BOTTOM&quot;</span>))</span>
<span id="cb282-64"><a href="sect024.html#cb282-64" tabindex="-1"></a></span>
<span id="cb282-65"><a href="sect024.html#cb282-65" tabindex="-1"></a><span class="fu">tmap_arrange</span>(map1, map2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:localLeeMaps"></span>
<img src="GMQ405_files/figure-html/localLeeMaps-1.png" alt="Cartographie des valeurs de l'indice de Lee local" width="85%" />
<p class="caption">
Figure 2.33: Cartographie des valeurs de l’indice de Lee local
</p>
</div>
<p>À la figure <a href="sect024.html#fig:localLeeMaps">2.33</a>.a, nous constatons une forte autocorrélation spatiale bivariée positive dans deux secteurs de l’agglomération :</p>
<ul>
<li>Au centre avec des entités spatiales ayant des valeurs fortes pour les deux variables.</li>
<li>Dans les zones périphériques au nord, à l’est et l’ouest avec des entités spatiales ayant des valeurs faibles pour les deux variables.</li>
</ul>
<p>À la figure <a href="sect024.html#fig:localLeeMaps">2.33</a>.b, nous observons trois patrons d’autocorrélation spatiale bivariée :</p>
<ul>
<li>Autocorrélation spatiale positive pour des entités spatiales au centre de l’agglomération avec des valeurs fortes de bruit et de dioxyde d’azote.</li>
<li>Autocorrélation spatiale positive pour des entités spatiales au nord de l’agglomération avec des valeurs faibles de bruit et de dioxyde d’azote.</li>
<li>Autocorrélation spatiale négative à l’est de l’agglomération avec des valeurs fortes pour le bruit, mais faibles pour le dioxyde d’azote.</li>
</ul>
<div class="bloc_aller_loin">
<p><strong>Autocorrélation spatiale multivariée</strong>. Il est possible d’analyser l’autocorrélation spatiale dans un contexte multivarié. Cependant, ces méthodes sont parfois difficiles à interpréter, car l’augmentation de la dimensionnalité des données analysées ajoute un haut niveau d’abstraction. Si ces méthodes vous intéressent, nous vous recommandons de jeter un œil à :</p>
<ul>
<li><p>L’indice de Geary multivarié local <span class="citation">(<a href="#ref-anselin2019local">Anselin 2019</a>)</span>, qui peut être calculé facilement dans R (avec la fonction <code>local_multigeary</code> du <em>package</em> <code>rgeoda</code>) en faisant la moyenne des valeurs locales de l’indice de Geary univarié.</p></li>
<li><p>Les méthodes factorielles intégrant l’espace, dont l’analyse en composantes principales spatiale (<em>spatial principal component analysis</em> en anglais, SPCA) <span class="citation">(<a href="#ref-jombart2008revealing">Jombart et al. 2008</a>)</span> qui permet d’identifier des facteurs maximisant le produit de la variance expliquée d’un ensemble de variables continues et l’autocorrélation spatiale de ces facteurs (mesurée avec le <em>I</em> de Moran). Dans R, les <em>packages</em> pertinents pour ces méthodes sont <code>adegenet</code> et <code>ade4</code>.</p></li>
</ul>
</div>
</div>
</div>
<div id="sect0246" class="section level3 hasAnchor" number="2.4.6">
<h3><span class="header-section-number">2.4.6</span> Typologie basée sur le diagramme de Moran dans un contexte bivarié<a href="sect024.html#sect0246" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect02461" class="section level4 hasAnchor" number="2.4.6.1">
<h4><span class="header-section-number">2.4.6.1</span> Formulation de la typologie basée sur le diagramme de Moran dans un contexte bivarié<a href="sect024.html#sect02461" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>À la section <a href="sect024.html#sect0243">2.4.3</a>, nous avons décrit la construction du diagramme de Moran dans un contexte univarié avec la variable centrée réduite (<strong>ZX</strong>) sur l’axe des X et la variable centrée réduite spatialement décalée (<strong>WZX</strong>) sur l’axe des Y. Par la suite, ce diagramme est décomposé en quatre quadrants (HH, LL, HL, LH). Cette démarche peut être adaptée à un contexte bivarié avec deux variables continues, c’est-à-dire avec <strong>ZX</strong> et <strong>WZY</strong> pour construire le diagramme. Les quatre quadrants s’interprètent alors comme suit (figure <a href="sect024.html#fig:localLeeMaps">2.33</a>) :</p>
<ol style="list-style-type: decimal">
<li><p><strong>HH (<em>High-High</em>)</strong> regroupe des entités spatiales avec des valeurs fortes (H) pour la variable X qui sont voisines ou proches d’autres entités spatiales avec des valeurs fortes pour la variable Y (H). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale bivariée positive avec des valeurs fortes (HH)</strong>.</p></li>
<li><p><strong>LL (<em>Low-Low</em>)</strong> regroupe des entités spatiales avec des valeurs faibles (L) pour la variable X qui sont voisines ou proches d’autres entités spatiales avec des valeurs faibles pour la variable Y (L). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale bivariée positive avec des valeurs faibles (LL)</strong>.</p></li>
<li><p><strong>HL (<em>High-Low</em>)</strong> regroupe des entités spatiales avec des valeurs fortes (H) pour la variable X qui sont voisines ou proches d’autres entités spatiales avec des valeurs faibles pour la variable Y (L), soit de <strong>l’autocorrélation spatiale locale bivariée négative (HL)</strong>.</p></li>
<li><p><strong>LH (<em>Low-High</em>)</strong> regroupe des entités spatiales avec des valeurs faibles (L) pour la variable X qui sont voisines ou proches d’autres entités spatiales avec des valeurs fortes (H) pour la variable Y, soit de <strong>l’autocorrélation spatiale bivariée locale négative (LH)</strong>.</p></li>
</ol>
<p>Pour déterminer si l’autocorrélation spatiale locale (positive ou négative) pour les quatre est significative, nous utilisons la valeur de <em>p</em> de la version locale du <em>I</em> de Moran bivariée (habituellement p = 0,05).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:NuagePointsMoranBivariee"></span>
<img src="GMQ405_files/figure-html/NuagePointsMoranBivariee-1.png" alt="Diagramme de Moran dans un contexte bivarié" width="85%" />
<p class="caption">
Figure 2.34: Diagramme de Moran dans un contexte bivarié
</p>
</div>
<div class="bloc_attention">
<p><strong>Non-symétrie du <em>I</em> de Moran bivarié et du diagramme de Moran dans un contexte bivarié</strong></p>
<p>À titre de rappel, le diagramme est construit avec <strong>ZX</strong> et <strong>WZY</strong>, tout comme l’indice de Moran bivarié. Par conséquent, les résultats entre <strong>ZX</strong> et <strong>WZY</strong> (figure <a href="sect024.html#fig:localLeeMaps">2.33</a>.a) et <strong>ZY</strong> et <strong>WZX</strong> (figure <a href="sect024.html#fig:localLeeMaps">2.33</a>.b) ne sont pas identiques!</p>
</div>
</div>
<div id="sect02462" class="section level4 hasAnchor" number="2.4.6.2">
<h4><span class="header-section-number">2.4.6.2</span> Mise en œuvre dans R<a href="sect024.html#sect02462" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour créer le diagramme de Moran dans un contexte bivarié, nous avons écrit la fonction <code>DiagMoranUnivarie</code>.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="sect024.html#cb283-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;code_complementaire/DiagrammeMoran.R&quot;</span>)</span>
<span id="cb283-2"><a href="sect024.html#cb283-2" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb283-3"><a href="sect024.html#cb283-3" tabindex="-1"></a><span class="do">## Matrice de contiguïté</span></span>
<span id="cb283-4"><a href="sect024.html#cb283-4" tabindex="-1"></a>Queen <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(LyonIris, <span class="at">queen=</span><span class="cn">FALSE</span>)</span>
<span id="cb283-5"><a href="sect024.html#cb283-5" tabindex="-1"></a>W.Queen <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Queen, <span class="at">zero.policy=</span><span class="cn">TRUE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb283-6"><a href="sect024.html#cb283-6" tabindex="-1"></a><span class="do">## Réalisation du diagramme de Moran avec la fonction DiagMoranBivarie</span></span>
<span id="cb283-7"><a href="sect024.html#cb283-7" tabindex="-1"></a>Diag1 <span class="ot">&lt;-</span> <span class="fu">DiagMoranBivarie</span>(<span class="at">x =</span> LyonIris<span class="sc">$</span>NO2,</span>
<span id="cb283-8"><a href="sect024.html#cb283-8" tabindex="-1"></a>                 <span class="at">y =</span> LyonIris<span class="sc">$</span>PM25,</span>
<span id="cb283-9"><a href="sect024.html#cb283-9" tabindex="-1"></a>                 <span class="at">listW =</span> W.Queen,</span>
<span id="cb283-10"><a href="sect024.html#cb283-10" tabindex="-1"></a>                 <span class="at">titre =</span> <span class="st">&quot;Diagramme de Moran&quot;</span>,</span>
<span id="cb283-11"><a href="sect024.html#cb283-11" tabindex="-1"></a>                 <span class="at">titreAxeX =</span> <span class="st">&quot;ZX : Dioxyde d&#39;azote (NO2)&quot;</span>,</span>
<span id="cb283-12"><a href="sect024.html#cb283-12" tabindex="-1"></a>                 <span class="at">titreAxeY =</span> <span class="st">&quot;WZY : Particules fines (PM2,5)&quot;</span>,</span>
<span id="cb283-13"><a href="sect024.html#cb283-13" tabindex="-1"></a>                 <span class="at">AfficheAide=</span><span class="cn">FALSE</span>)</span>
<span id="cb283-14"><a href="sect024.html#cb283-14" tabindex="-1"></a>Diag2 <span class="ot">&lt;-</span> <span class="fu">DiagMoranBivarie</span>(<span class="at">x =</span> LyonIris<span class="sc">$</span>PM25,</span>
<span id="cb283-15"><a href="sect024.html#cb283-15" tabindex="-1"></a>                 <span class="at">y =</span> LyonIris<span class="sc">$</span>NO2,</span>
<span id="cb283-16"><a href="sect024.html#cb283-16" tabindex="-1"></a>                 <span class="at">listW =</span> W.Queen,</span>
<span id="cb283-17"><a href="sect024.html#cb283-17" tabindex="-1"></a>                 <span class="at">titre =</span> <span class="st">&quot;Diagramme de Moran&quot;</span>,</span>
<span id="cb283-18"><a href="sect024.html#cb283-18" tabindex="-1"></a>                 <span class="at">titreAxeX =</span> <span class="st">&quot;ZX : Particules fines (PM2,5)&quot;</span>,</span>
<span id="cb283-19"><a href="sect024.html#cb283-19" tabindex="-1"></a>                 <span class="at">titreAxeY =</span> <span class="st">&quot;WZY : Dioxyde d&#39;azote (NO2)&quot;</span>,</span>
<span id="cb283-20"><a href="sect024.html#cb283-20" tabindex="-1"></a>                 <span class="at">AfficheAide=</span><span class="cn">FALSE</span>)</span>
<span id="cb283-21"><a href="sect024.html#cb283-21" tabindex="-1"></a><span class="fu">ggarrange</span>(Diag1, Diag2)</span></code></pre></div>
<p>Pour mettre en œuvre la typologie, vous pouvez soit utiliser la fonction <code>local_bimoran</code> du <em>package</em> <code>rgeoda</code> ou <code>localmoran_bv</code> du <em>package</em> <code>spdep</code>. Cette dernière est mobilisée dans le code ci-dessous pour obtenir la typologie de l’autocorrélation spatiale bivariée entre :</p>
<ul>
<li>Le dioxyde d’azote (<strong>ZX</strong>) et les particules fines (<strong>ZWY</strong>) (figure <a href="sect024.html#fig:localLeeMaps">2.33</a>.a).</li>
<li>Les particules fines (<strong>ZX</strong>) et le dioxyde d’azote (<strong>ZWY</strong>) (figure <a href="sect024.html#fig:localLeeMaps">2.33</a>.b).</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:TypoDiagBivariee"></span>
<img src="GMQ405_files/figure-html/TypoDiagBivariee-1.png" alt="Typologies basées sur le diagramme de Moran dans un contexte bivarié" width="85%" />
<p class="caption">
Figure 2.35: Typologies basées sur le diagramme de Moran dans un contexte bivarié
</p>
</div>
<div class="bloc_aller_loin">
<p><strong>Autocorrélation spatiale locale dans un contexte bivarié pour les variables binaires</strong></p>
<p>À la section <a href="sect024.html#sect0244">2.4.4</a>, nous avons abordé les statistiques locales de comptage de jointure. Tout comme la version locale de <em>I</em> de Moran, elles peuvent être adaptées à un contexte bivarié avec deux variables binaires. Pour ce faire, vous pouvez utiliser la fonction <code>local_bijoincount</code> du <em>package</em> <code>rgeoda</code>.</p>
</div>
</div>
</div>
<div id="sect0247" class="section level3 hasAnchor" number="2.4.7">
<h3><span class="header-section-number">2.4.7</span> Autocorrélation locale pour une variable qualitative (catégorielle) : l’indicateur ELSA<a href="sect024.html#sect0247" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect02471" class="section level4 hasAnchor" number="2.4.7.1">
<h4><span class="header-section-number">2.4.7.1</span> Formulation de l’indicateur ELSA<a href="sect024.html#sect02471" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Récemment, un indicateur basé sur la mesure de l’entropie locale a été proposé pour mesurer l’autocorrélation spatiale locale d’une variable qualitative comprenant plusieurs modalités (catégories) <span class="citation">(<a href="#ref-naimi2019elsa">Naimi et al. 2019</a>)</span>. Cet indicateur ELSA (<em>Entropy-based local indicator of spatial association</em>), qui varie de 0 (autocorrélation spatiale parfaite) à 1 (forte hétérogénéité spatiale), est calculé comme suit :</p>
<p><span class="math display" id="eq:ELSA1">\[\begin{equation}  
\begin{aligned}
E_i=E_{a i} \times E_{c i} \\
&amp; E_{a i}=\frac{\sum_j \omega_{i j} d_{i j}}{\max \{d\} \sum_j \omega_{i j}}, j \neq i \\
&amp; E_{c i}=-\frac{\sum_{k=1}^{m_\omega} p_k \log _2\left(p_k\right)}{\log _2 m_i}, j \neq i \\
&amp; m_i=\left\{\begin{array}{l}
m \text { if } \sum_j \omega_{i j}&gt;m \\
\sum_j \omega_{i j}, \text { otherwise }
\end{array}\right. \\
&amp; d_{i j}=\left|c_i-c_j\right|
\end{aligned}
\tag{2.24}
\end{equation}\]</span>
</p>
<p>Il s’agit donc du produit de deux termes, soit <span class="math inline">\(E_{a i}\)</span> et <span class="math inline">\(E_{c i}\)</span>. Le premier mesure la dissimilarité entre l’observation <em>i</em> et ses voisins <em>j</em>. Le second est l’indice d’entropie de Shanon et quantifie la diversité des observations voisines de <em>i</em>.</p>
<p>L’indicateur ELSA a la particularité de tenir compte du degré de dissimilarité entre les modalités (catégories) de la variable qualitative à l’étude. Aussi, il permet de spécifier qu’une catégorie <em>A</em> est plus ressemblante à une catégorie <em>B</em> qu’à une catégorie <em>C</em>. Or, nous supposons habituellement que <em>A</em> est différent de <em>B</em> et de <em>C</em>, ce qui produit une matrice des distances sémantiques binaire, tel que présentée au tableau <a href="sect024.html#tab:TabMatriceSemantique1">2.11</a>.</p>
<table>
<caption>
<span id="tab:TabMatriceSemantique1">Tableau 2.11: </span>Matrice des distances sématiques classique (binaire)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
A
</th>
<th style="text-align:center;">
B
</th>
<th style="text-align:center;">
C
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<p>Toutefois, si nous considérons que les catégories <em>A</em> et <em>B</em> sont plus proches entre elles que de la catégorie <em>C</em>, la matrice des distances sémantiques devrait être différente comme présentée au tableau <a href="sect024.html#tab:TabMatriceSemantique2">2.12</a>.</p>
<table>
<caption>
<span id="tab:TabMatriceSemantique2">Tableau 2.12: </span>Matrice des distances sémantiques modifiée
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
A
</th>
<th style="text-align:center;">
B
</th>
<th style="text-align:center;">
C
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:center;">
0,0
</td>
<td style="text-align:center;">
0,5
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:center;">
0,5
</td>
<td style="text-align:center;">
0,0
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:center;">
1,0
</td>
<td style="text-align:center;">
1,0
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<p>Pour déterminer si l’autocorrélation spatiale est significative, Babak Naimi et ses collègues <span class="citation">(<a href="#ref-naimi2019elsa">2019</a>)</span> proposent une approche par simulations Monte-Carlo, très semblable aux tests par permutations vus pour les autres mesures d’autocorrélation spatiale.</p>
</div>
<div id="sect02472" class="section level4 hasAnchor" number="2.4.7.2">
<h4><span class="header-section-number">2.4.7.2</span> Mise en œuvre dans R<a href="sect024.html#sect02472" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous illustrons ici comment calculer l’indice <em>ELSA</em> sur des données matricielles (<em>raster</em>) avec une image dérivée d’un modèle numérique de terrain (élévation) et d’une image d’un indice de végétation par différence normalisée (NDVI) (figure <a href="sect024.html#fig:figLaval">2.36</a>). Cette image est en accès libre sur le <a href="https://observatoire.cmm.qc.ca/produits/donnees-georeferencees/#indice_canopee">portail de données</a> de la Communauté métropolitaine de Montréal. Pour accélérer les calculs, nous avons extrait une petite partie de l’image qui couvre une zone de la ville de Laval. Cette image classifie le territoire en quatre catégories :</p>
<ol style="list-style-type: decimal">
<li>Minéral bas (&lt; 3 mètres et NDVI &lt; 0,3) (route, stationnement, etc.).</li>
<li>Minéral haut (&gt;= 3 mètres et NDVI &lt; 0,3) (constructions).</li>
<li>Végétal bas (&lt; 3 mètres et NDVI &gt;= 0,3) (culture, gazon, etc.).</li>
<li>Végétal haut (&gt;= 3 mètres et NDVI &gt;= 0,3) (canopée).</li>
</ol>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="sect024.html#cb284-1" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb284-2"><a href="sect024.html#cb284-2" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb284-3"><a href="sect024.html#cb284-3" tabindex="-1"></a><span class="fu">library</span>(geocmeans)</span>
<span id="cb284-4"><a href="sect024.html#cb284-4" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb284-5"><a href="sect024.html#cb284-5" tabindex="-1"></a><span class="do">## Chargement du raster</span></span>
<span id="cb284-6"><a href="sect024.html#cb284-6" tabindex="-1"></a>laval_data <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;data/chap02/65005_IndiceCanopee_2021_sub.tif&quot;</span>)</span>
<span id="cb284-7"><a href="sect024.html#cb284-7" tabindex="-1"></a><span class="fu">tm_shape</span>(laval_data) <span class="sc">+</span></span>
<span id="cb284-8"><a href="sect024.html#cb284-8" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#fbd4b4&quot;</span>, <span class="st">&quot;#e36c0a&quot;</span>, <span class="st">&quot;#92d050&quot;</span>, <span class="st">&quot;#76923c&quot;</span>),</span>
<span id="cb284-9"><a href="sect024.html#cb284-9" tabindex="-1"></a>            <span class="at">style =</span> <span class="st">&#39;cat&#39;</span>,</span>
<span id="cb284-10"><a href="sect024.html#cb284-10" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Classe (catégorie)&quot;</span>,</span>
<span id="cb284-11"><a href="sect024.html#cb284-11" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1. Minéral bas&quot;</span>, <span class="st">&quot;2. Minéral haut&quot;</span>,</span>
<span id="cb284-12"><a href="sect024.html#cb284-12" tabindex="-1"></a>                       <span class="st">&quot;3. Végétal bas&quot;</span>, <span class="st">&quot;4. Végétal haut&quot;</span>))<span class="sc">+</span></span>
<span id="cb284-13"><a href="sect024.html#cb284-13" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figLaval"></span>
<img src="GMQ405_files/figure-html/figLaval-1.png" alt="Données matricielle sur une portion du territoire de Laval" width="100%" />
<p class="caption">
Figure 2.36: Données matricielle sur une portion du territoire de Laval
</p>
</div>
<p>Pour calculer l’indicateur ELSA, nous devons premièrement définir une matrice de voisinage. Pour ce faire, nous créons plusieurs fenêtres circulaires de taille différente (100, 200, 300 et 400 mètres; figure <a href="sect024.html#fig:chap02FigureCirculaWindow">2.37</a>). Notez que la résolution spatiale de l’image utilisée est de 5 m x 5 m, ce qu’il est possible de vérifier avec la fonction <code>terra::res</code>. La figure <a href="sect024.html#fig:chap02FigureCirculaWindow">2.37</a> illustre la taille des différentes matrices spatiales circulaires que nous allons construire. Chaque pixel de la zone en noir sera considéré comme un voisin du pixel central pour lequel l’indicateur <em>ELSA</em> sera calculé.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:chap02FigureCirculaWindow"></span>
<img src="GMQ405_files/figure-html/chap02FigureCirculaWindow-1.png" alt="Illustration des matrices spatiales circulaires sur une image" width="85%" />
<p class="caption">
Figure 2.37: Illustration des matrices spatiales circulaires sur une image
</p>
</div>
<p>En plus de la matrice spatiale, nous devons définir une matrice de dissimilarité entre les modalités (catégories) de la variable qualitative. Nous proposons de considérer que les catégories <strong>Végétal haut</strong> et <strong>Végétal bas</strong> ont une distance de 0,5 entre elles, tout comme les catégories de surface <strong>Minéral bas</strong> et <strong>Minéral haut</strong>. Par contre, la distance est fixée à 1 entre les surfaces végétales et celles minérales (tableau <a href="sect024.html#tab:TabMatriceSemantiqueELSA">2.13</a>).</p>
<table>
<caption>
<span id="tab:TabMatriceSemantiqueELSA">Tableau 2.13: </span>Matrice de dissimilarité entre les catégories de l’image
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
MB
</th>
<th style="text-align:center;">
MH
</th>
<th style="text-align:center;">
VB
</th>
<th style="text-align:center;">
VH
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Minéral bas (MB)
</td>
<td style="text-align:center;">
0,0
</td>
<td style="text-align:center;">
0,5
</td>
<td style="text-align:center;">
1,0
</td>
<td style="text-align:center;">
1,0
</td>
</tr>
<tr>
<td style="text-align:left;">
Minéral haut (MH)
</td>
<td style="text-align:center;">
0,5
</td>
<td style="text-align:center;">
0,0
</td>
<td style="text-align:center;">
1,0
</td>
<td style="text-align:center;">
1,0
</td>
</tr>
<tr>
<td style="text-align:left;">
Végétatal bas (VB)
</td>
<td style="text-align:center;">
1,0
</td>
<td style="text-align:center;">
1,0
</td>
<td style="text-align:center;">
0,0
</td>
<td style="text-align:center;">
0,5
</td>
</tr>
<tr>
<td style="text-align:left;">
Végétal haut (VH)
</td>
<td style="text-align:center;">
1,0
</td>
<td style="text-align:center;">
1,0
</td>
<td style="text-align:center;">
0,5
</td>
<td style="text-align:center;">
0,0
</td>
</tr>
</tbody>
</table>
<p>Finalement, nous calculons l’indicateur d’autocorrélation spatiale ELSA avec uniquement des rayons de 100 et de 400 mètres afin de limiter le temps de calcul. Pour ce faire, nous utilisons le package <em>geocmeans</em> et ses fonctions <code>circular_window</code> et <code>elsa_raster</code>.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="sect024.html#cb285-1" tabindex="-1"></a><span class="do">## Avec geocmeans, la première catégorie doit avoir la valeur 0</span></span>
<span id="cb285-2"><a href="sect024.html#cb285-2" tabindex="-1"></a>laval_data <span class="ot">&lt;-</span> laval_data <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb285-3"><a href="sect024.html#cb285-3" tabindex="-1"></a><span class="do">## Définition des fenêtres circulaires à 100 et 400 mètre</span></span>
<span id="cb285-4"><a href="sect024.html#cb285-4" tabindex="-1"></a>w100 <span class="ot">&lt;-</span> <span class="fu">circular_window</span>(<span class="dv">100</span>,<span class="dv">5</span>)</span>
<span id="cb285-5"><a href="sect024.html#cb285-5" tabindex="-1"></a>w400 <span class="ot">&lt;-</span> <span class="fu">circular_window</span>(<span class="dv">400</span>,<span class="dv">5</span>)</span>
<span id="cb285-6"><a href="sect024.html#cb285-6" tabindex="-1"></a><span class="do">## Calcul de l&#39;indicateur ELSA</span></span>
<span id="cb285-7"><a href="sect024.html#cb285-7" tabindex="-1"></a>elsa_100 <span class="ot">&lt;-</span> <span class="fu">elsa_raster</span>(laval_data, w100, matrice_dissim)</span>
<span id="cb285-8"><a href="sect024.html#cb285-8" tabindex="-1"></a>elsa_400 <span class="ot">&lt;-</span> <span class="fu">elsa_raster</span>(laval_data, w400, matrice_dissim)</span>
<span id="cb285-9"><a href="sect024.html#cb285-9" tabindex="-1"></a><span class="do">## Cartographie des résultats</span></span>
<span id="cb285-10"><a href="sect024.html#cb285-10" tabindex="-1"></a>carte1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(elsa_100) <span class="sc">+</span> </span>
<span id="cb285-11"><a href="sect024.html#cb285-11" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">&quot;RdYlGn&quot;</span>, <span class="at">n =</span> <span class="dv">6</span>, </span>
<span id="cb285-12"><a href="sect024.html#cb285-12" tabindex="-1"></a>            <span class="at">legend.is.portrait =</span> <span class="cn">FALSE</span>, <span class="at">title =</span> <span class="st">&quot;ELSA 100m&quot;</span>) <span class="sc">+</span> </span>
<span id="cb285-13"><a href="sect024.html#cb285-13" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb285-14"><a href="sect024.html#cb285-14" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb285-15"><a href="sect024.html#cb285-15" tabindex="-1"></a>            <span class="at">legend.stack =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb285-16"><a href="sect024.html#cb285-16" tabindex="-1"></a>            <span class="at">legend.text.size =</span> .<span class="dv">55</span>)</span>
<span id="cb285-17"><a href="sect024.html#cb285-17" tabindex="-1"></a>carte2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(elsa_400) <span class="sc">+</span> </span>
<span id="cb285-18"><a href="sect024.html#cb285-18" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">&quot;RdYlGn&quot;</span>, <span class="at">n =</span> <span class="dv">6</span>, </span>
<span id="cb285-19"><a href="sect024.html#cb285-19" tabindex="-1"></a>            <span class="at">legend.is.portrait =</span> <span class="cn">FALSE</span>, <span class="at">title =</span> <span class="st">&quot;ELSA 400m&quot;</span>) <span class="sc">+</span> </span>
<span id="cb285-20"><a href="sect024.html#cb285-20" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb285-21"><a href="sect024.html#cb285-21" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb285-22"><a href="sect024.html#cb285-22" tabindex="-1"></a>            <span class="at">legend.stack =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb285-23"><a href="sect024.html#cb285-23" tabindex="-1"></a>            <span class="at">legend.text.size =</span> .<span class="dv">55</span>)</span>
<span id="cb285-24"><a href="sect024.html#cb285-24" tabindex="-1"></a><span class="fu">tmap_arrange</span>(carte1, carte2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:chap02FigureElsaLaval"></span>
<img src="GMQ405_files/figure-html/chap02FigureElsaLaval-1.png" alt="Cartographie des valeurs ELSA obtenues" width="85%" />
<p class="caption">
Figure 2.38: Cartographie des valeurs ELSA obtenues
</p>
</div>
<p>La figure <a href="sect024.html#fig:chap02FigureElsaLaval">2.38</a> révèle que l’utilisation d’une matrice circulaire de 400 mètres lissent trop les résultats. Par conséquent, nous privilégions ceux obtenus avec une matrice circulaire de 100 mètres. Puis, avec le code ci-dessous, nous souhaitons identifier les bâtiments avec un environnement immédiat (100 mètres) avec une forte hétérogénéité spatiale, c’est-à-dire végétalisé.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="sect024.html#cb286-1" tabindex="-1"></a><span class="co"># Nous isolons les bâtiments avec forte dissimilarité à proximité</span></span>
<span id="cb286-2"><a href="sect024.html#cb286-2" tabindex="-1"></a><span class="co"># la valeur de l&#39;image de sortie (buildings_green) sera 1</span></span>
<span id="cb286-3"><a href="sect024.html#cb286-3" tabindex="-1"></a>buildings_green <span class="ot">&lt;-</span> (laval_data <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">&amp;</span> (elsa_100 <span class="sc">&gt;=</span> <span class="fl">0.4</span>)</span>
<span id="cb286-4"><a href="sect024.html#cb286-4" tabindex="-1"></a><span class="co"># Nous isolons les bâtiments avec faible dissimilarité à proximité</span></span>
<span id="cb286-5"><a href="sect024.html#cb286-5" tabindex="-1"></a><span class="co"># la valeur de l&#39;image de sortie (buildings_other) sera 2</span></span>
<span id="cb286-6"><a href="sect024.html#cb286-6" tabindex="-1"></a>buildings_other <span class="ot">&lt;-</span> ((laval_data <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">&amp;</span> (elsa_100 <span class="sc">&lt;</span> <span class="fl">0.4</span>)) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb286-7"><a href="sect024.html#cb286-7" tabindex="-1"></a><span class="co"># Nous combinons les deux images</span></span>
<span id="cb286-8"><a href="sect024.html#cb286-8" tabindex="-1"></a>raster_buildings <span class="ot">&lt;-</span> buildings_green <span class="sc">+</span> buildings_other</span>
<span id="cb286-9"><a href="sect024.html#cb286-9" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span>
<span id="cb286-10"><a href="sect024.html#cb286-10" tabindex="-1"></a><span class="fu">tm_basemap</span>(<span class="fu">c</span>(<span class="st">&quot;Esri.WorldImagery&quot;</span>, <span class="st">&quot;OpenStreetMap&quot;</span>))<span class="sc">+</span></span>
<span id="cb286-11"><a href="sect024.html#cb286-11" tabindex="-1"></a>  <span class="fu">tm_shape</span>(raster_buildings) <span class="sc">+</span> </span>
<span id="cb286-12"><a href="sect024.html#cb286-12" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="fu">alpha</span>(<span class="st">&quot;white&quot;</span>,<span class="dv">0</span>),  <span class="st">&quot;green&quot;</span>, <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb286-13"><a href="sect024.html#cb286-13" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Bâtiments&quot;</span>,</span>
<span id="cb286-14"><a href="sect024.html#cb286-14" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Transparent (0) : autre que bâtiments&quot;</span>,</span>
<span id="cb286-15"><a href="sect024.html#cb286-15" tabindex="-1"></a>                       <span class="st">&quot;Vert (1) : forte dissimilarité&quot;</span>, </span>
<span id="cb286-16"><a href="sect024.html#cb286-16" tabindex="-1"></a>                       <span class="st">&quot;Gris (2) : faible dissimilarité&quot;</span>),</span>
<span id="cb286-17"><a href="sect024.html#cb286-17" tabindex="-1"></a>            <span class="at">style =</span> <span class="st">&#39;cat&#39;</span>, <span class="at">zindex =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2343ed98042fbf1abbb8" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-2343ed98042fbf1abbb8">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap001",1]},{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"Esri.WorldImagery",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[45.627983010947,-73.6998417458048],[45.6096134260689,-73.6685051154794]],1,null,"tmap001","raster_buildings"]},{"method":"addLegend","args":[{"colors":["#FFFFFF","#00FF00","#BEBEBE"],"labels":["Transparent (0) : autre que bâtiments","Vert (1) : forte dissimilarité","Gris (2) : faible dissimilarité"],"na_color":null,"na_label":"NA","opacity":0,"position":"topright","type":"unknown","title":"Bâtiments","extra":null,"layerId":"legend001","className":"info legend raster_buildings","group":"raster_buildings"}]},{"method":"addLayersControl","args":[["Esri.WorldImagery","OpenStreetMap"],"raster_buildings",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[45.6096134260689,45.627983010947],"lng":[-73.6998417458048,-73.6685051154794]},"fitBounds":[45.6096552357132,-73.6998417458048,45.627983010947,-73.6685183691791,[]]},"evals":[],"jsHooks":[]}</script>
<p>Sur la carte ci-dessus, nous distinguons clairement deux groupes de bâtiments avec une forte hétérogénéité spatiale dans leur environnement immédiat (en vert) : ceux en bordure du quartier résidentiel et ceux situés le long des rangs Saint-Elzéar Est et Haut-Saint-François au nord-ouest. À l’inverse, les bâtiments au cœur du quartier résidentiel de banlieue affichent une faible hétérogénéité spatiale dans leur environnement immédiat (en gris).</p>
<div class="bloc_aller_loin">
<p><strong>Indicateur ELSA sur des données vectorielles</strong></p>
<p>Si les données sont vectorielles et non matricielles, il convient alors d’utiliser la fonction <code>elsa_vector</code> du <em>package</em> <code>geocmeans</code>.</p>
<p><strong>Indicateur ELSA et test d’inférence</strong></p>
<p>Dans les fonctions <code>elsa_raster</code> et <code>elsa_vector</code>, aucun test d’inférence n’est implémenté pour obtenir une valeur de <em>p</em> locale. Toutefois, il est assez facile dans R d’appliquer la méthode par simulation Monte-Carlo décrite dans l’article de Naimi <em>et al.</em> <span class="citation">(<a href="#ref-naimi2019elsa">2019</a>)</span>. Appliquée à des données matricielles, la démarche est la suivante :</p>
<ul>
<li>Créer 999 images dont les valeurs des pixels sont tirées aléatoirement avec remplacement.</li>
<li>Recalculer l’indicateur ELSA pour chaque image.</li>
<li>Pour chaque pixel, compter le nombre de fois où la valeur observée de l’indicateur ELSA est supérieure ou égale à celles des 999 valeurs simulées.</li>
</ul>
<p>La pseudo valeur de <em>p</em> pour chaque pixel <em>i</em> s’écrit alors :</p>
<p><span class="math display" id="eq:PseudoValeurpELSEA">\[\begin{equation}  
  \text{Pseudo valeur de } p_i = (M+1) / (R+1) \text{ avec :}
\tag{2.25}
\end{equation}\]</span> </p>
<p><span class="math inline">\(M\)</span> étant le nombre de fois que la valeur observée est supérieure ou égale à la valeur simulée (<span class="math inline">\(E_i \ge E^*_{ir}\)</span>) <span class="citation">(<a href="#ref-naimi2019elsa">Naimi et al. 2019</a>, pp. 33-35)</span>.</p>
</div>
<p>Appliquons la démarche ci-dessous dans R pour obtenir une pseudo valeur pour l’indicateur ELSA obtenu sur l’image avec un rayon de 100 mètres. Notez que pour améliorer la vitesse de calcul, nous convertissons notre objet <code>terra::rast</code> en une matrice.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="sect024.html#cb287-1" tabindex="-1"></a><span class="do">## Conversion des données matricielles en matrice</span></span>
<span id="cb287-2"><a href="sect024.html#cb287-2" tabindex="-1"></a>base_data <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">values</span>(laval_data, <span class="at">format =</span> <span class="st">&quot;matrice&quot;</span>)</span>
<span id="cb287-3"><a href="sect024.html#cb287-3" tabindex="-1"></a><span class="do">## calcul de la proportion de chaque catégorie</span></span>
<span id="cb287-4"><a href="sect024.html#cb287-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">ncell</span>(base_data)</span>
<span id="cb287-5"><a href="sect024.html#cb287-5" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">table</span>(base_data) <span class="sc">/</span> N</span>
<span id="cb287-6"><a href="sect024.html#cb287-6" tabindex="-1"></a><span class="do">## Conversion de l&#39;indicateur ELSA (à 100 mètres) en matrice</span></span>
<span id="cb287-7"><a href="sect024.html#cb287-7" tabindex="-1"></a>base_elsa <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">values</span>(elsa_100, <span class="at">format =</span> <span class="st">&quot;matrice&quot;</span>)</span>
<span id="cb287-8"><a href="sect024.html#cb287-8" tabindex="-1"></a><span class="do">## Création d&#39;une matrice qui contiendra les pseudo valeurs de p</span></span>
<span id="cb287-9"><a href="sect024.html#cb287-9" tabindex="-1"></a>p_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(base_elsa), <span class="at">ncol =</span> <span class="fu">ncol</span>(base_elsa))</span>
<span id="cb287-10"><a href="sect024.html#cb287-10" tabindex="-1"></a><span class="do">## Lancement des 999 simulations</span></span>
<span id="cb287-11"><a href="sect024.html#cb287-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>){</span>
<span id="cb287-12"><a href="sect024.html#cb287-12" tabindex="-1"></a>  <span class="co"># pour chaque simulation, nous tirons au hasard la valeur de chaque pixel</span></span>
<span id="cb287-13"><a href="sect024.html#cb287-13" tabindex="-1"></a>  sim_values <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">size =</span> N, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> probs[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb287-14"><a href="sect024.html#cb287-14" tabindex="-1"></a>  <span class="co"># Nous enregistrons les valeurs tirées au hasard dans une matrice</span></span>
<span id="cb287-15"><a href="sect024.html#cb287-15" tabindex="-1"></a>  <span class="fu">dim</span>(sim_values) <span class="ot">&lt;-</span> <span class="fu">dim</span>(base_elsa)</span>
<span id="cb287-16"><a href="sect024.html#cb287-16" tabindex="-1"></a>  <span class="co"># Calcul de la valeur de ELSA simulée</span></span>
<span id="cb287-17"><a href="sect024.html#cb287-17" tabindex="-1"></a>  sim_elsa <span class="ot">&lt;-</span> <span class="fu">elsa_raster</span>(sim_values, w100, matrice_dissim)</span>
<span id="cb287-18"><a href="sect024.html#cb287-18" tabindex="-1"></a>  <span class="co"># Comparaison des valeurs indicateur ELSA (valeurs simulées versus observées)</span></span>
<span id="cb287-19"><a href="sect024.html#cb287-19" tabindex="-1"></a>  comp_matrix <span class="ot">&lt;-</span> base_elsa <span class="sc">&gt;=</span> sim_elsa</span>
<span id="cb287-20"><a href="sect024.html#cb287-20" tabindex="-1"></a>  <span class="co"># Ajout à notre matrice des valeurs de p</span></span>
<span id="cb287-21"><a href="sect024.html#cb287-21" tabindex="-1"></a>  p_matrix <span class="ot">&lt;-</span> p_matrix <span class="sc">+</span> comp_matrix</span>
<span id="cb287-22"><a href="sect024.html#cb287-22" tabindex="-1"></a>}</span>
<span id="cb287-23"><a href="sect024.html#cb287-23" tabindex="-1"></a><span class="do">## Conversion des comptages en pseudo valeur de p</span></span>
<span id="cb287-24"><a href="sect024.html#cb287-24" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> p_matrix <span class="sc">/</span> (<span class="dv">999</span><span class="sc">+</span><span class="dv">1</span>)</span></code></pre></div>
<p>Dans la matrice obtenue, les pseudos valeurs de <em>p</em> représentent la probabilité que l’indice de <em>ELSA</em> obtenu sur les données réelles soit inférieur à celui obtenu si les données étaient réparties aléatoirement sur le territoire. Une pseudo valeur de <em>p</em> inférieure à 0,001 signifie donc qu’il n’y aurait que 0,1 % de chance que le hasard produise un patron d’autocorrélation spatiale plus fort que celui observé avec les données initiales.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="sect024.html#cb288-1" tabindex="-1"></a>raster_p_vals <span class="ot">&lt;-</span> laval_data</span>
<span id="cb288-2"><a href="sect024.html#cb288-2" tabindex="-1"></a><span class="fu">values</span>(raster_p_vals) <span class="ot">&lt;-</span> p_values <span class="sc">&lt;=</span> <span class="fl">0.001</span></span>
<span id="cb288-3"><a href="sect024.html#cb288-3" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb288-4"><a href="sect024.html#cb288-4" tabindex="-1"></a></span>
<span id="cb288-5"><a href="sect024.html#cb288-5" tabindex="-1"></a>Carte1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(raster_p_vals) <span class="sc">+</span></span>
<span id="cb288-6"><a href="sect024.html#cb288-6" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb288-7"><a href="sect024.html#cb288-7" tabindex="-1"></a>            <span class="at">style =</span> <span class="st">&#39;cat&#39;</span>,</span>
<span id="cb288-8"><a href="sect024.html#cb288-8" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Significativité&quot;</span>,</span>
<span id="cb288-9"><a href="sect024.html#cb288-9" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Non significatif (p &gt; 0,001)&quot;</span>,</span>
<span id="cb288-10"><a href="sect024.html#cb288-10" tabindex="-1"></a>                       <span class="st">&quot;Significatif (p &lt;= 0,001)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb288-11"><a href="sect024.html#cb288-11" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb288-12"><a href="sect024.html#cb288-12" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb288-13"><a href="sect024.html#cb288-13" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>, <span class="st">&quot;center&quot;</span>))</span>
<span id="cb288-14"><a href="sect024.html#cb288-14" tabindex="-1"></a></span>
<span id="cb288-15"><a href="sect024.html#cb288-15" tabindex="-1"></a>Carte2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(elsa_100) <span class="sc">+</span> </span>
<span id="cb288-16"><a href="sect024.html#cb288-16" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">&quot;RdYlGn&quot;</span>, <span class="at">n =</span> <span class="dv">6</span>, </span>
<span id="cb288-17"><a href="sect024.html#cb288-17" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;ELSA 100 mètres&quot;</span>) <span class="sc">+</span> </span>
<span id="cb288-18"><a href="sect024.html#cb288-18" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb288-19"><a href="sect024.html#cb288-19" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb288-20"><a href="sect024.html#cb288-20" tabindex="-1"></a>            <span class="at">legend.outside.position =</span>  <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>, <span class="st">&quot;center&quot;</span>))</span>
<span id="cb288-21"><a href="sect024.html#cb288-21" tabindex="-1"></a></span>
<span id="cb288-22"><a href="sect024.html#cb288-22" tabindex="-1"></a>Carte3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(laval_data) <span class="sc">+</span> </span>
<span id="cb288-23"><a href="sect024.html#cb288-23" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#fbd4b4&quot;</span>, <span class="st">&quot;#e36c0a&quot;</span>, <span class="st">&quot;#92d050&quot;</span>, <span class="st">&quot;#76923c&quot;</span>),</span>
<span id="cb288-24"><a href="sect024.html#cb288-24" tabindex="-1"></a>            <span class="at">style =</span> <span class="st">&#39;cat&#39;</span>,</span>
<span id="cb288-25"><a href="sect024.html#cb288-25" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Classe (catégorie)&quot;</span>,</span>
<span id="cb288-26"><a href="sect024.html#cb288-26" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1. Minéral bas&quot;</span>,</span>
<span id="cb288-27"><a href="sect024.html#cb288-27" tabindex="-1"></a>                       <span class="st">&quot;2. Minéral haut&quot;</span>,</span>
<span id="cb288-28"><a href="sect024.html#cb288-28" tabindex="-1"></a>                       <span class="st">&quot;3. Végétal bas&quot;</span>,</span>
<span id="cb288-29"><a href="sect024.html#cb288-29" tabindex="-1"></a>                       <span class="st">&quot;4. Végétal haut&quot;</span>))<span class="sc">+</span></span>
<span id="cb288-30"><a href="sect024.html#cb288-30" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb288-31"><a href="sect024.html#cb288-31" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb288-32"><a href="sect024.html#cb288-32" tabindex="-1"></a>            <span class="at">legend.outside.position =</span>  <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>, <span class="st">&quot;center&quot;</span>))</span>
<span id="cb288-33"><a href="sect024.html#cb288-33" tabindex="-1"></a></span>
<span id="cb288-34"><a href="sect024.html#cb288-34" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte3, Carte2, Carte1, <span class="at">ncol=</span><span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:chap02FigureElsaPval"></span>
<img src="GMQ405_files/figure-html/chap02FigureElsaPval-1.png" alt="Cartographie des valeurs de *p* de l'indicateur ELSA" width="100%" />
<p class="caption">
Figure 2.39: Cartographie des valeurs de <em>p</em> de l’indicateur ELSA
</p>
</div>
<p>La figure <a href="sect024.html#fig:chap02FigureElsaPval">2.39</a> montre en rouge les pixels situés dans des secteurs avec une forte autocorrélation spatiale, soit ceux principalement végétalisés ou principalement minéralisés.</p>
</div>
</div>
</div>
<h3>Références</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-anselin1995local" class="csl-entry">
Anselin, Luc. 1995. <span>« Local indicators of spatial association—LISA. »</span> <em>Geographical analysis</em> 27 (2): 93‑115. <a href="https://doi.org/10.1111/j.1538-4632.1995.tb00338.x">https://doi.org/10.1111/j.1538-4632.1995.tb00338.x</a>.
</div>
<div id="ref-anselin1996chapter" class="csl-entry">
———. 1996. <span>« The Moran scatterplot as an ESDA tool to Assess Local Instability in Spatial Association. »</span> In <em>Spatial Analytical Perspectives on GIS</em>, sous la dir. de Manfred M Fischer, 121‑137. Taylor &amp; Francis Group. <a href="https://doi.org/10.1201/9780203739051">https://doi.org/10.1201/9780203739051</a>.
</div>
<div id="ref-anselin2019local" class="csl-entry">
———. 2019. <span>« A local indicator of multivariate spatial association: extending Geary’s C. »</span> <em>Geographical Analysis</em> 51 (2): 133‑150. <a href="https://doi.org/10.1111/gean.12164">https://doi.org/10.1111/gean.12164</a>.
</div>
<div id="ref-anselin2019operational" class="csl-entry">
Anselin, Luc et Xun Li. 2019. <span>« Operational local join count statistics for cluster detection. »</span> <em>Journal of geographical systems</em> 21: 189‑210. <a href="https://doi.org/10.1007/s10109-019-00299-x">https://doi.org/10.1007/s10109-019-00299-x</a>.
</div>
<div id="ref-RBoldAir" class="csl-entry">
Apparicio, Philippe et Jérémy Gelb. 2022. <em>Méthodes quantitatives en sciences sociales : un grand bol d’R</em>. FabriqueREL, Licence CC BY-SA. <a href="https://laeq.github.io/LivreMethoQuantBolR/">https://laeq.github.io/LivreMethoQuantBolR/</a>.
</div>
<div id="ref-bivand2018comparing" class="csl-entry">
Bivand, Roger et David WS Wong. 2018. <span>« Comparing implementations of global and local indicators of spatial association. »</span> <em>Test</em> 27 (3): 716‑748. <a href="https://doi.org/10.1007/s11749-018-0599-x">https://doi.org/10.1007/s11749-018-0599-x</a>.
</div>
<div id="ref-dube2014econometrie" class="csl-entry">
Dubé, Jean et Diègo Legros. 2014. <em>Econom<span>é</span>trie spatiale appliqu<span>é</span>e des microdonn<span>é</span>es</em>. ISTE Group.
</div>
<div id="ref-getis1992analysis" class="csl-entry">
Getis, Arthur et J Keith Ord. 1992. <span>« The analysis of spatial association by use of distance statistics. »</span> <em>Geographical analysis</em> 24 (3): 189‑206. <a href="https://doi.org/10.1111/j.1538-4632.1992.tb00261.x">https://doi.org/10.1111/j.1538-4632.1992.tb00261.x</a>.
</div>
<div id="ref-jombart2008revealing" class="csl-entry">
Jombart, T, S Devillard, Anne-Béatrice Dufour et D Pontier. 2008. <span>« Revealing cryptic spatial patterns in genetic variability by a new multivariate method. »</span> <em>Heredity</em> 101 (1): 92‑103. <a href="https://doi.org/10.1038/hdy.2008.34">https://doi.org/10.1038/hdy.2008.34</a>.
</div>
<div id="ref-naimi2019elsa" class="csl-entry">
Naimi, Babak, Nicholas AS Hamm, Thomas A Groen, Andrew K Skidmore, Albertus G Toxopeus et Sara Alibakhshi. 2019. <span>« ELSA: Entropy-based local indicator of spatial association. »</span> <em>Spatial statistics</em> 29: 66‑88. <a href="https://doi.org/10.1016/j.spasta.2018.10.001">https://doi.org/10.1016/j.spasta.2018.10.001</a>.
</div>
<div id="ref-ord1995local" class="csl-entry">
Ord, J Keith et Arthur Getis. 1995. <span>« Local spatial autocorrelation statistics: distributional issues and an application. »</span> <em>Geographical analysis</em> 27 (4): 286‑306. <a href="https://doi.org/10.1111/j.1538-4632.1995.tb00912.x">https://doi.org/10.1111/j.1538-4632.1995.tb00912.x</a>.
</div>
<div id="ref-sokal1998local" class="csl-entry">
Sokal, Robert R, Neal L Oden et Barbara A Thomson. 1998. <span>« Local spatial autocorrelation in a biological model. »</span> <em>Geographical Analysis</em> 30 (4): 331‑354. <a href="https://doi.org/10.1111/j.1538-4632.1998.tb00406.x">https://doi.org/10.1111/j.1538-4632.1998.tb00406.x</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect023.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect025.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["GMQ405.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
