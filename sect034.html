<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4 Identification des agrégats spatiaux | Notes de cours GMQ405 : Modélisation et analyse spatiale</title>
  <meta name="description" content="Mettre le description du cours." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4 Identification des agrégats spatiaux | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Mettre le description du cours." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4 Identification des agrégats spatiaux | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  
  <meta name="twitter:description" content="Mettre le description du cours." />
  <meta name="twitter:image" content="/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio, département de géomatique appliquée, Université de Sherbrooke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect033.html"/>
<link rel="next" href="sect035.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GMQ405 : modélisation et analyse spatiale</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Comment lire ce manuel?</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en géomatique appliquée et utiliser R?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
</ul></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Manipulation des données spatiales dans R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Importation de données géographiques</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sect011.html"><a href="sect011.html#sect0111"><i class="fa fa-check"></i><b>1.1.1</b> Importation de données vectorielles</a></li>
<li class="chapter" data-level="1.1.2" data-path="sect011.html"><a href="sect011.html#sect0112"><i class="fa fa-check"></i><b>1.1.2</b> Importation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Manipulation de données vectorielles</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Fonctions relatives à la projection cartographique</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Fonctions d’opérations géométriques sur une couche</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect01213"><i class="fa fa-check"></i><b>1.2.3</b> Fonctions d’opérations géométriques entre deux couches</a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#sect0124"><i class="fa fa-check"></i><b>1.2.4</b> Fonctions de mesures géométriques et de récupération des coordonnées géographiques</a></li>
<li class="chapter" data-level="1.2.5" data-path="sect012.html"><a href="sect012.html#sect0125"><i class="fa fa-check"></i><b>1.2.5</b> Jointures spatiales</a></li>
<li class="chapter" data-level="1.2.6" data-path="sect012.html"><a href="sect012.html#sect0126"><i class="fa fa-check"></i><b>1.2.6</b> Requêtes spatiales</a></li>
<li class="chapter" data-level="1.2.7" data-path="sect012.html"><a href="sect012.html#sect0127"><i class="fa fa-check"></i><b>1.2.7</b> Manipulation des données attributaires</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Manipulation de données matricielles (<em>raster</em>)</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> Mosaïquage et découpage d’images</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Requêtes attributaires sur des images</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Exportation de données spatiales de R vers des formats géographiques</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Exportation de données vectorielles <code>sf</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Exportation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect015.html"><a href="sect015.html"><i class="fa fa-check"></i><b>1.5</b> Cartographie avec R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sect015.html"><a href="sect015.html#sect0151"><i class="fa fa-check"></i><b>1.5.1</b> Manipulation des couches géométriques</a></li>
<li class="chapter" data-level="1.5.2" data-path="sect015.html"><a href="sect015.html#sect0152"><i class="fa fa-check"></i><b>1.5.2</b> Cartes interactives</a></li>
<li class="chapter" data-level="1.5.3" data-path="sect015.html"><a href="sect015.html#sect0153"><i class="fa fa-check"></i><b>1.5.3</b> Mise en page d’une carte</a></li>
<li class="chapter" data-level="1.5.4" data-path="sect015.html"><a href="sect015.html#sect0154"><i class="fa fa-check"></i><b>1.5.4</b> Exportation d’une carte</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.6</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="1.7" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.7</b> Exercices de révision</a></li>
</ul></li>
<li class="part"><span><b>II Autocorrélation spatiale</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Autocorrélation spatiale</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion d’autocorrélation spatiale</a></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Matrices de pondération spatiale</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Matrices de contiguïté</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Matrices de proximité spatiale</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Standardisation des matrices de pondération spatiale en ligne</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Construction de matrices de pondération spatiale dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Autocorrélation spatiale globale</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Statistique du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Statistiques de comptage de jointure (<em>Join Count Statistics</em>)</a></li>
<li class="chapter" data-level="2.3.3" data-path="sect023.html"><a href="sect023.html#sect0233"><i class="fa fa-check"></i><b>2.3.3</b> Indice de Lee : autocorrélation spatiale dans un contexte bivarié</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Autocorrélation spatiale locale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#sect0241"><i class="fa fa-check"></i><b>2.4.1</b> Statistiques locales de Getis et Ord : repérer les points chauds et froids pour une variable continue</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#sect0242"><i class="fa fa-check"></i><b>2.4.2</b> Version locale du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#sect0243"><i class="fa fa-check"></i><b>2.4.3</b> Typologie basée sur le diagramme de Moran</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#sect0244"><i class="fa fa-check"></i><b>2.4.4</b> Version locale des statistiques de comptage de jointure (<em>Join Count Statistics</em>)</a></li>
<li class="chapter" data-level="2.4.5" data-path="sect024.html"><a href="sect024.html#sect0245"><i class="fa fa-check"></i><b>2.4.5</b> Version locale de l’indice de Lee</a></li>
<li class="chapter" data-level="2.4.6" data-path="sect024.html"><a href="sect024.html#sect0246"><i class="fa fa-check"></i><b>2.4.6</b> Typologie basée sur le diagramme de Moran dans un contexte bivarié</a></li>
<li class="chapter" data-level="2.4.7" data-path="sect024.html"><a href="sect024.html#sect0247"><i class="fa fa-check"></i><b>2.4.7</b> Autocorrélation locale pour une variable qualitative (catégorielle) : l’indicateur ELSA</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Méthodes de répartition ponctuelle</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Fréquence et densité des points dans l’espace d’étude</a></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Analyse centrographique</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0311"><i class="fa fa-check"></i><b>3.2.1</b> Paramètres de tendance centrale d’un semis de points</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0312"><i class="fa fa-check"></i><b>3.2.2</b> Paramètres de dispersion d’un semis de points</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0313"><i class="fa fa-check"></i><b>3.2.3</b> Mise en œuvre de l’analyse centrographique dans R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Forme d’un semis de points</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Méthode du plus proche voisin</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Méthode des quadrats</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Identification des agrégats spatiaux</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sect034.html"><a href="sect034.html#sect0341"><i class="fa fa-check"></i><b>3.4.1</b> Cartographie de la densité dans une maille irrégulière</a></li>
<li class="chapter" data-level="3.4.2" data-path="sect034.html"><a href="sect034.html#sect0342"><i class="fa fa-check"></i><b>3.4.2</b> Cartographie de la densité dans une maille régulière</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Méthodes de détection d’agrégats spatiaux et spatio-temporels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Agrégats d’entités spatiales ponctuelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sect041.html"><a href="sect041.html#sect0411"><i class="fa fa-check"></i><b>4.1.1</b> DBSCAN : agrégats spatiaux</a></li>
<li class="chapter" data-level="4.1.2" data-path="sect041.html"><a href="sect041.html#sect0412"><i class="fa fa-check"></i><b>4.1.2</b> ST-DBSCAN : agrégats spatio-temporels</a></li>
<li class="chapter" data-level="4.1.3" data-path="sect041.html"><a href="sect041.html#sect0414"><i class="fa fa-check"></i><b>4.1.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Méthodes de balayage de Kulldorff</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Objectifs de la méthode, types d’analyses, de modèles et d’agrégats</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Principes de base de la méthode</a></li>
<li class="chapter" data-level="4.2.3" data-path="sect042.html"><a href="sect042.html#sect043"><i class="fa fa-check"></i><b>4.2.3</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="4.4" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Mesures d’accessibilité spatiale selon les différents de modes de transport</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Notions relatives à l’analyse de réseau</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sect051.html"><a href="sect051.html#sect0511"><i class="fa fa-check"></i><b>5.1.1</b> Définition d’un réseau</a></li>
<li class="chapter" data-level="5.1.2" data-path="sect051.html"><a href="sect051.html#sect0512"><i class="fa fa-check"></i><b>5.1.2</b> Principaux problèmes résolus en analyse de réseau</a></li>
<li class="chapter" data-level="5.1.3" data-path="sect051.html"><a href="sect051.html#sect0513"><i class="fa fa-check"></i><b>5.1.3</b> Analyse de réseau et entités polygonales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Construction d’un réseau avec R5R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sect052.html"><a href="sect052.html#sect0521"><i class="fa fa-check"></i><b>5.2.1</b> Extraction des données spatiales pour R5R</a></li>
<li class="chapter" data-level="5.2.2" data-path="sect052.html"><a href="sect052.html#sect0522"><i class="fa fa-check"></i><b>5.2.2</b> Construction du réseau avec R5R</a></li>
<li class="chapter" data-level="5.2.3" data-path="sect052.html"><a href="sect052.html#sect0523"><i class="fa fa-check"></i><b>5.2.3</b> Calcul d’itinéraires avec R5R selon le mode de transport</a></li>
<li class="chapter" data-level="5.2.4" data-path="sect052.html"><a href="sect052.html#sect0524"><i class="fa fa-check"></i><b>5.2.4</b> Calcul de matrices OD selon différents modes de transport</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mesures d’accessibilité</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sect053.html"><a href="sect053.html#sect0531"><i class="fa fa-check"></i><b>5.3.1</b> Notion d’accessibilité</a></li>
<li class="chapter" data-level="5.3.2" data-path="sect053.html"><a href="sect053.html#sect0532"><i class="fa fa-check"></i><b>5.3.2</b> Accessibilité spatiale potentielle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Mesures d’accessibilité spatiale potentielle dans R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="sect054.html"><a href="sect054.html#sect0541"><i class="fa fa-check"></i><b>5.4.1</b> Accessibilité spatiale potentielle aux supermarchés</a></li>
<li class="chapter" data-level="5.4.2" data-path="sect054.html"><a href="sect054.html#sect0542"><i class="fa fa-check"></i><b>5.4.2</b> Accessibilité spatiale potentielle aux patinoires extérieures</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Analyses d’évènements localisés sur un réseau</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Cartographie de la densité d’évènements sur un réseau</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Explication du NKDE et du TNKDE</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Mesure d’autocorrélation spatiale sur un réseau</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sect063.html"><a href="sect063.html#sect0631"><i class="fa fa-check"></i><b>6.3.1</b> Getis et Ord</a></li>
<li class="chapter" data-level="6.3.2" data-path="sect063.html"><a href="sect063.html#sect0632"><i class="fa fa-check"></i><b>6.3.2</b> Typologie basée sur le diagramme de Moran</a></li>
<li class="chapter" data-level="6.3.3" data-path="sect063.html"><a href="sect063.html#sect0633"><i class="fa fa-check"></i><b>6.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> DBSCAN sur un réseau</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="sect064.html"><a href="sect064.html#sect0641"><i class="fa fa-check"></i><b>6.4.1</b> Explication du NKDE et du TNKDE</a></li>
<li class="chapter" data-level="6.4.2" data-path="sect064.html"><a href="sect064.html#sect0642"><i class="fa fa-check"></i><b>6.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="sect065.html"><a href="sect065.html"><i class="fa fa-check"></i><b>6.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="6.6" data-path="sect066.html"><a href="sect066.html"><i class="fa fa-check"></i><b>6.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Introduction aux modèles de régression spatiale</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Modèles économétriques spatiaux</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sect071.html"><a href="sect071.html#sect0711"><i class="fa fa-check"></i><b>7.1.1</b> Bref retour sur la régression linéaire multiple</a></li>
<li class="chapter" data-level="7.1.2" data-path="sect071.html"><a href="sect071.html#sect0712"><i class="fa fa-check"></i><b>7.1.2</b> Les différents modèles spatiaux autorégressifs</a></li>
<li class="chapter" data-level="7.1.3" data-path="sect071.html"><a href="sect071.html#sect0713"><i class="fa fa-check"></i><b>7.1.3</b> Quel modèle choisir?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Modèles généralisés additifs (GAM) avec une <em>spline</em> bivariée sur les coordonnées géographiques</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Principe de base d’un GAM intégrant l’espace</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Construction d’un modèle GAM dans R</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Régression géographiquement pondérée</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Principe de base</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Construction et analyse du modèle GWR dans R</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Méthodes de classification non supervisée spatiale</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Méthodes de classification non supervisée avec contrainte spatiale</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Algorithmes AZP</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Algorithme SKATER</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Algorithmes REDCAP</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Algorithme du <em>max-p-regions problem</em></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Méthodes de classification non supervisée avec une dimension spatiale</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Classification ascendante hiérarchique spatiale (<em>ClustGeo</em>)</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> <em>Spatial fuzzy c-means</em></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect083.html"><a href="sect083.html"><i class="fa fa-check"></i><b>8.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="8.4" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Méthodes d’interpolation spatiale</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Méthodes déterministes</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Interpolation polynomiale locale</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Interpolation de l’inverse à la distance (<em>IDW</em>)</a></li>
<li class="chapter" data-level="9.1.3" data-path="sect091.html"><a href="sect091.html#sect0913"><i class="fa fa-check"></i><b>9.1.3</b> Fonctions relationnelles</a></li>
<li class="chapter" data-level="9.1.4" data-path="sect091.html"><a href="sect091.html#sect0914"><i class="fa fa-check"></i><b>9.1.4</b> Fonctions conditionnelles</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Méthodes géostatistiques</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> Krigeage simple</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0922"><i class="fa fa-check"></i><b>9.2.2</b> Krigeage universel</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.3</b> Co-krigeage</a></li>
<li class="chapter" data-level="9.2.4" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.4</b> Krigeage résiduel</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Correction des exercices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect1001.html"><a href="sect1001.html"><i class="fa fa-check"></i><b>10.1</b> Exercices du chapitre 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect1001.html"><a href="sect1001.html#sect10011"><i class="fa fa-check"></i><b>10.1.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect1001.html"><a href="sect1001.html#sect10012"><i class="fa fa-check"></i><b>10.1.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="sect1001.html"><a href="sect1001.html#sect10013"><i class="fa fa-check"></i><b>10.1.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="sect1001.html"><a href="sect1001.html#sect10014"><i class="fa fa-check"></i><b>10.1.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect1002.html"><a href="sect1002.html"><i class="fa fa-check"></i><b>10.2</b> Exercices du chapitre 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect1002.html"><a href="sect1002.html#sect10021"><i class="fa fa-check"></i><b>10.2.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect1002.html"><a href="sect1002.html#sect10022"><i class="fa fa-check"></i><b>10.2.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.2.3" data-path="sect1002.html"><a href="sect1002.html#sect10023"><i class="fa fa-check"></i><b>10.2.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.2.4" data-path="sect1002.html"><a href="sect1002.html#sect10024"><i class="fa fa-check"></i><b>10.2.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect1003.html"><a href="sect1003.html"><i class="fa fa-check"></i><b>10.3</b> Exercices du chapitre 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sect1003.html"><a href="sect1003.html#sect10031"><i class="fa fa-check"></i><b>10.3.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="sect1003.html"><a href="sect1003.html#sect10032"><i class="fa fa-check"></i><b>10.3.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.3.3" data-path="sect1003.html"><a href="sect1003.html#sect10033"><i class="fa fa-check"></i><b>10.3.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sect1004.html"><a href="sect1004.html"><i class="fa fa-check"></i><b>10.4</b> Exercices du chapitre 4</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect1004.html"><a href="sect1004.html#sect10041"><i class="fa fa-check"></i><b>10.4.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect1004.html"><a href="sect1004.html#sect10042"><i class="fa fa-check"></i><b>10.4.2</b> Exercice 2</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect1005.html"><a href="sect1005.html"><i class="fa fa-check"></i><b>10.5</b> Exercices du chapitre 5</a></li>
<li class="chapter" data-level="10.6" data-path="sect1006.html"><a href="sect1006.html"><i class="fa fa-check"></i><b>10.6</b> Exercices du chapitre 6</a></li>
<li class="chapter" data-level="10.7" data-path="sect1007.html"><a href="sect1007.html"><i class="fa fa-check"></i><b>10.7</b> Exercices du chapitre 7</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sect1007.html"><a href="sect1007.html#sect10071"><i class="fa fa-check"></i><b>10.7.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.7.2" data-path="sect1007.html"><a href="sect1007.html#sect10072"><i class="fa fa-check"></i><b>10.7.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.7.3" data-path="sect1007.html"><a href="sect1007.html#sect10073"><i class="fa fa-check"></i><b>10.7.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="sect1008.html"><a href="sect1008.html"><i class="fa fa-check"></i><b>10.8</b> Exercices du chapitre 8</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="sect1008.html"><a href="sect1008.html#sect10081"><i class="fa fa-check"></i><b>10.8.1</b> Exercice 1</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="sect1009.html"><a href="sect1009.html"><i class="fa fa-check"></i><b>10.9</b> Exercices du chapitre 9</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours GMQ405 :
Modélisation et analyse spatiale</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect034" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Identification des agrégats spatiaux<a href="sect034.html#sect034" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pour repérer les concentrations d’un semis de points dans une région, il faut cartographier la densité des points dans une maille soit irrégulière, soit régulière.</p>
<div id="sect0341" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Cartographie de la densité dans une maille irrégulière<a href="sect034.html#sect0341" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Une maille irrégulière est habituellement un découpage administratif comme les municipalités régionales de comté (MRC) du Québec ou les arrondissements d’une ville.</p>
<p>À la figure <a href="sect034.html#fig:figDensiteIrreguliere">3.15</a>, nous avons compté le nombre de méfaits par secteurs de recensement pour l’année 2021, puis calculé la densité, soit le nombre de méfaits pour 1000 habitants. Les cercles proportionnels permettent ainsi de repérer les secteurs comprenant le plus de méfaits. Comme la population totale varie d’un SR à l’autre, il est préférable de cartographier la densité, soit le nombre de méfaits pour 1000 habitants. Notez que pour d’autres jeux de données, il serait plus judicieux d’utiliser la superficie comme dénominateur pour calculer la densité (par exemple, le nombre d’arbres au kilomètre carré ou à l’hectare).</p>
<p>En quelques lignes de code, il est très facile de calculer et de cartographier la densité dans un maillage irrégulier.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="sect034.html#cb348-1" tabindex="-1"></a><span class="do">## Secteurs de recensement (SR) de la ville de Sherbrooke en 2021</span></span>
<span id="cb348-2"><a href="sect034.html#cb348-2" tabindex="-1"></a>SR <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/Recen2021Sherbrooke.gpkg&quot;</span>,</span>
<span id="cb348-3"><a href="sect034.html#cb348-3" tabindex="-1"></a>              <span class="at">layer =</span> <span class="st">&quot;DR_SherbSRDonnees2021&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb348-4"><a href="sect034.html#cb348-4" tabindex="-1"></a><span class="do">## Sélection des méfaits pour l&#39;année 2021</span></span>
<span id="cb348-5"><a href="sect034.html#cb348-5" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/IncidentsSecuritePublique.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb348-6"><a href="sect034.html#cb348-6" tabindex="-1"></a>M2021 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Incidents, DESCRIPTIO <span class="sc">==</span> <span class="st">&quot;Méfait&quot;</span> <span class="sc">&amp;</span> ANNEE<span class="sc">==</span><span class="dv">2021</span>)</span>
<span id="cb348-7"><a href="sect034.html#cb348-7" tabindex="-1"></a><span class="do">## Nous nous assurons que les deux couches ont la même projection cartographique</span></span>
<span id="cb348-8"><a href="sect034.html#cb348-8" tabindex="-1"></a>SR <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(SR, <span class="fu">st_crs</span>(M2021))</span>
<span id="cb348-9"><a href="sect034.html#cb348-9" tabindex="-1"></a><span class="do">## Calcul du nombre d&#39;incidents par SR </span></span>
<span id="cb348-10"><a href="sect034.html#cb348-10" tabindex="-1"></a>SR<span class="sc">$</span>Mefaits2021 <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(SR, M2021))</span>
<span id="cb348-11"><a href="sect034.html#cb348-11" tabindex="-1"></a><span class="do">## Calcul du nombre de méfaits pour 1000 habitants</span></span>
<span id="cb348-12"><a href="sect034.html#cb348-12" tabindex="-1"></a>SR<span class="sc">$</span>DensiteM21Hab <span class="ot">&lt;-</span> SR<span class="sc">$</span>Mefaits2021 <span class="sc">/</span> (SR<span class="sc">$</span>SRpop_2021 <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb348-13"><a href="sect034.html#cb348-13" tabindex="-1"></a><span class="do">## Cartographie</span></span>
<span id="cb348-14"><a href="sect034.html#cb348-14" tabindex="-1"></a><span class="fu">tm_shape</span>(SR)<span class="sc">+</span></span>
<span id="cb348-15"><a href="sect034.html#cb348-15" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;Mefaits2021&quot;</span>, <span class="at">style=</span><span class="st">&quot;pretty&quot;</span>, </span>
<span id="cb348-16"><a href="sect034.html#cb348-16" tabindex="-1"></a>              <span class="at">title=</span><span class="st">&quot;Nombre pour 1000 habitants&quot;</span>,</span>
<span id="cb348-17"><a href="sect034.html#cb348-17" tabindex="-1"></a>              <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb348-18"><a href="sect034.html#cb348-18" tabindex="-1"></a>  <span class="fu">tm_bubbles</span>(<span class="at">size =</span> <span class="st">&quot;DensiteM21Hab&quot;</span>, <span class="at">border.col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb348-19"><a href="sect034.html#cb348-19" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;aquamarine3&quot;</span>, <span class="at">title.size =</span> <span class="st">&quot;Nombre&quot;</span>, <span class="at">scale =</span> <span class="fl">1.5</span>)<span class="sc">+</span> </span>
<span id="cb348-20"><a href="sect034.html#cb348-20" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)<span class="sc">+</span><span class="fu">tm_scale_bar</span>(<span class="at">text.size =</span> .<span class="dv">5</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figDensiteIrreguliere"></span>
<img src="GMQ405_files/figure-html/figDensiteIrreguliere-1.png" alt="Densité des méfaits par secteurs de recensement, ville de Sherbrooke, 2021" width="85%" />
<p class="caption">
Figure 3.15: Densité des méfaits par secteurs de recensement, ville de Sherbrooke, 2021
</p>
</div>
</div>
<div id="sect0342" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Cartographie de la densité dans une maille régulière<a href="sect034.html#sect0342" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect03421" class="section level4 hasAnchor" number="3.4.2.1">
<h4><span class="header-section-number">3.4.2.1</span> Notion de processus spatial<a href="sect034.html#sect03421" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Lorsque nous analysons des évènements ayant eu lieu dans un espace donné, nous pouvons considérer que ces évènements résultent d’un processus spatial que nous ne pouvons pas observer. Ce processus spatial est caractérisé par des points chauds (où des évènements se produisent souvent) et des points froids (où des évènements se produisent rarement). Si nous collectons suffisamment d’évènements (observations), alors leur densité devrait nous renseigner sur ce processus spatial. Puisqu’une image vaut mille mots, examinons un exemple d’un processus spatial à la figure <a href="sect034.html#fig:figExempleProcSpat">3.16</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figExempleProcSpat"></span>
<img src="GMQ405_files/figure-html/figExempleProcSpat-1.png" alt="Exemple d'un processus spatial" width="85%" />
<p class="caption">
Figure 3.16: Exemple d’un processus spatial
</p>
</div>
<p>Imaginons que ce processus spatial représente le niveau de risque de se faire attaquer par un écureuil dans un parc urbain délimité ici par les limites de la figure. Dans la réalité, nous ne pouvons pas mesurer directement ce phénomène, mais nous disposons d’un registre des attaques d’écureuils qui ont été enregistrées et spatialisées (figure <a href="sect034.html#fig:figExempleProcSpat2">3.17</a>). Dans un langage plus technique, il est dit que <strong>les évènements sont des réalisations du processus spatial</strong>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figExempleProcSpat2"></span>
<img src="GMQ405_files/figure-html/figExempleProcSpat2-1.png" alt="Réalisations du processus spatial" width="85%" />
<p class="caption">
Figure 3.17: Réalisations du processus spatial
</p>
</div>
<p>Puisque nous disposons d’un grand nombre d’observations, nous pouvons reconstruire le processus spatial qui produit les évènements en appliquant la méthode d’analyse de densité dans une maille régulière (figure <a href="sect034.html#fig:figExempleProcSpat3">3.18</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figExempleProcSpat3"></span>
<img src="GMQ405_files/figure-html/figExempleProcSpat3-1.png" alt="Reconstruction du processus spatial" width="85%" />
<p class="caption">
Figure 3.18: Reconstruction du processus spatial
</p>
</div>
<p>La qualité d’estimation du processus initial dépend ainsi directement du nombre d’évènements dont nous disposons (figure <a href="sect034.html#fig:figExempleProcSpat3">3.18</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figExempleProcSpat4"></span>
<img src="GMQ405_files/figure-html/figExempleProcSpat4-1.png" alt="Reconstruction du processus spatial" width="85%" />
<p class="caption">
Figure 3.19: Reconstruction du processus spatial
</p>
</div>
<p>Une fois que nous sommes en mesure de recréer le processus spatial, nous pouvons en apprendre plus sur le phénomène et ses causes. Par exemple, est-ce que les secteurs du parc avec les plus grande concentration d’accidents sont aussi ceux dans lesquels sont localisés des jeux pour enfants?</p>
</div>
<div id="sect03422" class="section level4 hasAnchor" number="3.4.2.2">
<h4><span class="header-section-number">3.4.2.2</span> Description de la méthode KDE<a href="sect034.html#sect03422" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le principe de base d’une cartographie de la densité dans une maille régulière – appelée aussi carte de chaleur ou estimation de la densité par noyau (<em>kernel density estimation</em> – KDE, en anglais) – est relativement simple et se décompose en trois étapes :</p>
<ol style="list-style-type: decimal">
<li>Juxtaposer une grille de cellules sur l’espace d’étude, soit les pixels d’une image de <em>n</em> mètres de côté (par exemple, 50 mètres).</li>
<li>Pour chaque pixel, juxtaposer une zone de recherche de <em>n</em> mètres de rayon (1000 mètres par exemple) et calculer le nombre de points présents dans cette zone de recherche.</li>
<li>Calculer la densité à partir d’une fonction simple (appelée habituellement fonction uniforme) ou d’une fonction de densité (<em>kernel</em>). Pour une fonction simple, nous divisons simplement le nombre de points présents dans la zone de recherche par la superficie de la zone, soit <span class="math inline">\(πr^2\)</span>; cette approche est toutefois peu recommandée puisqu’elle accorde la même pondération à chaque point situé de la zone d’influence! En utilisant une fonction de densité (<em>kernel</em>) (équation <a href="sect034.html#eq:KernelDensity">(3.30)</a>), nous accordons une pondération à chacun des points compris dans la zone de recherche : plus le point est proche du centre de la cellule, plus son poids est important dans l’estimation de la densité.</li>
</ol>
<p><span class="math display" id="eq:KernelDensity">\[\begin{equation}  
\lambda(s) = \sum_{i=1}^n \frac{1}{\pi r^2} k\biggl(\frac{d_{si}}{r}\biggl)\text{ avec }
\tag{3.30}
\end{equation}\]</span>
</p>
<ul>
<li><span class="math inline">\(\lambda(s)\)</span>, estimation de la densité à la localisation <span class="math inline">\(s\)</span>.</li>
<li><span class="math inline">\(r\)</span>, rayon de la zone de recherche.</li>
<li><span class="math inline">\(d_{is}\)</span>, distance entre la localisation <span class="math inline">\(s\)</span> et le point <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(k\)</span>, fonction <em>kernel</em> définissant la pondération à accorder au ratio <span class="math inline">\(\frac{d_{si}}{r}\)</span> quand <span class="math inline">\(0 &lt; d_{si} \leq r\)</span>. Si <span class="math inline">\(d_{si} &gt; r\)</span>, alors <span class="math inline">\(k(d_{si}/r) = 0\)</span>.</li>
</ul>
<p>Il existe différentes fonctions <em>kernel</em> pour obtenir les pondérations des points. Telle qu’illustrée à la figure <a href="sect034.html#fig:IllustationKernel">3.20</a>, l’idée générale est que plus la distance entre la localisation et le point augmente (<span class="math inline">\(d_{si}\)</span>), plus la pondération <span class="math inline">\(k(d_{si}/r)\)</span> de l’équation <a href="sect034.html#eq:KernelDensity">(3.30)</a> est faible.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:IllustationKernel"></span>
<img src="images/Chap03/IlustratorKernel.png" alt="Principe de la fonction *kernel* pour définir les pondérations des points voisins dans la zone d'influence" width="100%" />
<p class="caption">
Figure 3.20: Principe de la fonction <em>kernel</em> pour définir les pondérations des points voisins dans la zone d’influence
</p>
</div>
<div class="bloc_astuce">
<p><strong>Les différentes fonctions <em>kernel</em> (<em>kernel</em>) d’estimation de la densité</strong></p>
<p>Pour une description des différentes fonctions <em>kernel</em>, <a href="https://fr.wikipedia.org/wiki/Noyau_(statistiques)">consultez le lien suivant</a>. Notez que l’outil <em>Carte de chaleur (estimation par noyau)</em> de QGIS inclut plusieurs fonctions <em>kernel</em> alors que l’outil <em>Kernel Density</em> d’ArcGIS Pro utilise uniquement la fonction quadratique. Finalement, la fonction <code>density.ppp</code> du <em>package</em> <code>spatstat</code> intègre quatre fonctions.</p>
<p><strong>Influence de la forme du noyau (de la fonction <em>kernel</em>)</strong></p>
<p>Excepté la fonction uniforme, la plupart des auteurs s’entendent sur le fait que le choix de fonctions <em>kernel</em> a relativement peu d’influence sur le résultat final comparativement au choix du rayon d’influence.</p>
<table>
<caption>
<span id="tab:TableauFonctionsKernel">Tableau 3.4: </span>Fonctions <em>kernel</em> disponibles selon différents logiciels
</caption>
<thead>
<tr>
<th style="text-align:right;">
Fonction
</th>
<th style="text-align:center;">
QGis
</th>
<th style="text-align:center;">
ArcGIS Pro
</th>
<th style="text-align:center;">
CrimeStat
</th>
<th style="text-align:center;">
R (density.ppp)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
Gaussienne
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
</tr>
<tr>
<td style="text-align:right;">
Triangulaire
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:right;">
Quadratique
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
</tr>
<tr>
<td style="text-align:right;">
Uniforme
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
</tr>
<tr>
<td style="text-align:right;">
Cubique
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:right;">
Epanechnikov
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
</tr>
<tr>
<td style="text-align:right;">
Exponentielle
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sect03423" class="section level4 hasAnchor" number="3.4.2.3">
<h4><span class="header-section-number">3.4.2.3</span> Mise en œuvre du KDE dans R<a href="sect034.html#sect03423" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour calculer la densité dans une maille régulière (KDE), vous pouvez utiliser deux <em>packages</em> :</p>
<ol style="list-style-type: decimal">
<li><code>SpatialKDE</code>, un <em>package</em> proposé récemment qui reprend le code de l’outil <em>Carte de chaleur (estimation par noyau)</em> de QGIS <span class="citation">(<a href="#ref-SpatialKDEPackage">Caha 2023</a>)</span>. Vous obtiendrez donc les mêmes fonctionnalités et résultats qu’avec QGIS. Pour un exemple d’utilisation, consultez <a href="https://cran.r-project.org/web/packages/SpatialKDE/vignettes/SpatialKDE.html">cette vignette</a>.</li>
<li><code>spatstat</code>, soit le <em>package</em> le plus complet pour réaliser des analyses de répartition ponctuelle <span class="citation">(<a href="#ref-spatstatPackage">Baddeley et Turner 2005</a>; <a href="#ref-baddeley2015spatial">Baddeley, Rubak et Turner 2015</a>)</span>. Par conséquent, nous privilégions son utilisation dans les exemples ci-dessous.</li>
</ol>
<p>Afin d’expliquer comment réaliser un KDE dans R, nous utilisons les accidents survenus dans l’arrondissement des Nations de la ville de Sherbrooke. Notez que nous retenons uniquement cet arrondissement et non l’ensemble de la ville afin d’accélérer les temps de calculs.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="sect034.html#cb349-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb349-2"><a href="sect034.html#cb349-2" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb349-3"><a href="sect034.html#cb349-3" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb349-4"><a href="sect034.html#cb349-4" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb349-5"><a href="sect034.html#cb349-5" tabindex="-1"></a><span class="do">## Importation des données </span></span>
<span id="cb349-6"><a href="sect034.html#cb349-6" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/Arrondissements.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb349-7"><a href="sect034.html#cb349-7" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/IncidentsSecuritePublique.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb349-8"><a href="sect034.html#cb349-8" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Arrondissements, <span class="at">crs =</span> <span class="dv">3798</span>) </span>
<span id="cb349-9"><a href="sect034.html#cb349-9" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Incidents, <span class="at">crs =</span> <span class="dv">3798</span>)</span>
<span id="cb349-10"><a href="sect034.html#cb349-10" tabindex="-1"></a><span class="do">## Couche pour les accidents</span></span>
<span id="cb349-11"><a href="sect034.html#cb349-11" tabindex="-1"></a>Accidents <span class="ot">&lt;-</span> <span class="fu">subset</span>(Incidents, Incidents<span class="sc">$</span>DESCRIPTIO <span class="sc">%in%</span> </span>
<span id="cb349-12"><a href="sect034.html#cb349-12" tabindex="-1"></a>                      <span class="fu">c</span>(<span class="st">&quot;Accident avec blessés&quot;</span>, <span class="st">&quot;Accident mortel&quot;</span>))</span>
<span id="cb349-13"><a href="sect034.html#cb349-13" tabindex="-1"></a><span class="do">## Pour accélérer les calculs, nous retenons uniquement l&#39;arrondissement des Nations</span></span>
<span id="cb349-14"><a href="sect034.html#cb349-14" tabindex="-1"></a><span class="co"># Couche pour l&#39;arrondissement des Nations</span></span>
<span id="cb349-15"><a href="sect034.html#cb349-15" tabindex="-1"></a>ArrDesNations <span class="ot">&lt;-</span> <span class="fu">subset</span>(Arrondissements, NOM <span class="sc">==</span> <span class="st">&quot;Arrondissement des Nations&quot;</span>)</span>
<span id="cb349-16"><a href="sect034.html#cb349-16" tabindex="-1"></a><span class="co"># Sélection des accidents localisés dans l&#39;arrondissement des Nations</span></span>
<span id="cb349-17"><a href="sect034.html#cb349-17" tabindex="-1"></a>RequeteSpatiale <span class="ot">&lt;-</span> <span class="fu">st_intersects</span>(Accidents, ArrDesNations, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb349-18"><a href="sect034.html#cb349-18" tabindex="-1"></a>Accidents<span class="sc">$</span>Nations <span class="ot">&lt;-</span> RequeteSpatiale[, <span class="dv">1</span>]</span>
<span id="cb349-19"><a href="sect034.html#cb349-19" tabindex="-1"></a>AccNations <span class="ot">&lt;-</span> <span class="fu">subset</span>(Accidents, Accidents<span class="sc">$</span>Nations <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb349-20"><a href="sect034.html#cb349-20" tabindex="-1"></a><span class="co"># Une couche par année</span></span>
<span id="cb349-21"><a href="sect034.html#cb349-21" tabindex="-1"></a>AccNations2019 <span class="ot">&lt;-</span> <span class="fu">subset</span>(AccNations, AccNations<span class="sc">$</span>AN <span class="sc">==</span> <span class="dv">2019</span>)</span>
<span id="cb349-22"><a href="sect034.html#cb349-22" tabindex="-1"></a>AccNations2020 <span class="ot">&lt;-</span> <span class="fu">subset</span>(AccNations, AccNations<span class="sc">$</span>AN <span class="sc">==</span> <span class="dv">2020</span>)</span>
<span id="cb349-23"><a href="sect034.html#cb349-23" tabindex="-1"></a>AccNations2021 <span class="ot">&lt;-</span> <span class="fu">subset</span>(AccNations, AccNations<span class="sc">$</span>AN <span class="sc">==</span> <span class="dv">2021</span>)</span>
<span id="cb349-24"><a href="sect034.html#cb349-24" tabindex="-1"></a>AccNations2022 <span class="ot">&lt;-</span> <span class="fu">subset</span>(AccNations, AccNations<span class="sc">$</span>AN <span class="sc">==</span> <span class="dv">2022</span>)</span></code></pre></div>
<p>Nous convertissons les points dans le format <code>ppp</code> utilisé par le <em>package</em> <code>spatstat</code>.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="sect034.html#cb350-1" tabindex="-1"></a><span class="do">## Conversion des données sf dans le format de spatstat</span></span>
<span id="cb350-2"><a href="sect034.html#cb350-2" tabindex="-1"></a><span class="co"># la fonction as.owin est utilisée pour définir la fenêtre de travail</span></span>
<span id="cb350-3"><a href="sect034.html#cb350-3" tabindex="-1"></a>fenetre <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(ArrDesNations)</span>
<span id="cb350-4"><a href="sect034.html#cb350-4" tabindex="-1"></a><span class="do">## Conversion des points au format ppp pour les différentes années</span></span>
<span id="cb350-5"><a href="sect034.html#cb350-5" tabindex="-1"></a><span class="co"># 2019 </span></span>
<span id="cb350-6"><a href="sect034.html#cb350-6" tabindex="-1"></a>AccN2019.ppp <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x =</span> <span class="fu">st_coordinates</span>(AccNations2019)[,<span class="dv">1</span>],</span>
<span id="cb350-7"><a href="sect034.html#cb350-7" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">st_coordinates</span>(AccNations2019)[,<span class="dv">2</span>],</span>
<span id="cb350-8"><a href="sect034.html#cb350-8" tabindex="-1"></a>                    <span class="at">window =</span> fenetre, <span class="at">check =</span> T)</span>
<span id="cb350-9"><a href="sect034.html#cb350-9" tabindex="-1"></a><span class="co"># 2020 </span></span>
<span id="cb350-10"><a href="sect034.html#cb350-10" tabindex="-1"></a>AccN2020.ppp <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x =</span> <span class="fu">st_coordinates</span>(AccNations2020)[,<span class="dv">1</span>],</span>
<span id="cb350-11"><a href="sect034.html#cb350-11" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">st_coordinates</span>(AccNations2020)[,<span class="dv">2</span>],</span>
<span id="cb350-12"><a href="sect034.html#cb350-12" tabindex="-1"></a>                    <span class="at">window =</span> fenetre, <span class="at">check =</span> T) </span>
<span id="cb350-13"><a href="sect034.html#cb350-13" tabindex="-1"></a><span class="co"># 2021 </span></span>
<span id="cb350-14"><a href="sect034.html#cb350-14" tabindex="-1"></a>AccN2021.ppp <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x =</span> <span class="fu">st_coordinates</span>(AccNations2021)[,<span class="dv">1</span>],</span>
<span id="cb350-15"><a href="sect034.html#cb350-15" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">st_coordinates</span>(AccNations2021)[,<span class="dv">2</span>],</span>
<span id="cb350-16"><a href="sect034.html#cb350-16" tabindex="-1"></a>                    <span class="at">window =</span> fenetre, <span class="at">check =</span> T)</span>
<span id="cb350-17"><a href="sect034.html#cb350-17" tabindex="-1"></a><span class="co"># 2022</span></span>
<span id="cb350-18"><a href="sect034.html#cb350-18" tabindex="-1"></a>AccN2022.ppp <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x =</span> <span class="fu">st_coordinates</span>(AccNations2022)[,<span class="dv">1</span>],</span>
<span id="cb350-19"><a href="sect034.html#cb350-19" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">st_coordinates</span>(AccNations2022)[,<span class="dv">2</span>],</span>
<span id="cb350-20"><a href="sect034.html#cb350-20" tabindex="-1"></a>                    <span class="at">window =</span> fenetre, <span class="at">check =</span> T)</span></code></pre></div>
<p>Puis, il faut définir la taille des pixels et le rayon d’influence (<em>bandwidth</em> en anglais) :</p>
<ul>
<li>Plus la taille des pixels est réduite, plus la taille de l’image résultante est importante et les calculs longs à réaliser.</li>
<li>Le choix du rayon est aussi délicat. Avec un rayon trop petit, les résultats sont trop détaillés avec des valeurs très faibles. À l’inverse, un rayon trop grand a comme effet de lisser les résultats et de masquer des disparités locales.</li>
</ul>
<div class="bloc_astuce">
<p><strong>Ratio entre la taille du pixel et la taille du rayon d’influence</strong></p>
<p>Assurez-vous que la taille du pixel soit bien inférieure (au moins dix fois plus petite) à celle du rayon d’influence afin d’obtenir des résultats précis. À notre connaissance, il n’existe pas de règle pour optimiser la valeur ratio entre la taille du pixel et la taille du rayon d’influence.</p>
</div>
<p>Plusieurs algorithmes permettant de sélectionner la valeur optimale du rayon d’influence sont implémentés dans le <em>package</em> <code>spatstat</code> avec les fonctions <code>bw.diggle</code>, <code>bw.ppl</code>, <code>bw.scott</code> et <code>bw.CvL</code>. À la lecture des résultats ci-dessous, la valeur du rayon proposée par l’algorithme de Diggle semble bien trop petite et celle du critère de Cronie et van Lieshout bien trop grande. Le rayon optimal est certainement compris entre 700 et 750 mètres. Par conséquent, nous retenons une taille de pixel de 50 mètres et la valeur du rayon optimisée par la fonction <code>bw.ppl</code>.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="sect034.html#cb351-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Diggle :&quot;</span>, <span class="fu">bw.diggle</span>(AccN2020.ppp),</span>
<span id="cb351-2"><a href="sect034.html#cb351-2" tabindex="-1"></a>    <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Maximum de vraissemblance :&quot;</span>, <span class="fu">bw.ppl</span>(AccN2020.ppp),</span>
<span id="cb351-3"><a href="sect034.html#cb351-3" tabindex="-1"></a>    <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Critère de Scott 1 :&quot;</span>, <span class="fu">bw.scott</span>(AccN2020.ppp)[<span class="dv">1</span>],</span>
<span id="cb351-4"><a href="sect034.html#cb351-4" tabindex="-1"></a>    <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Critère  de Scott 2 :&quot;</span>, <span class="fu">bw.scott</span>(AccN2020.ppp)[<span class="dv">2</span>],</span>
<span id="cb351-5"><a href="sect034.html#cb351-5" tabindex="-1"></a>    <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Critère de Cronie et van Lieshout :&quot;</span>, <span class="fu">bw.CvL</span>(AccN2020.ppp))</span></code></pre></div>
<pre><code>## 
## Diggle : 124.196 
## Maximum de vraissemblance : 494.5408 
## Critère de Scott 1 : 971.3489 
## Critère  de Scott 2 : 514.2688 
## Critère de Cronie et van Lieshout : 1644.489</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="sect034.html#cb353-1" tabindex="-1"></a><span class="do">## Taille des pixels et du rayon en mètres</span></span>
<span id="cb353-2"><a href="sect034.html#cb353-2" tabindex="-1"></a>pixel_m <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb353-3"><a href="sect034.html#cb353-3" tabindex="-1"></a>RayonOpt <span class="ot">&lt;-</span> <span class="fu">bw.ppl</span>(AccN2020.ppp)</span></code></pre></div>
<div id="sect034221" class="section level5 hasAnchor" number="3.4.2.3.1">
<h5><span class="header-section-number">3.4.2.3.1</span> Comparaison des fonctions <em>kernel</em><a href="sect034.html#sect034221" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Le paramètre <code>kernel</code> de la fonction <code>density.ppp</code> permet de sélectionner l’une des quatre fonctions <em>kernel</em> (<code>gaussian</code>, <code>quartic</code>, <code>epanechnikov</code> et <code>disc</code>). Pour la dernière, le même poids est attribué aux points compris dans le rayon d’influence; elle correspond ainsi à un <em>kernel</em> uniforme ou simple. Excepté ce dernier <em>kernel</em>, la figure <a href="sect034.html#fig:CartoQuatreKernels">3.21</a> démontre que les résultats sont très semblables d’un <em>kernel</em> à l’autre.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="sect034.html#cb354-1" tabindex="-1"></a><span class="do">## Calcul du KDE avec différentes fonctions kernel</span></span>
<span id="cb354-2"><a href="sect034.html#cb354-2" tabindex="-1"></a><span class="co"># kernel gaussien</span></span>
<span id="cb354-3"><a href="sect034.html#cb354-3" tabindex="-1"></a>kdeG <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2020.ppp, <span class="at">sigma=</span>RayonOpt, <span class="at">eps=</span>pixel_m, <span class="at">kernel=</span><span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb354-4"><a href="sect034.html#cb354-4" tabindex="-1"></a><span class="co"># kernel quadratique</span></span>
<span id="cb354-5"><a href="sect034.html#cb354-5" tabindex="-1"></a>kdeQ <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2020.ppp, <span class="at">sigma=</span>RayonOpt, <span class="at">eps=</span>pixel_m, <span class="at">kernel=</span><span class="st">&quot;quartic&quot;</span>)</span>
<span id="cb354-6"><a href="sect034.html#cb354-6" tabindex="-1"></a><span class="co"># kernel Epanechnikov</span></span>
<span id="cb354-7"><a href="sect034.html#cb354-7" tabindex="-1"></a>kdeE <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2020.ppp, <span class="at">sigma=</span>RayonOpt, <span class="at">eps=</span>pixel_m, <span class="at">kernel=</span><span class="st">&quot;epanechnikov&quot;</span>)</span>
<span id="cb354-8"><a href="sect034.html#cb354-8" tabindex="-1"></a><span class="co"># kernel disc (uniforme ou simple)</span></span>
<span id="cb354-9"><a href="sect034.html#cb354-9" tabindex="-1"></a><span class="co"># le même poids est accordé à chaque point dans le rayon</span></span>
<span id="cb354-10"><a href="sect034.html#cb354-10" tabindex="-1"></a>kdeD <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2020.ppp, <span class="at">sigma=</span>RayonOpt, <span class="at">eps=</span>pixel_m, <span class="at">kernel=</span><span class="st">&quot;disc&quot;</span>)</span>
<span id="cb354-11"><a href="sect034.html#cb354-11" tabindex="-1"></a><span class="do">## Conversion en raster </span></span>
<span id="cb354-12"><a href="sect034.html#cb354-12" tabindex="-1"></a><span class="co"># étant donné que les valeurs sont exprimées en nombre de points par m2,</span></span>
<span id="cb354-13"><a href="sect034.html#cb354-13" tabindex="-1"></a><span class="co"># nous les multiplions par 1 000 000 pour obtenir une densité au km2.</span></span>
<span id="cb354-14"><a href="sect034.html#cb354-14" tabindex="-1"></a>RkdeG <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kdeG)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb354-15"><a href="sect034.html#cb354-15" tabindex="-1"></a>RkdeQ <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kdeQ)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb354-16"><a href="sect034.html#cb354-16" tabindex="-1"></a>RkdeE <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kdeE)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb354-17"><a href="sect034.html#cb354-17" tabindex="-1"></a>RkdeD <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kdeD)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb354-18"><a href="sect034.html#cb354-18" tabindex="-1"></a><span class="do">## Projection cartographique</span></span>
<span id="cb354-19"><a href="sect034.html#cb354-19" tabindex="-1"></a><span class="fu">crs</span>(RkdeG) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3798&quot;</span></span>
<span id="cb354-20"><a href="sect034.html#cb354-20" tabindex="-1"></a><span class="fu">crs</span>(RkdeQ) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3798&quot;</span> </span>
<span id="cb354-21"><a href="sect034.html#cb354-21" tabindex="-1"></a><span class="fu">crs</span>(RkdeE) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3798&quot;</span> </span>
<span id="cb354-22"><a href="sect034.html#cb354-22" tabindex="-1"></a><span class="fu">crs</span>(RkdeD) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3798&quot;</span></span>
<span id="cb354-23"><a href="sect034.html#cb354-23" tabindex="-1"></a><span class="do">## Visualisation des résultats</span></span>
<span id="cb354-24"><a href="sect034.html#cb354-24" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb354-25"><a href="sect034.html#cb354-25" tabindex="-1"></a>Carte1 <span class="ot">&lt;-</span></span>
<span id="cb354-26"><a href="sect034.html#cb354-26" tabindex="-1"></a>  <span class="fu">tm_shape</span>(RkdeG) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Gaussien&quot;</span>)<span class="sc">+</span></span>
<span id="cb354-27"><a href="sect034.html#cb354-27" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2020) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb354-28"><a href="sect034.html#cb354-28" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb354-29"><a href="sect034.html#cb354-29" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb354-30"><a href="sect034.html#cb354-30" tabindex="-1"></a>Carte2 <span class="ot">&lt;-</span></span>
<span id="cb354-31"><a href="sect034.html#cb354-31" tabindex="-1"></a>  <span class="fu">tm_shape</span>(RkdeQ) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Quadratique&quot;</span>)<span class="sc">+</span></span>
<span id="cb354-32"><a href="sect034.html#cb354-32" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2020) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb354-33"><a href="sect034.html#cb354-33" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb354-34"><a href="sect034.html#cb354-34" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb354-35"><a href="sect034.html#cb354-35" tabindex="-1"></a>Carte3 <span class="ot">&lt;-</span></span>
<span id="cb354-36"><a href="sect034.html#cb354-36" tabindex="-1"></a>  <span class="fu">tm_shape</span>(RkdeE) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Epanechnikov&quot;</span>)<span class="sc">+</span></span>
<span id="cb354-37"><a href="sect034.html#cb354-37" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2020) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb354-38"><a href="sect034.html#cb354-38" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb354-39"><a href="sect034.html#cb354-39" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb354-40"><a href="sect034.html#cb354-40" tabindex="-1"></a>Carte4 <span class="ot">&lt;-</span></span>
<span id="cb354-41"><a href="sect034.html#cb354-41" tabindex="-1"></a>  <span class="fu">tm_shape</span>(RkdeD) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Uniforme&quot;</span>)<span class="sc">+</span></span>
<span id="cb354-42"><a href="sect034.html#cb354-42" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2020) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb354-43"><a href="sect034.html#cb354-43" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb354-44"><a href="sect034.html#cb354-44" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">breaks  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>))<span class="sc">+</span><span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb354-45"><a href="sect034.html#cb354-45" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte1, Carte2, Carte3, Carte4,</span>
<span id="cb354-46"><a href="sect034.html#cb354-46" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CartoQuatreKernels"></span>
<img src="GMQ405_files/figure-html/CartoQuatreKernels-1.png" alt="Comparaison des résultats du KDE pour différents kernels" width="85%" />
<p class="caption">
Figure 3.21: Comparaison des résultats du KDE pour différents kernels
</p>
</div>
</div>
<div id="sect034222" class="section level5 hasAnchor" number="3.4.2.3.2">
<h5><span class="header-section-number">3.4.2.3.2</span> Évaluation de l’impact du rayon d’influence<a href="sect034.html#sect034222" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Le code R permet de réaliser des KDE avec des rayons de 250, 500, 750 et 1000 mètres. La figure <a href="sect034.html#fig:CartoQuatreKernels">3.21</a> démontre bien que plus le rayon est grand, plus la carte est lissée.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="sect034.html#cb355-1" tabindex="-1"></a>kdeQ250  <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2020.ppp, <span class="at">sigma=</span><span class="dv">250</span>,  <span class="at">eps=</span><span class="dv">50</span>, <span class="at">kernel=</span><span class="st">&quot;quartic&quot;</span>)</span>
<span id="cb355-2"><a href="sect034.html#cb355-2" tabindex="-1"></a>kdeQ500  <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2020.ppp, <span class="at">sigma=</span><span class="dv">500</span>,  <span class="at">eps=</span><span class="dv">50</span>, <span class="at">kernel=</span><span class="st">&quot;quartic&quot;</span>)</span>
<span id="cb355-3"><a href="sect034.html#cb355-3" tabindex="-1"></a>kdeQ750  <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2020.ppp, <span class="at">sigma=</span><span class="dv">750</span>,  <span class="at">eps=</span><span class="dv">50</span>, <span class="at">kernel=</span><span class="st">&quot;quartic&quot;</span>)</span>
<span id="cb355-4"><a href="sect034.html#cb355-4" tabindex="-1"></a>kdeQ1000 <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2020.ppp, <span class="at">sigma=</span><span class="dv">1000</span>, <span class="at">eps=</span><span class="dv">50</span>, <span class="at">kernel=</span><span class="st">&quot;quartic&quot;</span>)</span>
<span id="cb355-5"><a href="sect034.html#cb355-5" tabindex="-1"></a>RkdeQ250  <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kdeQ250)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb355-6"><a href="sect034.html#cb355-6" tabindex="-1"></a>RkdeQ500  <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kdeQ500)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb355-7"><a href="sect034.html#cb355-7" tabindex="-1"></a>RkdeQ750  <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kdeQ750)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb355-8"><a href="sect034.html#cb355-8" tabindex="-1"></a>RkdeQ1000 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kdeQ1000)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb355-9"><a href="sect034.html#cb355-9" tabindex="-1"></a><span class="fu">crs</span>(RkdeQ250) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3857&quot;</span></span>
<span id="cb355-10"><a href="sect034.html#cb355-10" tabindex="-1"></a><span class="fu">crs</span>(RkdeQ500) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3857&quot;</span> </span>
<span id="cb355-11"><a href="sect034.html#cb355-11" tabindex="-1"></a><span class="fu">crs</span>(RkdeQ750) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3857&quot;</span> </span>
<span id="cb355-12"><a href="sect034.html#cb355-12" tabindex="-1"></a><span class="fu">crs</span>(RkdeQ1000) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3857&quot;</span></span>
<span id="cb355-13"><a href="sect034.html#cb355-13" tabindex="-1"></a><span class="do">## Visualisation des résultats</span></span>
<span id="cb355-14"><a href="sect034.html#cb355-14" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb355-15"><a href="sect034.html#cb355-15" tabindex="-1"></a>Carte1 <span class="ot">&lt;-</span></span>
<span id="cb355-16"><a href="sect034.html#cb355-16" tabindex="-1"></a>  <span class="fu">tm_shape</span>(RkdeQ250) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;r = 250 m&quot;</span>)<span class="sc">+</span></span>
<span id="cb355-17"><a href="sect034.html#cb355-17" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2020) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb355-18"><a href="sect034.html#cb355-18" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb355-19"><a href="sect034.html#cb355-19" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb355-20"><a href="sect034.html#cb355-20" tabindex="-1"></a>Carte2 <span class="ot">&lt;-</span></span>
<span id="cb355-21"><a href="sect034.html#cb355-21" tabindex="-1"></a>  <span class="fu">tm_shape</span>(RkdeQ500) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;r = 500 m&quot;</span>)<span class="sc">+</span></span>
<span id="cb355-22"><a href="sect034.html#cb355-22" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2020) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb355-23"><a href="sect034.html#cb355-23" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb355-24"><a href="sect034.html#cb355-24" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb355-25"><a href="sect034.html#cb355-25" tabindex="-1"></a>Carte3 <span class="ot">&lt;-</span></span>
<span id="cb355-26"><a href="sect034.html#cb355-26" tabindex="-1"></a>  <span class="fu">tm_shape</span>(RkdeQ750) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;r = 750 m&quot;</span>)<span class="sc">+</span></span>
<span id="cb355-27"><a href="sect034.html#cb355-27" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2020) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb355-28"><a href="sect034.html#cb355-28" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb355-29"><a href="sect034.html#cb355-29" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb355-30"><a href="sect034.html#cb355-30" tabindex="-1"></a>Carte4 <span class="ot">&lt;-</span></span>
<span id="cb355-31"><a href="sect034.html#cb355-31" tabindex="-1"></a>  <span class="fu">tm_shape</span>(RkdeQ1000) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;r = 1000 m&quot;</span>)<span class="sc">+</span></span>
<span id="cb355-32"><a href="sect034.html#cb355-32" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2020) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb355-33"><a href="sect034.html#cb355-33" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb355-34"><a href="sect034.html#cb355-34" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">breaks  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>))<span class="sc">+</span><span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb355-35"><a href="sect034.html#cb355-35" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte1, Carte2, Carte3, Carte4,</span>
<span id="cb355-36"><a href="sect034.html#cb355-36" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CartoDistKernels"></span>
<img src="GMQ405_files/figure-html/CartoDistKernels-1.png" alt="Comparaison des résultats du KDE selon le rayon d'influence" width="85%" />
<p class="caption">
Figure 3.22: Comparaison des résultats du KDE selon le rayon d’influence
</p>
</div>
</div>
<div id="sect034223" class="section level5 hasAnchor" number="3.4.2.3.3">
<h5><span class="header-section-number">3.4.2.3.3</span> Comparaison entre différentes années<a href="sect034.html#sect034223" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Bien entendu, pour un même jeu de données, il est possible de représenter la densité pour différentes années (figure <a href="sect034.html#fig:CartoTemporelleKernels">3.23</a>).</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="sect034.html#cb356-1" tabindex="-1"></a>kde2019 <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2019.ppp, <span class="at">sigma=</span><span class="dv">500</span>, <span class="at">eps=</span><span class="dv">50</span>, <span class="at">kernel=</span><span class="st">&quot;quartic&quot;</span>)</span>
<span id="cb356-2"><a href="sect034.html#cb356-2" tabindex="-1"></a>kde2020 <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2020.ppp, <span class="at">sigma=</span><span class="dv">500</span>, <span class="at">eps=</span><span class="dv">50</span>, <span class="at">kernel=</span><span class="st">&quot;quartic&quot;</span>)</span>
<span id="cb356-3"><a href="sect034.html#cb356-3" tabindex="-1"></a>kde2021 <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2021.ppp, <span class="at">sigma=</span><span class="dv">500</span>, <span class="at">eps=</span><span class="dv">50</span>, <span class="at">kernel=</span><span class="st">&quot;quartic&quot;</span>)</span>
<span id="cb356-4"><a href="sect034.html#cb356-4" tabindex="-1"></a>kde2022 <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(AccN2022.ppp, <span class="at">sigma=</span><span class="dv">500</span>, <span class="at">eps=</span><span class="dv">50</span>, <span class="at">kernel=</span><span class="st">&quot;quartic&quot;</span>)</span>
<span id="cb356-5"><a href="sect034.html#cb356-5" tabindex="-1"></a>Rkde2019 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kde2019)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb356-6"><a href="sect034.html#cb356-6" tabindex="-1"></a>Rkde2020 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kde2020)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb356-7"><a href="sect034.html#cb356-7" tabindex="-1"></a>Rkde2021 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kde2020)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb356-8"><a href="sect034.html#cb356-8" tabindex="-1"></a>Rkde2022 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kde2021)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb356-9"><a href="sect034.html#cb356-9" tabindex="-1"></a><span class="fu">crs</span>(Rkde2019) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3798&quot;</span></span>
<span id="cb356-10"><a href="sect034.html#cb356-10" tabindex="-1"></a><span class="fu">crs</span>(Rkde2020) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3798&quot;</span> </span>
<span id="cb356-11"><a href="sect034.html#cb356-11" tabindex="-1"></a><span class="fu">crs</span>(Rkde2021) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3798&quot;</span> </span>
<span id="cb356-12"><a href="sect034.html#cb356-12" tabindex="-1"></a><span class="fu">crs</span>(Rkde2022) <span class="ot">&lt;-</span> <span class="st">&quot;epsg:3798&quot;</span></span>
<span id="cb356-13"><a href="sect034.html#cb356-13" tabindex="-1"></a></span>
<span id="cb356-14"><a href="sect034.html#cb356-14" tabindex="-1"></a>Carte1 <span class="ot">&lt;-</span></span>
<span id="cb356-15"><a href="sect034.html#cb356-15" tabindex="-1"></a>  <span class="fu">tm_shape</span>(Rkde2019) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;2019&quot;</span>)<span class="sc">+</span></span>
<span id="cb356-16"><a href="sect034.html#cb356-16" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2019) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb356-17"><a href="sect034.html#cb356-17" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb356-18"><a href="sect034.html#cb356-18" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb356-19"><a href="sect034.html#cb356-19" tabindex="-1"></a>Carte2 <span class="ot">&lt;-</span></span>
<span id="cb356-20"><a href="sect034.html#cb356-20" tabindex="-1"></a>  <span class="fu">tm_shape</span>(Rkde2020) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;2021&quot;</span>)<span class="sc">+</span></span>
<span id="cb356-21"><a href="sect034.html#cb356-21" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2020) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb356-22"><a href="sect034.html#cb356-22" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb356-23"><a href="sect034.html#cb356-23" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb356-24"><a href="sect034.html#cb356-24" tabindex="-1"></a>Carte3 <span class="ot">&lt;-</span></span>
<span id="cb356-25"><a href="sect034.html#cb356-25" tabindex="-1"></a>  <span class="fu">tm_shape</span>(Rkde2021) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;2022&quot;</span>)<span class="sc">+</span></span>
<span id="cb356-26"><a href="sect034.html#cb356-26" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2021) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb356-27"><a href="sect034.html#cb356-27" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb356-28"><a href="sect034.html#cb356-28" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb356-29"><a href="sect034.html#cb356-29" tabindex="-1"></a>Carte4 <span class="ot">&lt;-</span></span>
<span id="cb356-30"><a href="sect034.html#cb356-30" tabindex="-1"></a>  <span class="fu">tm_shape</span>(Rkde2022) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">title =</span> <span class="st">&quot;2023&quot;</span>)<span class="sc">+</span></span>
<span id="cb356-31"><a href="sect034.html#cb356-31" tabindex="-1"></a>  <span class="fu">tm_shape</span>(AccNations2022) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb356-32"><a href="sect034.html#cb356-32" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ArrDesNations) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb356-33"><a href="sect034.html#cb356-33" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">breaks  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>))<span class="sc">+</span><span class="fu">tm_layout</span>(<span class="at">frame =</span> F)</span>
<span id="cb356-34"><a href="sect034.html#cb356-34" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte1, Carte2, Carte3, Carte4,</span>
<span id="cb356-35"><a href="sect034.html#cb356-35" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CartoTemporelleKernels"></span>
<img src="GMQ405_files/figure-html/CartoTemporelleKernels-1.png" alt="Comparaison des résultats du KDE pour différentes années" width="85%" />
<p class="caption">
Figure 3.23: Comparaison des résultats du KDE pour différentes années
</p>
</div>
</div>
</div>
</div>
</div>
<h3>Références</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-baddeley2015spatial" class="csl-entry">
Baddeley, Adrian, Ege Rubak et Rolf Turner. 2015. <em>Spatial point patterns: methodology and applications with R</em>. CRC press.
</div>
<div id="ref-spatstatPackage" class="csl-entry">
Baddeley, Adrian et Rolf Turner. 2005. <span>« <span>spatstat</span>: An <span>R</span> Package for Analyzing Spatial Point Patterns. »</span> <em>Journal of Statistical Software</em> 12 (6): 1‑42. <a href="https://doi.org/10.18637/jss.v012.i06">https://doi.org/10.18637/jss.v012.i06</a>.
</div>
<div id="ref-SpatialKDEPackage" class="csl-entry">
Caha, Jan. 2023. <em>SpatialKDE: Kernel Density Estimation for Spatial Data</em>. s.n. <a href="https://CRAN.R-project.org/package=SpatialKDE">https://CRAN.R-project.org/package=SpatialKDE</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect033.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect035.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["GMQ405.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
