<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.2 Manipulation de données vectorielles | Notes de cours GMQ405 : Modélisation et analyse spatiale</title>
  <meta name="description" content="Mettre le description du cours." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="1.2 Manipulation de données vectorielles | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Mettre le description du cours." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.2 Manipulation de données vectorielles | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  
  <meta name="twitter:description" content="Mettre le description du cours." />
  <meta name="twitter:image" content="/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio, département de géomatique appliquée, Université de Sherbrooke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect011.html"/>
<link rel="next" href="sect013.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GMQ405 : modélisation et analyse spatiale</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Comment lire ce manuel?</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en géomatique appliquée et utiliser R?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
</ul></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Manipulation des données spatiales dans R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Importation de données géographiques</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sect011.html"><a href="sect011.html#sect0111"><i class="fa fa-check"></i><b>1.1.1</b> Importation de données vectorielles</a></li>
<li class="chapter" data-level="1.1.2" data-path="sect011.html"><a href="sect011.html#sect0112"><i class="fa fa-check"></i><b>1.1.2</b> Importation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Manipulation de données vectorielles</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Fonctions relatives à la projection cartographique</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Fonctions d’opérations géométriques sur une couche</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect01213"><i class="fa fa-check"></i><b>1.2.3</b> Fonctions d’opérations géométriques entre deux couches</a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#sect0124"><i class="fa fa-check"></i><b>1.2.4</b> Fonctions de mesures géométriques et de récupération des coordonnées géographiques</a></li>
<li class="chapter" data-level="1.2.5" data-path="sect012.html"><a href="sect012.html#sect0125"><i class="fa fa-check"></i><b>1.2.5</b> Jointures spatiales</a></li>
<li class="chapter" data-level="1.2.6" data-path="sect012.html"><a href="sect012.html#sect0126"><i class="fa fa-check"></i><b>1.2.6</b> Requêtes spatiales</a></li>
<li class="chapter" data-level="1.2.7" data-path="sect012.html"><a href="sect012.html#sect0127"><i class="fa fa-check"></i><b>1.2.7</b> Manipulation des données attributaires</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Manipulation de données matricielles (<em>raster</em>)</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> Mosaïquage et découpage d’images</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Requêtes attributaires sur des images</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Exportation de données spatiales de R vers des formats géographiques</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Exportation de données vectorielles <code>sf</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Exportation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect015.html"><a href="sect015.html"><i class="fa fa-check"></i><b>1.5</b> Cartographie avec R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sect015.html"><a href="sect015.html#sect0151"><i class="fa fa-check"></i><b>1.5.1</b> Manipulation des couches géométriques</a></li>
<li class="chapter" data-level="1.5.2" data-path="sect015.html"><a href="sect015.html#sect0152"><i class="fa fa-check"></i><b>1.5.2</b> Cartes interactives</a></li>
<li class="chapter" data-level="1.5.3" data-path="sect015.html"><a href="sect015.html#sect0153"><i class="fa fa-check"></i><b>1.5.3</b> Mise en page d’une carte</a></li>
<li class="chapter" data-level="1.5.4" data-path="sect015.html"><a href="sect015.html#sect0154"><i class="fa fa-check"></i><b>1.5.4</b> Exportation d’une carte</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.6</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="1.7" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.7</b> Exercices de révision</a></li>
</ul></li>
<li class="part"><span><b>II Autocorrélation spatiale</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Autocorrélation spatiale</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion d’autocorrélation spatiale</a></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Matrices de pondération spatiale</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Matrices de contiguïté</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Matrices de proximité spatiale</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Standardisation des matrices de pondération spatiale en ligne</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Construction de matrices de pondération spatiale dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Autocorrélation spatiale globale</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Statistique du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Statistiques de comptage de jointure (<em>Join Count Statistics</em>)</a></li>
<li class="chapter" data-level="2.3.3" data-path="sect023.html"><a href="sect023.html#sect0233"><i class="fa fa-check"></i><b>2.3.3</b> Indice de Lee : autocorrélation spatiale dans un contexte bivarié</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Autocorrélation spatiale locale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#sect0241"><i class="fa fa-check"></i><b>2.4.1</b> Statistiques locales de Getis et Ord : repérer les points chauds et froids pour une variable continue</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#sect0242"><i class="fa fa-check"></i><b>2.4.2</b> Version locale du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#sect0243"><i class="fa fa-check"></i><b>2.4.3</b> Typologie basée sur le diagramme de Moran</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#sect0244"><i class="fa fa-check"></i><b>2.4.4</b> Version locale des statistiques de comptage de jointure (<em>Join Count Statistics</em>)</a></li>
<li class="chapter" data-level="2.4.5" data-path="sect024.html"><a href="sect024.html#sect0245"><i class="fa fa-check"></i><b>2.4.5</b> Version locale de l’indice de Lee</a></li>
<li class="chapter" data-level="2.4.6" data-path="sect024.html"><a href="sect024.html#sect0246"><i class="fa fa-check"></i><b>2.4.6</b> Typologie basée sur le diagramme de Moran dans un contexte bivarié</a></li>
<li class="chapter" data-level="2.4.7" data-path="sect024.html"><a href="sect024.html#sect0247"><i class="fa fa-check"></i><b>2.4.7</b> Autocorrélation locale pour une variable qualitative (catégorielle) : l’indicateur ELSA</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Méthodes de répartition ponctuelle</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Fréquence et densité des points dans l’espace d’étude</a></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Analyse centrographique</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0311"><i class="fa fa-check"></i><b>3.2.1</b> Paramètres de tendance centrale d’un semis de points</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0312"><i class="fa fa-check"></i><b>3.2.2</b> Paramètres de dispersion d’un semis de points</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0313"><i class="fa fa-check"></i><b>3.2.3</b> Mise en œuvre de l’analyse centrographique dans R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Forme d’un semis de points</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Méthode du plus proche voisin</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Méthode des quadrats</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Identification des agrégats spatiaux</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sect034.html"><a href="sect034.html#sect0341"><i class="fa fa-check"></i><b>3.4.1</b> Cartographie de la densité dans une maille irrégulière</a></li>
<li class="chapter" data-level="3.4.2" data-path="sect034.html"><a href="sect034.html#sect0342"><i class="fa fa-check"></i><b>3.4.2</b> Cartographie de la densité dans une maille régulière</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Méthodes de détection d’agrégats spatiaux et spatio-temporels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Agrégats d’entités spatiales ponctuelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sect041.html"><a href="sect041.html#sect0411"><i class="fa fa-check"></i><b>4.1.1</b> DBSCAN : agrégats spatiaux</a></li>
<li class="chapter" data-level="4.1.2" data-path="sect041.html"><a href="sect041.html#sect0412"><i class="fa fa-check"></i><b>4.1.2</b> ST-DBSCAN : agrégats spatio-temporels</a></li>
<li class="chapter" data-level="4.1.3" data-path="sect041.html"><a href="sect041.html#sect0414"><i class="fa fa-check"></i><b>4.1.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Méthodes de balayage de Kulldorff</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Objectifs de la méthode, types d’analyses, de modèles et d’agrégats</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Principes de base de la méthode</a></li>
<li class="chapter" data-level="4.2.3" data-path="sect042.html"><a href="sect042.html#sect043"><i class="fa fa-check"></i><b>4.2.3</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="4.4" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Mesures d’accessibilité spatiale selon les différents de modes de transport</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Notions relatives à l’analyse de réseau</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sect051.html"><a href="sect051.html#sect0511"><i class="fa fa-check"></i><b>5.1.1</b> Définition d’un réseau</a></li>
<li class="chapter" data-level="5.1.2" data-path="sect051.html"><a href="sect051.html#sect0512"><i class="fa fa-check"></i><b>5.1.2</b> Principaux problèmes résolus en analyse de réseau</a></li>
<li class="chapter" data-level="5.1.3" data-path="sect051.html"><a href="sect051.html#sect0513"><i class="fa fa-check"></i><b>5.1.3</b> Analyse de réseau et entités polygonales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Construction d’un réseau avec R5R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sect052.html"><a href="sect052.html#sect0521"><i class="fa fa-check"></i><b>5.2.1</b> Extraction des données spatiales pour R5R</a></li>
<li class="chapter" data-level="5.2.2" data-path="sect052.html"><a href="sect052.html#sect0522"><i class="fa fa-check"></i><b>5.2.2</b> Construction du réseau avec R5R</a></li>
<li class="chapter" data-level="5.2.3" data-path="sect052.html"><a href="sect052.html#sect0523"><i class="fa fa-check"></i><b>5.2.3</b> Calcul d’itinéraires avec R5R selon le mode de transport</a></li>
<li class="chapter" data-level="5.2.4" data-path="sect052.html"><a href="sect052.html#sect0524"><i class="fa fa-check"></i><b>5.2.4</b> Calcul de matrices OD selon différents modes de transport</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mesures d’accessibilité</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sect053.html"><a href="sect053.html#sect0531"><i class="fa fa-check"></i><b>5.3.1</b> Notion d’accessibilité</a></li>
<li class="chapter" data-level="5.3.2" data-path="sect053.html"><a href="sect053.html#sect0532"><i class="fa fa-check"></i><b>5.3.2</b> Accessibilité spatiale potentielle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Mesures d’accessibilité spatiale potentielle dans R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="sect054.html"><a href="sect054.html#sect0541"><i class="fa fa-check"></i><b>5.4.1</b> Accessibilité spatiale potentielle aux supermarchés</a></li>
<li class="chapter" data-level="5.4.2" data-path="sect054.html"><a href="sect054.html#sect0542"><i class="fa fa-check"></i><b>5.4.2</b> Accessibilité spatiale potentielle aux patinoires extérieures</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Analyses d’évènements localisés sur un réseau</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Cartographie de la densité d’évènements sur un réseau</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Explication du NKDE et du TNKDE</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Mesure d’autocorrélation spatiale sur un réseau</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sect063.html"><a href="sect063.html#sect0631"><i class="fa fa-check"></i><b>6.3.1</b> Getis et Ord</a></li>
<li class="chapter" data-level="6.3.2" data-path="sect063.html"><a href="sect063.html#sect0632"><i class="fa fa-check"></i><b>6.3.2</b> Typologie basée sur le diagramme de Moran</a></li>
<li class="chapter" data-level="6.3.3" data-path="sect063.html"><a href="sect063.html#sect0633"><i class="fa fa-check"></i><b>6.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> DBSCAN sur un réseau</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="sect064.html"><a href="sect064.html#sect0641"><i class="fa fa-check"></i><b>6.4.1</b> Explication du NKDE et du TNKDE</a></li>
<li class="chapter" data-level="6.4.2" data-path="sect064.html"><a href="sect064.html#sect0642"><i class="fa fa-check"></i><b>6.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="sect065.html"><a href="sect065.html"><i class="fa fa-check"></i><b>6.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="6.6" data-path="sect066.html"><a href="sect066.html"><i class="fa fa-check"></i><b>6.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Introduction aux modèles de régression spatiale</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Modèles économétriques spatiaux</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sect071.html"><a href="sect071.html#sect0711"><i class="fa fa-check"></i><b>7.1.1</b> Bref retour sur la régression linéaire multiple</a></li>
<li class="chapter" data-level="7.1.2" data-path="sect071.html"><a href="sect071.html#sect0712"><i class="fa fa-check"></i><b>7.1.2</b> Les différents modèles spatiaux autorégressifs</a></li>
<li class="chapter" data-level="7.1.3" data-path="sect071.html"><a href="sect071.html#sect0713"><i class="fa fa-check"></i><b>7.1.3</b> Quel modèle choisir?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Modèles généralisés additifs (GAM) avec une <em>spline</em> bivariée sur les coordonnées géographiques</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Principe de base d’un GAM intégrant l’espace</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Construction d’un modèle GAM dans R</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Régression géographiquement pondérée</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Principe de base</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Construction et analyse du modèle GWR dans R</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Méthodes de classification non supervisée spatiale</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Méthodes de classification non supervisée avec contrainte spatiale</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Algorithmes AZP</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Algorithme SKATER</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Algorithmes REDCAP</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Algorithme du <em>max-p-regions problem</em></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Méthodes de classification non supervisée avec une dimension spatiale</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Classification ascendante hiérarchique spatiale (<em>ClustGeo</em>)</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> <em>Spatial fuzzy c-means</em></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect083.html"><a href="sect083.html"><i class="fa fa-check"></i><b>8.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="8.4" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Méthodes d’interpolation spatiale</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Méthodes déterministes</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Interpolation polynomiale locale</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Interpolation de l’inverse à la distance (<em>IDW</em>)</a></li>
<li class="chapter" data-level="9.1.3" data-path="sect091.html"><a href="sect091.html#sect0913"><i class="fa fa-check"></i><b>9.1.3</b> Fonctions relationnelles</a></li>
<li class="chapter" data-level="9.1.4" data-path="sect091.html"><a href="sect091.html#sect0914"><i class="fa fa-check"></i><b>9.1.4</b> Fonctions conditionnelles</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Méthodes géostatistiques</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> Krigeage simple</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0922"><i class="fa fa-check"></i><b>9.2.2</b> Krigeage universel</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.3</b> Co-krigeage</a></li>
<li class="chapter" data-level="9.2.4" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.4</b> Krigeage résiduel</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Correction des exercices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect1001.html"><a href="sect1001.html"><i class="fa fa-check"></i><b>10.1</b> Exercices du chapitre 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect1001.html"><a href="sect1001.html#sect10011"><i class="fa fa-check"></i><b>10.1.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect1001.html"><a href="sect1001.html#sect10012"><i class="fa fa-check"></i><b>10.1.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="sect1001.html"><a href="sect1001.html#sect10013"><i class="fa fa-check"></i><b>10.1.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="sect1001.html"><a href="sect1001.html#sect10014"><i class="fa fa-check"></i><b>10.1.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect1002.html"><a href="sect1002.html"><i class="fa fa-check"></i><b>10.2</b> Exercices du chapitre 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect1002.html"><a href="sect1002.html#sect10021"><i class="fa fa-check"></i><b>10.2.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect1002.html"><a href="sect1002.html#sect10022"><i class="fa fa-check"></i><b>10.2.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.2.3" data-path="sect1002.html"><a href="sect1002.html#sect10023"><i class="fa fa-check"></i><b>10.2.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.2.4" data-path="sect1002.html"><a href="sect1002.html#sect10024"><i class="fa fa-check"></i><b>10.2.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect1003.html"><a href="sect1003.html"><i class="fa fa-check"></i><b>10.3</b> Exercices du chapitre 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sect1003.html"><a href="sect1003.html#sect10031"><i class="fa fa-check"></i><b>10.3.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="sect1003.html"><a href="sect1003.html#sect10032"><i class="fa fa-check"></i><b>10.3.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.3.3" data-path="sect1003.html"><a href="sect1003.html#sect10033"><i class="fa fa-check"></i><b>10.3.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sect1004.html"><a href="sect1004.html"><i class="fa fa-check"></i><b>10.4</b> Exercices du chapitre 4</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect1004.html"><a href="sect1004.html#sect10041"><i class="fa fa-check"></i><b>10.4.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect1004.html"><a href="sect1004.html#sect10042"><i class="fa fa-check"></i><b>10.4.2</b> Exercice 2</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect1005.html"><a href="sect1005.html"><i class="fa fa-check"></i><b>10.5</b> Exercices du chapitre 5</a></li>
<li class="chapter" data-level="10.6" data-path="sect1006.html"><a href="sect1006.html"><i class="fa fa-check"></i><b>10.6</b> Exercices du chapitre 6</a></li>
<li class="chapter" data-level="10.7" data-path="sect1007.html"><a href="sect1007.html"><i class="fa fa-check"></i><b>10.7</b> Exercices du chapitre 7</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sect1007.html"><a href="sect1007.html#sect10071"><i class="fa fa-check"></i><b>10.7.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.7.2" data-path="sect1007.html"><a href="sect1007.html#sect10072"><i class="fa fa-check"></i><b>10.7.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.7.3" data-path="sect1007.html"><a href="sect1007.html#sect10073"><i class="fa fa-check"></i><b>10.7.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="sect1008.html"><a href="sect1008.html"><i class="fa fa-check"></i><b>10.8</b> Exercices du chapitre 8</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="sect1008.html"><a href="sect1008.html#sect10081"><i class="fa fa-check"></i><b>10.8.1</b> Exercice 1</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="sect1009.html"><a href="sect1009.html"><i class="fa fa-check"></i><b>10.9</b> Exercices du chapitre 9</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours GMQ405 :
Modélisation et analyse spatiale</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect012" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Manipulation de données vectorielles<a href="sect012.html#sect012" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="bloc_objectif">
<p>Le <em>package</em> <code>sf</code> est une librairie extrêmement complète permettant de réaliser une multitude d’opérations géométriques sur des couches vectorielles comme dans un système d’information géographique (SIG). Notre objectif n’est pas de toutes les décrire, mais d’aborder les principales. Au fil de vos projets avec <code>sf</code>, vous apprendrez d’autres fonctions. Pour ce faire, n’hésitez pas à consulter :</p>
<ul>
<li>Une belle <a href="https://github.com/rstudio/cheatsheets/blob/main/sf.pdf"><em>Cheatsheet</em></a> sur <code>sf</code>. Allez y jeter un œil, cela vaut la peine!</li>
<li>Sur le <a href="https://cran.r-project.org/web/packages/sf/index.html">site CRAN</a> de <code>sf</code>, vous trouverez plusieurs vignettes explicatives (exemples de code documentés).</li>
<li>La <a href="https://cran.r-project.org/web/packages/sf/sf.pdf">documentation complète en PDF</a>.</li>
</ul>
<p>La syntaxe <code>methods(class = 'sfc')</code> renvoie la liste des méthodes implémentées dans le <em>package</em> <code>sf</code>. Pour accéder à l’aide en ligne de l’une d’entre elles, écrivez simplement <code>?Nom de la fonction</code> (ex. : <code>?st_buffer</code>).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="sect012.html#cb37-1" tabindex="-1"></a><span class="fu">methods</span>(<span class="at">class =</span> <span class="st">&#39;sfc&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] [                            [&lt;-                         
##  [3] as.data.frame                c                           
##  [5] coerce                       format                      
##  [7] fortify                      identify                    
##  [9] initialize                   ms_clip                     
## [11] ms_dissolve                  ms_erase                    
## [13] ms_explode                   ms_filter_islands           
## [15] ms_innerlines                ms_lines                    
## [17] ms_points                    ms_simplify                 
## [19] obj_sum                      Ops                         
## [21] print                        rep                         
## [23] scale_type                   show                        
## [25] slotsFromS3                  st_area                     
## [27] st_as_binary                 st_as_grob                  
## [29] st_as_s2                     st_as_sf                    
## [31] st_as_text                   st_bbox                     
## [33] st_boundary                  st_break_antimeridian       
## [35] st_buffer                    st_cast                     
## [37] st_centroid                  st_collection_extract       
## [39] st_concave_hull              st_convex_hull              
## [41] st_coordinates               st_crop                     
## [43] st_crs                       st_crs&lt;-                    
## [45] st_difference                st_geometry                 
## [47] st_inscribed_circle          st_intersection             
## [49] st_intersects                st_is                       
## [51] st_is_valid                  st_line_merge               
## [53] st_m_range                   st_make_valid               
## [55] st_minimum_rotated_rectangle st_nearest_points           
## [57] st_node                      st_normalize                
## [59] st_point_on_surface          st_polygonize               
## [61] st_precision                 st_reverse                  
## [63] st_sample                    st_segmentize               
## [65] st_set_precision             st_shift_longitude          
## [67] st_simplify                  st_snap                     
## [69] st_sym_difference            st_transform                
## [71] st_triangulate               st_triangulate_constrained  
## [73] st_union                     st_voronoi                  
## [75] st_wrap_dateline             st_write                    
## [77] st_z_range                   st_zm                       
## [79] str                          summary                     
## [81] type_sum                     vec_cast.sfc                
## [83] vec_ptype2.sfc               vect                        
## see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
<div id="sect0121" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Fonctions relatives à la projection cartographique<a href="sect012.html#sect0121" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les trois principales fonctions relatives à la projection cartographique des couches vectorielles sont :</p>
<ul>
<li><code>st_crs(x)</code> pour connaître la projection géographique d’un objet <code>sf</code>.</li>
<li><code>st_transform(x, cr)</code> pour modifier la projection cartographique.</li>
<li><code>st_is_longlat(x)</code> pour vérifier si les coordonnées sont en degrés longitude/latitude.</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="sect012.html#cb39-1" tabindex="-1"></a><span class="do">## Importation d&#39;un shapefile pour la province de Québec</span></span>
<span id="cb39-2"><a href="sect012.html#cb39-2" tabindex="-1"></a>ProvinceQc <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/chap01/shp/Quebec.shp&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-3"><a href="sect012.html#cb39-3" tabindex="-1"></a><span class="do">## La projection est EPSG:3347 - NAD83 / Statistics Canada Lambert,</span></span>
<span id="cb39-4"><a href="sect012.html#cb39-4" tabindex="-1"></a><span class="do">## soit la projection conique conforme de Lambert</span></span>
<span id="cb39-5"><a href="sect012.html#cb39-5" tabindex="-1"></a><span class="fu">st_crs</span>(ProvinceQc)</span></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: NAD83 / Statistics Canada Lambert 
##   wkt:
## PROJCRS[&quot;NAD83 / Statistics Canada Lambert&quot;,
##     BASEGEOGCRS[&quot;NAD83&quot;,
##         DATUM[&quot;North American Datum 1983&quot;,
##             ELLIPSOID[&quot;GRS 1980&quot;,6378137,298.257222101,
##                 LENGTHUNIT[&quot;metre&quot;,1]]],
##         PRIMEM[&quot;Greenwich&quot;,0,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         ID[&quot;EPSG&quot;,4269]],
##     CONVERSION[&quot;Statistics Canada Lambert&quot;,
##         METHOD[&quot;Lambert Conic Conformal (2SP)&quot;,
##             ID[&quot;EPSG&quot;,9802]],
##         PARAMETER[&quot;Latitude of false origin&quot;,63.390675,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8821]],
##         PARAMETER[&quot;Longitude of false origin&quot;,-91.8666666666667,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8822]],
##         PARAMETER[&quot;Latitude of 1st standard parallel&quot;,49,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8823]],
##         PARAMETER[&quot;Latitude of 2nd standard parallel&quot;,77,
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
##             ID[&quot;EPSG&quot;,8824]],
##         PARAMETER[&quot;Easting at false origin&quot;,6200000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8826]],
##         PARAMETER[&quot;Northing at false origin&quot;,3000000,
##             LENGTHUNIT[&quot;metre&quot;,1],
##             ID[&quot;EPSG&quot;,8827]]],
##     CS[Cartesian,2],
##         AXIS[&quot;(E)&quot;,east,
##             ORDER[1],
##             LENGTHUNIT[&quot;metre&quot;,1]],
##         AXIS[&quot;(N)&quot;,north,
##             ORDER[2],
##             LENGTHUNIT[&quot;metre&quot;,1]],
##     USAGE[
##         SCOPE[&quot;Topographic mapping (small scale).&quot;],
##         AREA[&quot;Canada - onshore and offshore - Alberta; British Columbia; Manitoba; New Brunswick; Newfoundland and Labrador; Northwest Territories; Nova Scotia; Nunavut; Ontario; Prince Edward Island; Quebec; Saskatchewan; Yukon.&quot;],
##         BBOX[38.21,-141.01,86.46,-40.73]],
##     ID[&quot;EPSG&quot;,3347]]</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="sect012.html#cb41-1" tabindex="-1"></a><span class="do">## Reprojection de la couche en WGS84 long/lat (EPSG:4326)</span></span>
<span id="cb41-2"><a href="sect012.html#cb41-2" tabindex="-1"></a>ProvinceQc<span class="fl">.4326</span> <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(ProvinceQc, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb41-3"><a href="sect012.html#cb41-3" tabindex="-1"></a><span class="do">## longitude/latitude?</span></span>
<span id="cb41-4"><a href="sect012.html#cb41-4" tabindex="-1"></a><span class="fu">st_is_longlat</span>(ProvinceQc)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="sect012.html#cb43-1" tabindex="-1"></a><span class="fu">st_is_longlat</span>(ProvinceQc<span class="fl">.4326</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>La figure <a href="sect012.html#fig:figProjections">1.3</a> démontre bien que les deux couches sont projetées différemment.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figProjections"></span>
<img src="GMQ405_files/figure-html/figProjections-1.png" alt="Deux projections cartographiques" width="75%" />
<p class="caption">
Figure 1.3: Deux projections cartographiques
</p>
</div>
</div>
<div id="sect0122" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Fonctions d’opérations géométriques sur une couche<a href="sect012.html#sect0122" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il existe une quinzaine de fonctions d’opérations géométriques sur une couche dans le <em>package</em> <code>sf</code> dont le résultat renvoie de nouvelles géométries (<a href="https://r-spatial.github.io/sf/reference/geos_unary.html">voir la documentation suivante</a>). Nous décrivons ici uniquement celles qui nous semblent les plus utilisées :</p>
<ul>
<li><code>st_bbox(x)</code> renvoie les coordonnées minimales et maximales des géométries d’un objet <code>sf</code>. Pour créer l’enveloppe d’un objet <code>sf</code>, il suffit donc d’écrire <code>st_as_sfc(st_bbox(x))</code>.</li>
<li><code>st_boundary(x)</code> renvoie les limites (contours) des géométries d’un objet <code>sf</code>.</li>
<li><code>st_convex_hull(x)</code> crée l’enveloppe convexe des géométries d’un objet <code>sf</code>.</li>
<li><code>st_combine(x)</code> regroupe les géométries d’un objet <code>sf</code> en une seule géométrie, sans les réunir ni résoudre les limites internes.</li>
<li><code>st_union(x)</code> fusionne les géométries d’un objet <code>sf</code> en une seule géométrie.</li>
<li><code>st_buffer(x, dist, endCapStyle = c("ROUND", "FLAT", "SQUARE"), joinStyle = c("ROUND", "MITRE", "BEVEL"))</code> crée des zones tampons d’une distance définie avec le paramètre <code>dist</code>. Cette fonction s’applique à des points, à des lignes et à des polygones.</li>
<li><code>st_centroid(x)</code> crée des points au centre de chaque géométrie d’un objet <code>sf</code>. Elle s’applique donc à des lignes et à des polygones.</li>
<li><code>st_point_on_surface(x)</code> crée un point au centre de chaque polygone d’un objet <code>sf</code> .</li>
<li><code>st_simplify(x, dTolerance)</code> simplifie les contours de géométries (lignes ou polygones) avec une tolérance exprimée en mètres (paramètre <code>dTolerance</code>) d’un objet <code>sf</code> .</li>
<li><code>st_voronoi(x, bOnlyEdges = TRUE)</code> crée des polygones de Thiessen, appelés aussi polygones de Voronoï pour des points. Attention, le paramètre <code>bOnlyEdges = TRUE</code> renvoie des lignes tandis que <code>bOnlyEdges = FALSE</code> renvoie des polygones.</li>
</ul>
<div id="sect01221" class="section level4 hasAnchor" number="1.2.2.1">
<h4><span class="header-section-number">1.2.2.1</span> Enveloppe et union d’une couche<a href="sect012.html#sect01221" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le code ci-dessous crée une enveloppe (en bleu) et un polygone fusionné (en rouge) pour les arrondissements de la ville de Sherbrooke (figure <a href="sect012.html#fig:figEnveloppeUnion">1.4</a>). La couche résultante de l’opération <code>st_as_sfc(st_bbox(x))</code> est ainsi l’équivalent des outils <code>Emprise</code> de QGIS et de <code>Minimum Bounding Geometry (Geometry Type = Envelope)</code> d’ArcGIS Pro.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="sect012.html#cb45-1" tabindex="-1"></a><span class="do">## Enveloppe sur les arrondissements de la ville de Sherbrooke</span></span>
<span id="cb45-2"><a href="sect012.html#cb45-2" tabindex="-1"></a>Arrond.Enveloppe <span class="ot">&lt;-</span> <span class="fu">st_as_sfc</span>(<span class="fu">st_bbox</span>(Arrondissements))</span>
<span id="cb45-3"><a href="sect012.html#cb45-3" tabindex="-1"></a><span class="do">## Fusionne les géométries en une seule en résolvant les limites internes</span></span>
<span id="cb45-4"><a href="sect012.html#cb45-4" tabindex="-1"></a>Arrond.Union <span class="ot">&lt;-</span> <span class="fu">st_union</span>(Arrondissements)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figEnveloppeUnion"></span>
<img src="GMQ405_files/figure-html/figEnveloppeUnion-1.png" alt="Enveloppe sur une couche" width="65%" />
<p class="caption">
Figure 1.4: Enveloppe sur une couche
</p>
</div>
</div>
<div id="sect01222" class="section level4 hasAnchor" number="1.2.2.2">
<h4><span class="header-section-number">1.2.2.2</span> Enveloppe orientée<a href="sect012.html#sect01222" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La fonction <code>st_bbox</code> de <code>sf</code> produit des rectangles englobant des géométries qui sont orientés nord-sud. Il est possible de générer des rectangles orientés autour de géométries pour minimiser leur emprise et ainsi mieux représenter l’orientation de la géométrie initiale.
Il n’existe pas une fonction dans <code>sf</code> pour le faire, mais le <em>package</em> <code>foot</code> offre une implémentation facile d’utilisation. Notez que <code>foot</code> n’est pas déposé sur CRAN et doit être téléchargé depuis <em>Github</em> avec la ligne de code ci-dessous.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="sect012.html#cb46-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;wpgp/foot&quot;</span>, <span class="at">build_vignettes =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>La couche résultante de l’opération <code>fs_mbr(x, returnShape = TRUE)</code> (figure <a href="sect012.html#fig:figEnveloppeOrientee">1.5</a>.b) est ainsi l’équivalent des outils <code>Emprise orientée minimale (OMBB)</code> de QGIS et de <code>Minimum Bounding Geometry (Geometry Type = Rectangle by area)</code> d’ArcGIS Pro.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="sect012.html#cb47-1" tabindex="-1"></a><span class="fu">library</span>(foot)</span>
<span id="cb47-2"><a href="sect012.html#cb47-2" tabindex="-1"></a><span class="do">## Rectangles (enveloppes) orientés </span></span>
<span id="cb47-3"><a href="sect012.html#cb47-3" tabindex="-1"></a>rectangles_oriented <span class="ot">&lt;-</span> <span class="fu">fs_mbr</span>(Arrondissements, <span class="at">returnShape =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-4"><a href="sect012.html#cb47-4" tabindex="-1"></a>rectangles_oriented <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(rectangles_oriented,</span>
<span id="cb47-5"><a href="sect012.html#cb47-5" tabindex="-1"></a>                                <span class="at">crs =</span> <span class="fu">st_crs</span>(Arrondissements))</span>
<span id="cb47-6"><a href="sect012.html#cb47-6" tabindex="-1"></a>rectangles_oriented<span class="sc">$</span>NOM <span class="ot">&lt;-</span> Arrondissements<span class="sc">$</span>NOM</span>
<span id="cb47-7"><a href="sect012.html#cb47-7" tabindex="-1"></a><span class="do">## Rectangles non orientés (nord-sud)</span></span>
<span id="cb47-8"><a href="sect012.html#cb47-8" tabindex="-1"></a>st_bbox_by_feature <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb47-9"><a href="sect012.html#cb47-9" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">st_geometry</span>(x)</span>
<span id="cb47-10"><a href="sect012.html#cb47-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(y) <span class="fu">st_as_sfc</span>(<span class="fu">st_bbox</span>(y))</span>
<span id="cb47-11"><a href="sect012.html#cb47-11" tabindex="-1"></a>  <span class="fu">do.call</span>(<span class="st">&quot;c&quot;</span>, <span class="fu">lapply</span>(x, f))</span>
<span id="cb47-12"><a href="sect012.html#cb47-12" tabindex="-1"></a>}</span>
<span id="cb47-13"><a href="sect012.html#cb47-13" tabindex="-1"></a>rectangles <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">st_bbox_by_feature</span>(Arrondissements),</span>
<span id="cb47-14"><a href="sect012.html#cb47-14" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="fu">st_crs</span>(Arrondissements))</span>
<span id="cb47-15"><a href="sect012.html#cb47-15" tabindex="-1"></a>rectangles<span class="sc">$</span>NOM <span class="ot">&lt;-</span> Arrondissements<span class="sc">$</span>NOM</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figEnveloppeOrientee"></span>
<img src="GMQ405_files/figure-html/figEnveloppeOrientee-1.png" alt="Enveloppes classiques et orientées" width="65%" />
<p class="caption">
Figure 1.5: Enveloppes classiques et orientées
</p>
</div>
</div>
<div id="sect01223" class="section level4 hasAnchor" number="1.2.2.3">
<h4><span class="header-section-number">1.2.2.3</span> Centroïdes et centre de surface<a href="sect012.html#sect01223" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le code ci-dessous extrait les centres géométriques, c’est-à-dire les centroïdes (en bleu) et les points à l’intérieur des polygones (en rouge) pour les arrondissements de la ville de Sherbrooke (figure <a href="sect012.html#fig:figCentroidesPointsInterieur">1.6</a>). Ces deux opérations correspondent aux outils <code>centroïdes</code> et <code>Point dans la surface</code> de QGIS et <code>Feature to Point (avec l'option Inside)</code> d’ArcGIS Pro.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="sect012.html#cb48-1" tabindex="-1"></a><span class="do">## Centroides et points dans les polygones sur les arrondissements</span></span>
<span id="cb48-2"><a href="sect012.html#cb48-2" tabindex="-1"></a>Arrond.centroide <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(Arrondissements)</span>
<span id="cb48-3"><a href="sect012.html#cb48-3" tabindex="-1"></a>Arrond.pointpoly <span class="ot">&lt;-</span> <span class="fu">st_point_on_surface</span>(Arrondissements)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figCentroidesPointsInterieur"></span>
<img src="GMQ405_files/figure-html/figCentroidesPointsInterieur-1.png" alt="Centroïdes et points à l'intérieur des polygones" width="65%" />
<p class="caption">
Figure 1.6: Centroïdes et points à l’intérieur des polygones
</p>
</div>
</div>
<div id="sect01224" class="section level4 hasAnchor" number="1.2.2.4">
<h4><span class="header-section-number">1.2.2.4</span> Zone tampon (<em>buffer</em>)<a href="sect012.html#sect01224" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Une simple ligne de code permet de créer des zones tampons (équivalent des outils <code>Analyse vectorielle/Tampon</code> dans QGIS et <code>Buffer</code> dans ArcGIS Pro). Une fois les zones créées, utilisez la fonction <code>st_union</code> pour fusionner les tampons en un polygone (figure <a href="sect012.html#fig:figZoneTampon">1.7</a>).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="sect012.html#cb49-1" tabindex="-1"></a><span class="do">## Zones tampons de 1000 mètres autour des installations sportives et récréatives</span></span>
<span id="cb49-2"><a href="sect012.html#cb49-2" tabindex="-1"></a>InstSports.buffer <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(InstallationSport, <span class="at">dist =</span> <span class="dv">1000</span>)</span>
<span id="cb49-3"><a href="sect012.html#cb49-3" tabindex="-1"></a><span class="do">## Si vous souhaitez fusionner les zones tampons, utilisez la fonction st_union</span></span>
<span id="cb49-4"><a href="sect012.html#cb49-4" tabindex="-1"></a>InstSports.bufferUnion <span class="ot">&lt;-</span> <span class="fu">st_union</span>(InstSports.buffer)</span>
<span id="cb49-5"><a href="sect012.html#cb49-5" tabindex="-1"></a><span class="do">## Zones tampons de 500 mètres autour des lignes</span></span>
<span id="cb49-6"><a href="sect012.html#cb49-6" tabindex="-1"></a>PistesCyclables.buffer <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(PistesCyclables, <span class="at">dist =</span> <span class="dv">500</span>)</span>
<span id="cb49-7"><a href="sect012.html#cb49-7" tabindex="-1"></a>PistesCyclables.bufferUnion <span class="ot">&lt;-</span> <span class="fu">st_union</span>(PistesCyclables.buffer)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figZoneTampon"></span>
<img src="GMQ405_files/figure-html/figZoneTampon-1.png" alt="Zones tampons" width="65%" />
<p class="caption">
Figure 1.7: Zones tampons
</p>
</div>
<p>Notez que pour des polygones, il est possible de créer des polygones intérieurs comme suit : <code>st_buffer(x, dist = - Valeur)</code>. Par exemple, le code ci-dessous crée des polygones de 200 mètres autour et à l’intérieur du parc du Mont-Bellevue de la ville de Sherbrooke (figure <a href="sect012.html#fig:figZoneTampon2">1.8</a>).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="sect012.html#cb50-1" tabindex="-1"></a><span class="do">## Importation de la couche des aires aménagées de la ville de Sherbrooke</span></span>
<span id="cb50-2"><a href="sect012.html#cb50-2" tabindex="-1"></a>AiresAmenag <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap01/geodatabase/Sherbrooke.gdb&quot;</span>,</span>
<span id="cb50-3"><a href="sect012.html#cb50-3" tabindex="-1"></a>                       <span class="at">layer =</span> <span class="st">&quot;AiresAmenagees&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-4"><a href="sect012.html#cb50-4" tabindex="-1"></a><span class="do">## Sélection du parc du Mont-Bellevue</span></span>
<span id="cb50-5"><a href="sect012.html#cb50-5" tabindex="-1"></a>MontBellevue <span class="ot">&lt;-</span> <span class="fu">subset</span>(AiresAmenag, NOM <span class="sc">==</span> <span class="st">&quot;Parc du Mont-Bellevue&quot;</span>)</span>
<span id="cb50-6"><a href="sect012.html#cb50-6" tabindex="-1"></a><span class="do">## Création d&#39;une zone tampon autour du parc</span></span>
<span id="cb50-7"><a href="sect012.html#cb50-7" tabindex="-1"></a>MontBellevue.ZTA500 <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(MontBellevue, <span class="at">dist =</span> <span class="dv">200</span>)</span>
<span id="cb50-8"><a href="sect012.html#cb50-8" tabindex="-1"></a><span class="do">## Création d&#39;une zone tampon à l&#39;intérieur du parc</span></span>
<span id="cb50-9"><a href="sect012.html#cb50-9" tabindex="-1"></a>MontBellevue.ZTI500 <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(MontBellevue, <span class="at">dist =</span> <span class="sc">-</span><span class="dv">200</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figZoneTampon2"></span>
<img src="GMQ405_files/figure-html/figZoneTampon2-1.png" alt="Zone tampon intérieure et zone tampon extérieure" width="65%" />
<p class="caption">
Figure 1.8: Zone tampon intérieure et zone tampon extérieure
</p>
</div>
</div>
<div id="sect01225" class="section level4 hasAnchor" number="1.2.2.5">
<h4><span class="header-section-number">1.2.2.5</span> Simplification de géométries<a href="sect012.html#sect01225" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La simplification ou généralisation d’une couche de lignes ou de polygones permet de supprimer des sommets tout en gardant le même nombre de géométries dans la couche résultante. Cette opération peut être réalisée dans QGIS avec l’outil <code>simplifier</code> et dans ArcGIS Pro avec l’outil <code>Generalize</code>. Deux raisons principales peuvent motiver le recours à cette opération :</p>
<ul>
<li><p>La réduction de la taille du fichier, surtout si la couche est utilisée pour de la cartographie interactive sur Internet avec des formats vectoriels comme le SVG (<em>Scalable Vector Graphics</em>), le KML ou le GeoJSON.</p></li>
<li><p>L’utilisation de la couche à une plus petite échelle cartographique nécessitant la suppression de détails.</p></li>
</ul>
<p>Le code suivant permet de simplifier les contours des arrondissements de la ville de Sherbrooke avec des tolérances de 250, 500, 1000 et 2000 mètres. Plus la valeur de la tolérance est élevée, plus les contours sont simplifiés (figure <a href="sect012.html#fig:figSimplification">1.9</a>). Notez que l’algorithme de Douglas-Peucker <span class="citation">(<a href="#ref-douglas1973algorithms">Douglas et Peucker 1973</a>)</span> a été implémenté dans la fonction <code>st_simplify</code>. Bien qu’intéressant, cet algorithme ne conserve pas les frontières entre les polygones.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="sect012.html#cb51-1" tabindex="-1"></a><span class="do">## Simplification des contours avec différentes distances de tolérance</span></span>
<span id="cb51-2"><a href="sect012.html#cb51-2" tabindex="-1"></a>Arrond.simplify250m <span class="ot">&lt;-</span> <span class="fu">st_simplify</span>(Arrondissements, </span>
<span id="cb51-3"><a href="sect012.html#cb51-3" tabindex="-1"></a>                                   <span class="at">preserveTopology =</span> <span class="cn">TRUE</span>, </span>
<span id="cb51-4"><a href="sect012.html#cb51-4" tabindex="-1"></a>                                   <span class="at">dTolerance =</span> <span class="dv">250</span>)</span>
<span id="cb51-5"><a href="sect012.html#cb51-5" tabindex="-1"></a>Arrond.simplify500m <span class="ot">&lt;-</span> <span class="fu">st_simplify</span>(Arrondissements, </span>
<span id="cb51-6"><a href="sect012.html#cb51-6" tabindex="-1"></a>                                   <span class="at">preserveTopology =</span> <span class="cn">TRUE</span>, </span>
<span id="cb51-7"><a href="sect012.html#cb51-7" tabindex="-1"></a>                                   <span class="at">dTolerance =</span> <span class="dv">500</span>)</span>
<span id="cb51-8"><a href="sect012.html#cb51-8" tabindex="-1"></a>Arrond.simplify1000m <span class="ot">&lt;-</span> <span class="fu">st_simplify</span>(Arrondissements, </span>
<span id="cb51-9"><a href="sect012.html#cb51-9" tabindex="-1"></a>                                    <span class="at">preserveTopology =</span> <span class="cn">TRUE</span>, </span>
<span id="cb51-10"><a href="sect012.html#cb51-10" tabindex="-1"></a>                                    <span class="at">dTolerance =</span> <span class="dv">1000</span>)</span>
<span id="cb51-11"><a href="sect012.html#cb51-11" tabindex="-1"></a>Arrond.simplify2000m <span class="ot">&lt;-</span> <span class="fu">st_simplify</span>(Arrondissements, </span>
<span id="cb51-12"><a href="sect012.html#cb51-12" tabindex="-1"></a>                                    <span class="at">preserveTopology =</span> <span class="cn">TRUE</span>, </span>
<span id="cb51-13"><a href="sect012.html#cb51-13" tabindex="-1"></a>                                    <span class="at">dTolerance =</span> <span class="dv">2000</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figSimplification"></span>
<img src="GMQ405_files/figure-html/figSimplification-1.png" alt="Simplication des contours de géométries" width="65%" />
<p class="caption">
Figure 1.9: Simplication des contours de géométries
</p>
</div>
<p>Pour remédier au problème des frontières non conservées, utilisez l’algorithme de Visvalingam et Whyatt <span class="citation">(<a href="#ref-visvalingam1993line">1993</a>)</span> avec la fonction <code>ms_simplify</code> du <em>package</em> <code>rmapshaper</code> (figure <a href="sect012.html#fig:figSimplificationVisvalingam">1.10</a>), tel qu’illustré dans le code ci-dessous. À titre de rappel, pour l’installer et le charger sur votre ordinateur, tapez dans la console : <code>install.packages("rmapshaper")</code> et <code>library("rmapshaper")</code>. Le paramètre <code>keep</code> permet de définir la proportion de points à retenir : plus sa valeur est faible, plus la simplification est importante.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figSimplificationVisvalingam"></span>
<img src="GMQ405_files/figure-html/figSimplificationVisvalingam-1.png" alt="Simplication des contours avec l'algorithme de Visvalingam–Whyatt" width="65%" />
<p class="caption">
Figure 1.10: Simplication des contours avec l’algorithme de Visvalingam–Whyatt
</p>
</div>
</div>
<div id="sect01226" class="section level4 hasAnchor" number="1.2.2.6">
<h4><span class="header-section-number">1.2.2.6</span> Enveloppe convexe (<em>convex hull</em>)<a href="sect012.html#sect01226" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le code ci-dessous permet de créer l’enveloppe convexe pour des points (figure <a href="sect012.html#fig:figConvexHull">1.11</a>). Notez que cette fonction peut également s’appliquer à des lignes et à des polygones. Elle correspond aux outils <code>Enveloppe convexe</code> de QGIS et <code>Feature to Point (avec l'option Convex hull)</code> d’ArcGIS Pro.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="sect012.html#cb52-1" tabindex="-1"></a><span class="do">## Enveloppe convexe autour des points GPS</span></span>
<span id="cb52-2"><a href="sect012.html#cb52-2" tabindex="-1"></a>PointsGPS.Convexhull <span class="ot">&lt;-</span> <span class="fu">st_convex_hull</span>(<span class="fu">st_union</span>(PointsGPS))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figConvexHull"></span>
<img src="GMQ405_files/figure-html/figConvexHull-1.png" alt="Enveloppe convexe autour de points" width="65%" />
<p class="caption">
Figure 1.11: Enveloppe convexe autour de points
</p>
</div>
</div>
<div id="sect01227" class="section level4 hasAnchor" number="1.2.2.7">
<h4><span class="header-section-number">1.2.2.7</span> Enveloppe concave (<em>concave hull</em>)<a href="sect012.html#sect01227" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Une extension possible du polygone convexe est le polygone concave qui a une superficie plus réduite. Il n’existe pas une fonction dans <code>sf</code> qui l’implémente. Il faut donc installer un <em>package</em> supplémentaire, soit <code>concaveman</code>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="sect012.html#cb53-1" tabindex="-1"></a><span class="fu">library</span>(concaveman)</span>
<span id="cb53-2"><a href="sect012.html#cb53-2" tabindex="-1"></a><span class="do">## Convex hull autour des points GPS</span></span>
<span id="cb53-3"><a href="sect012.html#cb53-3" tabindex="-1"></a>PointsGPS.Concavhull <span class="ot">&lt;-</span> <span class="fu">concaveman</span>(PointsGPS)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figConcaveHull"></span>
<img src="GMQ405_files/figure-html/figConcaveHull-1.png" alt="Enveloppe concave autour de points" width="65%" />
<p class="caption">
Figure 1.12: Enveloppe concave autour de points
</p>
</div>
<p>Notez que comparativement au polygone convexe (figure <a href="sect012.html#fig:figConcaveHull">1.12</a>), le polygone concave n’a pas qu’une seule solution possible (<a href="https://portailsig.org/content/sur-la-creation-des-enveloppes-concaves-concave-hull-et-les-divers-moyens-d-y-parvenir-forme.html">lire l’article suivant</a>). Plus spécifiquement, il faut choisir son degré de concavité. Dans la fonction <code>concaveman::concaveman</code>, le paramètre <code>concavity</code> prend une valeur numérique, qui si elle tend vers l’infini, produit un polygone convexe (figure <a href="sect012.html#fig:figConcaveHull2">1.13</a>).</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="sect012.html#cb54-1" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb54-2"><a href="sect012.html#cb54-2" tabindex="-1"></a><span class="co"># test avec plusieurs valeur de concavité</span></span>
<span id="cb54-3"><a href="sect012.html#cb54-3" tabindex="-1"></a>concav_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">3</span>,<span class="dv">8</span>)</span>
<span id="cb54-4"><a href="sect012.html#cb54-4" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(concav_values, <span class="cf">function</span>(i){</span>
<span id="cb54-5"><a href="sect012.html#cb54-5" tabindex="-1"></a>  Concavhull <span class="ot">&lt;-</span> <span class="fu">concaveman</span>(PointsGPS, <span class="at">concavity =</span> i)</span>
<span id="cb54-6"><a href="sect012.html#cb54-6" tabindex="-1"></a>  this_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb54-7"><a href="sect012.html#cb54-7" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> Concavhull)<span class="sc">+</span></span>
<span id="cb54-8"><a href="sect012.html#cb54-8" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> PointsGPS)<span class="sc">+</span></span>
<span id="cb54-9"><a href="sect012.html#cb54-9" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;Concavité : &quot;</span>,i))<span class="sc">+</span></span>
<span id="cb54-10"><a href="sect012.html#cb54-10" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-11"><a href="sect012.html#cb54-11" tabindex="-1"></a>            <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-12"><a href="sect012.html#cb54-12" tabindex="-1"></a>            <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())</span>
<span id="cb54-13"><a href="sect012.html#cb54-13" tabindex="-1"></a>  <span class="fu">return</span>(this_plot)</span>
<span id="cb54-14"><a href="sect012.html#cb54-14" tabindex="-1"></a>})</span>
<span id="cb54-15"><a href="sect012.html#cb54-15" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="at">plotlist =</span> plots)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figConcaveHull2"></span>
<img src="GMQ405_files/figure-html/figConcaveHull2-1.png" alt="Enveloppe concave autour de points" width="80%" />
<p class="caption">
Figure 1.13: Enveloppe concave autour de points
</p>
</div>
<p>Dans QGIS, il existe plusieurs <em>plugins</em> permettant de générer des enveloppes concaves, ainsi qu’une fonction installée de base avec GRASS (<code>v.concave.hull</code>).</p>
</div>
</div>
<div id="sect01213" class="section level3 hasAnchor" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Fonctions d’opérations géométriques entre deux couches<a href="sect012.html#sect01213" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les opérations entre deux couches sont bien connues et largement utilisées dans les SIG. Bien entendu, plusieurs fonctions de ce type sont disponibles dans <code>sf</code> et renvoient une nouvelle couche géographique <code>sf</code> :</p>
<ul>
<li><p><code>st_intersection(x, y)</code> génère l’intersection entre les géométries de deux couches. À ne pas confondre avec la fonction <code>st_intersects(x, y)</code> qui permet de construire une requête spatiale.</p></li>
<li><p><code>st_union(x, y)</code> génère l’union entre les géométries de deux couches.</p></li>
<li><p><code>st_difference(x, y)</code> crée une géométrie à partir de <code>x</code> qui n’est pas en intersection avec <code>y.</code></p></li>
<li><p><code>st_sym_difference(x, y)</code> crée une géométrie représentant les portions des géométries <code>x</code> et <code>y</code> qui ne s’intersectent pas.</p></li>
<li><p><code>st_crop(x, y, xmin, ymin, xmax, ymax)</code> extrait les géométries de <code>x</code> comprises dans un rectangle.</p></li>
</ul>
<p>En guise de comparaison, toutes ces fonctions sont disponibles dans la boîte à outils de traitement de QGIS (dans le groupe <code>recouvrement de vecteur</code>) et les outils de la catégorie <code>Overlay du Geoprocessing</code> d’ArcGIS Pro. Le code ci-dessous illustre comment réaliser des intersections et des unions entre deux couches polygonales.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="sect012.html#cb55-1" tabindex="-1"></a><span class="do">## Importation des deux couches</span></span>
<span id="cb55-2"><a href="sect012.html#cb55-2" tabindex="-1"></a>polysX <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/chap01/shp/PolyX.shp&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-3"><a href="sect012.html#cb55-3" tabindex="-1"></a>polysY <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/chap01/shp/PolyY.shp&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-4"><a href="sect012.html#cb55-4" tabindex="-1"></a><span class="do">## Intersection des deux couches</span></span>
<span id="cb55-5"><a href="sect012.html#cb55-5" tabindex="-1"></a><span class="do">## Les géométries récupèrent les attributs des deux couches</span></span>
<span id="cb55-6"><a href="sect012.html#cb55-6" tabindex="-1"></a>Inter.XY <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(polysX, polysY)</span>
<span id="cb55-7"><a href="sect012.html#cb55-7" tabindex="-1"></a><span class="fu">head</span>(Inter.XY)</span></code></pre></div>
<pre><code>## Simple feature collection with 2 features and 2 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -8006904 ymin: 5684822 xmax: -8006602 ymax: 5685184
## Projected CRS: WGS 84 / Pseudo-Mercator
##   X_id Y_id                       geometry
## 1  X.a  Y.d POLYGON ((-8006753 5684838,...
## 2  Y.b  Y.d POLYGON ((-8006788 5684908,...</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="sect012.html#cb57-1" tabindex="-1"></a><span class="do">## Intersection entre deux couches préalablement fusionnées : </span></span>
<span id="cb57-2"><a href="sect012.html#cb57-2" tabindex="-1"></a><span class="do">## Le résutat est une seule géométrie</span></span>
<span id="cb57-3"><a href="sect012.html#cb57-3" tabindex="-1"></a>Inter.XYUnion <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(<span class="fu">st_union</span>(polysX), <span class="fu">st_union</span>(polysY))</span>
<span id="cb57-4"><a href="sect012.html#cb57-4" tabindex="-1"></a><span class="do">## Union des deux couches</span></span>
<span id="cb57-5"><a href="sect012.html#cb57-5" tabindex="-1"></a>Union.XY <span class="ot">&lt;-</span> <span class="fu">st_union</span>(<span class="fu">st_union</span>(polysX), <span class="fu">st_union</span>(polysY))</span></code></pre></div>
<p><img src="GMQ405_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>La fonction <code>st_intersection</code> peut aussi être utilisée comme la méthode <code>clip</code> dans un SIG (ArcGIS Pro ou QGIS). En guise d’exemple, dans le code ci-dessous, nous extrayons les points GPS localisés sur le territoire de la ville de Sherbrooke (figure <a href="sect012.html#fig:figClip">1.14</a>).</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="sect012.html#cb58-1" tabindex="-1"></a><span class="co"># Nous nous assurons que les deux couches ont la même projection</span></span>
<span id="cb58-2"><a href="sect012.html#cb58-2" tabindex="-1"></a>PointsGPS <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(PointsGPS, <span class="fu">st_crs</span>(Arrond.Union))</span>
<span id="cb58-3"><a href="sect012.html#cb58-3" tabindex="-1"></a><span class="co"># Extraction des points</span></span>
<span id="cb58-4"><a href="sect012.html#cb58-4" tabindex="-1"></a>PointsGPS.Sherb <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(PointsGPS, Arrond.Union)</span>
<span id="cb58-5"><a href="sect012.html#cb58-5" tabindex="-1"></a><span class="co"># Visualisation avant et après</span></span>
<span id="cb58-6"><a href="sect012.html#cb58-6" tabindex="-1"></a>Carte1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_sf</span>(<span class="at">data =</span> Arrond.Union)<span class="sc">+</span><span class="fu">geom_sf</span>(<span class="at">data =</span> PointsGPS)<span class="sc">+</span></span>
<span id="cb58-7"><a href="sect012.html#cb58-7" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Avant l&#39;intersection&quot;</span>)<span class="sc">+</span></span>
<span id="cb58-8"><a href="sect012.html#cb58-8" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-9"><a href="sect012.html#cb58-9" tabindex="-1"></a>                <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-10"><a href="sect012.html#cb58-10" tabindex="-1"></a>                <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())</span>
<span id="cb58-11"><a href="sect012.html#cb58-11" tabindex="-1"></a>Carte2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_sf</span>(<span class="at">data =</span> Arrond.Union)<span class="sc">+</span><span class="fu">geom_sf</span>(<span class="at">data =</span> PointsGPS.Sherb)<span class="sc">+</span></span>
<span id="cb58-12"><a href="sect012.html#cb58-12" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Après l&#39;intersection&quot;</span>)<span class="sc">+</span></span>
<span id="cb58-13"><a href="sect012.html#cb58-13" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-14"><a href="sect012.html#cb58-14" tabindex="-1"></a>                <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-15"><a href="sect012.html#cb58-15" tabindex="-1"></a>                <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())</span>
<span id="cb58-16"><a href="sect012.html#cb58-16" tabindex="-1"></a><span class="fu">ggarrange</span>(Carte1, Carte2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figClip"></span>
<img src="GMQ405_files/figure-html/figClip-1.png" alt="Fonction st_intersection() équivalente à la méthode clip dans un SIG" width="65%" />
<p class="caption">
Figure 1.14: Fonction st_intersection() équivalente à la méthode clip dans un SIG
</p>
</div>
<p>Quelques lignes de code suffisent pour générer les différences de superposition entre les géométries de couches géographiques (figure <a href="sect012.html#fig:figClip2">1.15</a>).</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="sect012.html#cb59-1" tabindex="-1"></a><span class="do">## Différences entre deux couches</span></span>
<span id="cb59-2"><a href="sect012.html#cb59-2" tabindex="-1"></a>Diff.XY <span class="ot">&lt;-</span> <span class="fu">st_difference</span>(<span class="fu">st_union</span>(polysX), <span class="fu">st_union</span>(polysY))</span>
<span id="cb59-3"><a href="sect012.html#cb59-3" tabindex="-1"></a>Diff.YX <span class="ot">&lt;-</span> <span class="fu">st_difference</span>(<span class="fu">st_union</span>(polysY), <span class="fu">st_union</span>(polysX))</span>
<span id="cb59-4"><a href="sect012.html#cb59-4" tabindex="-1"></a>Diff.symXY <span class="ot">&lt;-</span> <span class="fu">st_sym_difference</span>(<span class="fu">st_union</span>(polysY), <span class="fu">st_union</span>(polysX))</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="sect012.html#cb60-1" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb60-2"><a href="sect012.html#cb60-2" tabindex="-1"></a>MapInterU <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Zone)<span class="sc">+</span><span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.col =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb60-3"><a href="sect012.html#cb60-3" tabindex="-1"></a><span class="fu">tm_shape</span>(Inter.XYUnion)<span class="sc">+</span><span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;tomato4&quot;</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, </span>
<span id="cb60-4"><a href="sect012.html#cb60-4" tabindex="-1"></a>                            <span class="at">border.col =</span><span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb60-5"><a href="sect012.html#cb60-5" tabindex="-1"></a></span>
<span id="cb60-6"><a href="sect012.html#cb60-6" tabindex="-1"></a>MapDiffXY <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Zone)<span class="sc">+</span><span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.col =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb60-7"><a href="sect012.html#cb60-7" tabindex="-1"></a>             <span class="fu">tm_shape</span>(Diff.XY)<span class="sc">+</span></span>
<span id="cb60-8"><a href="sect012.html#cb60-8" tabindex="-1"></a>             <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> .<span class="dv">5</span>,<span class="at">border.col =</span><span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb60-9"><a href="sect012.html#cb60-9" tabindex="-1"></a>             <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">&quot;st_difference(st_union(polysX), st_union(polysY))&quot;</span>, </span>
<span id="cb60-10"><a href="sect012.html#cb60-10" tabindex="-1"></a>                       <span class="at">main.title.size =</span> .<span class="dv">8</span>)</span>
<span id="cb60-11"><a href="sect012.html#cb60-11" tabindex="-1"></a></span>
<span id="cb60-12"><a href="sect012.html#cb60-12" tabindex="-1"></a>MapDiffYX <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Zone)<span class="sc">+</span><span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.col =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb60-13"><a href="sect012.html#cb60-13" tabindex="-1"></a>             <span class="fu">tm_shape</span>(Diff.YX)<span class="sc">+</span></span>
<span id="cb60-14"><a href="sect012.html#cb60-14" tabindex="-1"></a>             <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">alpha =</span> .<span class="dv">5</span>,<span class="at">border.col =</span><span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb60-15"><a href="sect012.html#cb60-15" tabindex="-1"></a>             <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">&quot;st_difference(st_union(polysY), st_union(polysX))&quot;</span>, </span>
<span id="cb60-16"><a href="sect012.html#cb60-16" tabindex="-1"></a>                       <span class="at">main.title.size =</span> .<span class="dv">8</span>)</span>
<span id="cb60-17"><a href="sect012.html#cb60-17" tabindex="-1"></a></span>
<span id="cb60-18"><a href="sect012.html#cb60-18" tabindex="-1"></a>MapSymDiffYX <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Zone)<span class="sc">+</span><span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">border.col =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb60-19"><a href="sect012.html#cb60-19" tabindex="-1"></a>             <span class="fu">tm_shape</span>(Diff.symXY)<span class="sc">+</span></span>
<span id="cb60-20"><a href="sect012.html#cb60-20" tabindex="-1"></a>             <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">alpha =</span> .<span class="dv">5</span>,<span class="at">border.col =</span><span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb60-21"><a href="sect012.html#cb60-21" tabindex="-1"></a>             <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">&quot;st_sym_difference(st_union(polysY), st_union(polysX))&quot;</span>,</span>
<span id="cb60-22"><a href="sect012.html#cb60-22" tabindex="-1"></a>                       <span class="at">main.title.size =</span> .<span class="dv">8</span>)</span>
<span id="cb60-23"><a href="sect012.html#cb60-23" tabindex="-1"></a></span>
<span id="cb60-24"><a href="sect012.html#cb60-24" tabindex="-1"></a><span class="fu">tmap_arrange</span>(MapZone, MapDiffXY, MapDiffYX, MapSymDiffYX, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figClip2"></span>
<img src="GMQ405_files/figure-html/figClip2-1.png" alt="Différences de superposition entre des géométries de différentes couches" width="75%" />
<p class="caption">
Figure 1.15: Différences de superposition entre des géométries de différentes couches
</p>
</div>
</div>
<div id="sect0124" class="section level3 hasAnchor" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Fonctions de mesures géométriques et de récupération des coordonnées géographiques<a href="sect012.html#sect0124" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les principales fonctions de mesures géométriques et de coordonnées géographiques sont :</p>
<ul>
<li><p><code>st_area(x)</code> calcule la superficie des polygones ou des multipolygones d’une couche <code>sf</code> .</p></li>
<li><p><code>st_length(x)</code> calcule la longueur des lignes ou des polylignes d’une couche <code>sf</code> .</p></li>
<li><p><code>st_distance(x, y)</code> calcule la distance 2D entre deux objets <code>sf</code>, exprimée dans le système de coordonnées de référence.</p></li>
<li><p><code>st_coordinates(x)</code> renvoie les coordonnées géographiques de géométries.</p></li>
</ul>
<p>Ci-dessous, nous affichons les superficies des quatre arrondissements, puis nous enregistrons les superficies en m<sup>2</sup> et en km<sup>2</sup> dans deux nouveaux champs dénommés <code>SupM2</code> et <code>SupKm2.</code></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="sect012.html#cb61-1" tabindex="-1"></a><span class="do">## Superficie des polygones des arrondissements</span></span>
<span id="cb61-2"><a href="sect012.html#cb61-2" tabindex="-1"></a><span class="fu">st_area</span>(Arrondissements)</span></code></pre></div>
<pre><code>## Units: [m^2]
## [1] 477791738 119343215  58289370  87034244</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="sect012.html#cb63-1" tabindex="-1"></a><span class="do">## Ajout de champs de superficie dans la table attributaire</span></span>
<span id="cb63-2"><a href="sect012.html#cb63-2" tabindex="-1"></a>Arrondissements<span class="sc">$</span>SupM2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(<span class="fu">st_transform</span>(Arrondissements, <span class="at">crs =</span> <span class="dv">2949</span>)))</span>
<span id="cb63-3"><a href="sect012.html#cb63-3" tabindex="-1"></a>Arrondissements<span class="sc">$</span>SupKm2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(<span class="fu">st_transform</span>(Arrondissements, <span class="at">crs =</span> <span class="dv">2949</span>)))<span class="sc">/</span><span class="dv">1000000</span></span>
<span id="cb63-4"><a href="sect012.html#cb63-4" tabindex="-1"></a><span class="fu">head</span>(Arrondissements, <span class="at">n=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 2 features and 4 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -8027109 ymin: 5668860 xmax: -8000502 ymax: 5704391
## Projected CRS: WGS 84 / Pseudo-Mercator
##   NUMERO                                                         NOM
## 1      1 Arrondissement de Brompton–Rock Forest–Saint-Élie–Deauville
## 2      4                                  Arrondissement des Nations
##                         geometry     SupM2    SupKm2
## 1 POLYGON ((-8005013 5702777,... 235580454 235.58045
## 2 POLYGON ((-8005680 5690860,...  58861606  58.86161</code></pre>
<p>De manière très semblable, calculons la longueur de géométries étant des lignes ou des multilignes.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="sect012.html#cb65-1" tabindex="-1"></a><span class="do">## Longueurs en mètres</span></span>
<span id="cb65-2"><a href="sect012.html#cb65-2" tabindex="-1"></a>PistesCyclables<span class="sc">$</span>longMetre <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_length</span>(<span class="fu">st_transform</span>(PistesCyclables, <span class="at">crs =</span> <span class="dv">2949</span>)))</span>
<span id="cb65-3"><a href="sect012.html#cb65-3" tabindex="-1"></a>PistesCyclables<span class="sc">$</span>longKm <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_length</span>(<span class="fu">st_transform</span>(PistesCyclables, <span class="at">crs =</span> <span class="dv">2949</span>)))<span class="sc">/</span><span class="dv">10000</span></span>
<span id="cb65-4"><a href="sect012.html#cb65-4" tabindex="-1"></a><span class="fu">head</span>(PistesCyclables, <span class="at">n=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 2 features and 5 fields
## Geometry type: MULTILINESTRING
## Dimension:     XY
## Bounding box:  xmin: -8010969 ymin: 5666202 xmax: -7997972 ymax: 5697954
## Projected CRS: WGS 84 / Pseudo-Mercator
##                        NOM OBJECTID SHAPE__Len                       geometry
## 1     Axe de la Massawippi        1   13944.09 MULTILINESTRING ((-8010969 ...
## 2 Axe de la Saint-François        2   19394.28 MULTILINESTRING ((-8001909 ...
##   longMetre    longKm
## 1  9807.769 0.9807769
## 2 13602.324 1.3602324</code></pre>
<p>Pour calculer la longueur d’un périmètre, il faut préalablement récupérer son contour avec la méthode <code>st_boundary</code>, puis calculer la longueur avec <code>st_length</code>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="sect012.html#cb67-1" tabindex="-1"></a><span class="do">## Conversion des polygones en lignes</span></span>
<span id="cb67-2"><a href="sect012.html#cb67-2" tabindex="-1"></a>Arrond.Contour <span class="ot">&lt;-</span> <span class="fu">st_boundary</span>(Arrondissements)</span>
<span id="cb67-3"><a href="sect012.html#cb67-3" tabindex="-1"></a><span class="do">## Calcul de la longueur et enregistrement dans deux nouveaux champs</span></span>
<span id="cb67-4"><a href="sect012.html#cb67-4" tabindex="-1"></a>Arrondissements<span class="sc">$</span>PerimetreMetre <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_length</span>(Arrond.Contour))</span>
<span id="cb67-5"><a href="sect012.html#cb67-5" tabindex="-1"></a>Arrondissements<span class="sc">$</span>PerimetreKm <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_length</span>(Arrond.Contour)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb67-6"><a href="sect012.html#cb67-6" tabindex="-1"></a><span class="fu">head</span>(Arrondissements)</span></code></pre></div>
<pre><code>## Simple feature collection with 4 features and 6 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -8027109 ymin: 5668860 xmax: -7993013 ymax: 5704391
## Projected CRS: WGS 84 / Pseudo-Mercator
##   NUMERO                                                         NOM
## 1      1 Arrondissement de Brompton–Rock Forest–Saint-Élie–Deauville
## 2      4                                  Arrondissement des Nations
## 3      3                               Arrondissement de Lennoxville
## 4      2                                Arrondissement de Fleurimont
##                         geometry     SupM2    SupKm2 PerimetreMetre PerimetreKm
## 1 POLYGON ((-8005013 5702777,... 235580454 235.58045      143771.63   143.77163
## 2 POLYGON ((-8005680 5690860,...  58861606  58.86161       50476.65    50.47665
## 3 POLYGON ((-7993443 5684778,...  28776861  28.77686       43531.03    43.53103
## 4 POLYGON ((-7999483 5693167,...  42882506  42.88251       44172.25    44.17225</code></pre>
<p>Calculons désormais la distance 2D (euclidienne) entre les centres des arrondissements. Nous utilisons donc la fonction <code>st_distance(x)</code>, puisque nous avons une seule couche (<code>x = Arrond.pointpoly</code>).</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="sect012.html#cb69-1" tabindex="-1"></a><span class="do">## Longueurs en mètres</span></span>
<span id="cb69-2"><a href="sect012.html#cb69-2" tabindex="-1"></a><span class="fu">st_distance</span>(Arrond.pointpoly)</span></code></pre></div>
<pre><code>## Units: [m]
##          1         2         3         4
## 1     0.00 10458.989 21787.479 18047.846
## 2 10458.99     0.000 11555.203  8627.962
## 3 21787.48 11555.203     0.000  9622.735
## 4 18047.85  8627.962  9622.735     0.000</code></pre>
<p>Admettons que nous souhaitons calculer la distance entre les centres des quatre arrondissements et l’hôtel de ville de Sherbrooke dont les coordonnées en degrés (WGS84, EPSG : 4326) sont les suivantes : -71.89306, 45.40417. Nous utilisons alors la fonction <code>st_distance(x, y)</code> dans laquelle les paramètres <code>x</code> et <code>y</code> sont les arrondissements et l’hôtel de ville. Quelques lignes de code suffisent à créer une couche pour l’hôtel de ville, à calculer les distances et à les stocker dans un nouveau champ attributaire de la couche arrondissement.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="sect012.html#cb71-1" tabindex="-1"></a><span class="do">## Création d&#39;un objet sf pour l&#39;hôtel de ville</span></span>
<span id="cb71-2"><a href="sect012.html#cb71-2" tabindex="-1"></a>HotelVille <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="dv">1</span>,</span>
<span id="cb71-3"><a href="sect012.html#cb71-3" tabindex="-1"></a>                         <span class="at">Nom =</span> <span class="st">&quot;Hôtel de ville&quot;</span>,</span>
<span id="cb71-4"><a href="sect012.html#cb71-4" tabindex="-1"></a>                         <span class="at">lon =</span> <span class="sc">-</span><span class="fl">71.89306</span>,</span>
<span id="cb71-5"><a href="sect012.html#cb71-5" tabindex="-1"></a>                         <span class="at">lat =</span> <span class="fl">45.40417</span>)</span>
<span id="cb71-6"><a href="sect012.html#cb71-6" tabindex="-1"></a>HotelVille <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(HotelVille, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb71-7"><a href="sect012.html#cb71-7" tabindex="-1"></a><span class="fu">head</span>(HotelVille)</span></code></pre></div>
<pre><code>## Simple feature collection with 1 feature and 2 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -71.89306 ymin: 45.40417 xmax: -71.89306 ymax: 45.40417
## Geodetic CRS:  WGS 84
##   ID            Nom                   geometry
## 1  1 Hôtel de ville POINT (-71.89306 45.40417)</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="sect012.html#cb73-1" tabindex="-1"></a><span class="do">## Nous nous assurons que les deux couches ont la même projection</span></span>
<span id="cb73-2"><a href="sect012.html#cb73-2" tabindex="-1"></a>HotelVille <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(HotelVille, <span class="fu">st_crs</span>(Arrond.pointpoly))</span>
<span id="cb73-3"><a href="sect012.html#cb73-3" tabindex="-1"></a><span class="do">## Calcul des distances</span></span>
<span id="cb73-4"><a href="sect012.html#cb73-4" tabindex="-1"></a>Arrondissements<span class="sc">$</span>DistHVMetre <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_distance</span>(Arrond.pointpoly,HotelVille))</span>
<span id="cb73-5"><a href="sect012.html#cb73-5" tabindex="-1"></a>Arrondissements<span class="sc">$</span>DistHVKm <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_distance</span>(Arrond.pointpoly,</span>
<span id="cb73-6"><a href="sect012.html#cb73-6" tabindex="-1"></a>                                                   HotelVille)) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb73-7"><a href="sect012.html#cb73-7" tabindex="-1"></a><span class="fu">head</span>(Arrondissements)</span></code></pre></div>
<pre><code>## Simple feature collection with 4 features and 8 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -8027109 ymin: 5668860 xmax: -7993013 ymax: 5704391
## Projected CRS: WGS 84 / Pseudo-Mercator
##   NUMERO                                                         NOM
## 1      1 Arrondissement de Brompton–Rock Forest–Saint-Élie–Deauville
## 2      4                                  Arrondissement des Nations
## 3      3                               Arrondissement de Lennoxville
## 4      2                                Arrondissement de Fleurimont
##                         geometry     SupM2    SupKm2 PerimetreMetre PerimetreKm
## 1 POLYGON ((-8005013 5702777,... 235580454 235.58045      143771.63   143.77163
## 2 POLYGON ((-8005680 5690860,...  58861606  58.86161       50476.65    50.47665
## 3 POLYGON ((-7993443 5684778,...  28776861  28.77686       43531.03    43.53103
## 4 POLYGON ((-7999483 5693167,...  42882506  42.88251       44172.25    44.17225
##   DistHVMetre  DistHVKm
## 1   14661.518 14.661518
## 2    4662.164  4.662164
## 3    9058.677  9.058677
## 4    4050.374  4.050374</code></pre>
<p>Il est fréquent de vouloir enregistrer les coordonnées géographiques dans des champs attributaires. Dans le code ci-dessous, nous créons deux champs (<code>x</code> et <code>y</code>) dans lesquels nous enregistrons les coordonnées géographiques des points au centre de la surface de chaque arrondissement. Pour ce faire, nous utilisons la méthode <code>st_coordinates</code> .</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="sect012.html#cb75-1" tabindex="-1"></a><span class="do">## Coordonnées des centres de la surface des polygones</span></span>
<span id="cb75-2"><a href="sect012.html#cb75-2" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_point_on_surface</span>(Arrondissements))</span>
<span id="cb75-3"><a href="sect012.html#cb75-3" tabindex="-1"></a><span class="fu">head</span>(xy)</span></code></pre></div>
<pre><code>##             X       Y
## [1,] -8017707 5686628
## [2,] -8007570 5684053
## [3,] -7997637 5678149
## [4,] -7999683 5687552</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="sect012.html#cb77-1" tabindex="-1"></a><span class="do">## Enregistrement dans la couche Arrondissements. Notez que :</span></span>
<span id="cb77-2"><a href="sect012.html#cb77-2" tabindex="-1"></a><span class="do">## xy[,1] signale de récupérer toutes les valeurs de la première colonne, soit X</span></span>
<span id="cb77-3"><a href="sect012.html#cb77-3" tabindex="-1"></a><span class="do">## xy[,2] signale de récupérer toutes les valeurs de la deuxième colonne, soit Y</span></span>
<span id="cb77-4"><a href="sect012.html#cb77-4" tabindex="-1"></a>Arrondissements<span class="sc">$</span>X <span class="ot">&lt;-</span> xy[,<span class="dv">1</span>] </span>
<span id="cb77-5"><a href="sect012.html#cb77-5" tabindex="-1"></a>Arrondissements<span class="sc">$</span>Y <span class="ot">&lt;-</span> xy[,<span class="dv">2</span>]</span></code></pre></div>
</div>
<div id="sect0125" class="section level3 hasAnchor" number="1.2.5">
<h3><span class="header-section-number">1.2.5</span> Jointures spatiales<a href="sect012.html#sect0125" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En géomatique, il est fréquent de réaliser des jointures spatiales, soit une opération qui consiste à joindre les attributs d’une couche géographique à une autre à partir d’une relation spatiale. Prenons deux exemples construits avec les installations sportives et récréatives (couche <code>InstallationSport</code>) et les arrondissements de la ville de Sherbrooke (<code>Arrondissements</code>).</p>
<p>Premièrement, pour les installations sportives et récréatives (couche <code>InstallationSport</code>), nous souhaitons ajouter dans la table attributaire les champs <code>NUMERO</code> et <code>NOM</code> issus de la couche des arrondissements de la ville de Sherbrooke (<code>Arrondissements</code>). Grâce à ces deux champs, nous pouvons connaître dans quel arrondissement chaque installation sportive est située.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="sect012.html#cb78-1" tabindex="-1"></a><span class="do">## Jointure spatiale avec le paramètre st_intersects</span></span>
<span id="cb78-2"><a href="sect012.html#cb78-2" tabindex="-1"></a>InstallS.join <span class="ot">&lt;-</span> <span class="fu">st_join</span>(InstallationSport, Arrondissements, <span class="at">join =</span> st_intersects)</span>
<span id="cb78-3"><a href="sect012.html#cb78-3" tabindex="-1"></a><span class="do">## Visualisation des deux premiers enregistrements</span></span>
<span id="cb78-4"><a href="sect012.html#cb78-4" tabindex="-1"></a><span class="fu">head</span>(InstallS.join, <span class="at">n=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 2 features and 16 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -8009681 ymin: 5686891 xmax: -8001939 ymax: 5696536
## Projected CRS: WGS 84 / Pseudo-Mercator
##    TYPE DETAIL                   NOM.x SURFACE ECLAIRAGE OBJECTID NUMERO
## 1 Aréna   &lt;NA&gt;    Aréna Eugène-Lalonde    &lt;NA&gt;      &lt;NA&gt;        1      2
## 2 Aréna   &lt;NA&gt; Aréna Philippe-Bergeron    &lt;NA&gt;      &lt;NA&gt;        2      1
##                                                         NOM.y     SupM2
## 1                                Arrondissement de Fleurimont  42882506
## 2 Arrondissement de Brompton–Rock Forest–Saint-Élie–Deauville 235580454
##      SupKm2 PerimetreMetre PerimetreKm DistHVMetre  DistHVKm        X       Y
## 1  42.88251       44172.25    44.17225    4050.374  4.050374 -7999683 5687552
## 2 235.58045      143771.63   143.77163   14661.518 14.661518 -8017707 5686628
##                   geometry
## 1 POINT (-8001939 5686891)
## 2 POINT (-8009681 5696536)</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="sect012.html#cb80-1" tabindex="-1"></a><span class="do">## Suppression des champs utiles</span></span>
<span id="cb80-2"><a href="sect012.html#cb80-2" tabindex="-1"></a>InstallS.join[<span class="fu">c</span>(<span class="st">&quot;SupM2&quot;</span>, <span class="st">&quot;SupKm2&quot;</span>, <span class="st">&quot;PerimetreMetre&quot;</span>, </span>
<span id="cb80-3"><a href="sect012.html#cb80-3" tabindex="-1"></a>                       <span class="st">&quot;PerimetreKm&quot;</span>, <span class="st">&quot;DistHVMetre&quot;</span>,  <span class="st">&quot;DistHVKm&quot;</span>)] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb80-4"><a href="sect012.html#cb80-4" tabindex="-1"></a><span class="do">## Modification des noms de champs : NOM.x et NOM.y</span></span>
<span id="cb80-5"><a href="sect012.html#cb80-5" tabindex="-1"></a><span class="fu">names</span>(InstallS.join)[<span class="fu">names</span>(InstallS.join) <span class="sc">==</span> <span class="st">&quot;NOM.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;NomInstallation&quot;</span></span>
<span id="cb80-6"><a href="sect012.html#cb80-6" tabindex="-1"></a><span class="fu">names</span>(InstallS.join)[<span class="fu">names</span>(InstallS.join) <span class="sc">==</span> <span class="st">&quot;NOM.y&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;NomArrondissement&quot;</span></span>
<span id="cb80-7"><a href="sect012.html#cb80-7" tabindex="-1"></a><span class="fu">head</span>(InstallS.join, <span class="at">n=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 2 features and 10 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -8009681 ymin: 5686891 xmax: -8001939 ymax: 5696536
## Projected CRS: WGS 84 / Pseudo-Mercator
##    TYPE DETAIL         NomInstallation SURFACE ECLAIRAGE OBJECTID NUMERO
## 1 Aréna   &lt;NA&gt;    Aréna Eugène-Lalonde    &lt;NA&gt;      &lt;NA&gt;        1      2
## 2 Aréna   &lt;NA&gt; Aréna Philippe-Bergeron    &lt;NA&gt;      &lt;NA&gt;        2      1
##                                             NomArrondissement        X       Y
## 1                                Arrondissement de Fleurimont -7999683 5687552
## 2 Arrondissement de Brompton–Rock Forest–Saint-Élie–Deauville -8017707 5686628
##                   geometry
## 1 POINT (-8001939 5686891)
## 2 POINT (-8009681 5696536)</code></pre>
<p>Deuxièmement, une autre jointure classique consiste à de dénombrer les points compris dans des polygones, soit une opération SIG communément appelée <em>POINT-IN-POLYGON</em>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="sect012.html#cb82-1" tabindex="-1"></a><span class="do">## Sélection des points dans les polygones des arrondissements</span></span>
<span id="cb82-2"><a href="sect012.html#cb82-2" tabindex="-1"></a><span class="do">## Notez que la relation spatiale pour la jointure est st_contains</span></span>
<span id="cb82-3"><a href="sect012.html#cb82-3" tabindex="-1"></a><span class="do">## Nous aurions pu aussi utiliser st_intersects</span></span>
<span id="cb82-4"><a href="sect012.html#cb82-4" tabindex="-1"></a>Arrondissements<span class="sc">$</span>NbInstall <span class="ot">=</span> <span class="fu">lengths</span>(<span class="fu">st_contains</span>(Arrondissements, InstallationSport))</span>
<span id="cb82-5"><a href="sect012.html#cb82-5" tabindex="-1"></a><span class="fu">head</span>(Arrondissements<span class="sc">$</span>NbInstall)</span></code></pre></div>
<pre><code>## [1] 125 166  29 116</code></pre>
<div class="bloc_aller_loin">
<p><strong>Autres relations spatiales à appliquer lors de la jointure spatiale</strong></p>
<p>Avec le paramètre <code>join</code> de la méthode <code>st_join</code>, il est possible de spécifier la jointure spatiale avec différentes méthodes : <code>st_contains_properly</code>, <code>st_contains</code>, <code>st_covered_by</code>, <code>st_covers</code>, <code>st_crosses</code>, <code>st_disjoint</code>, <code>st_equals_exact</code>, <code>st_equals</code>, <code>st_is_within_distance</code>, <code>st_nearest_feature</code>,<code>st_overlaps</code>, <code>st_touches</code> et <code>st_within</code>.</p>
<p>N’hésitez pas à consulter la documentation de la fonction en tapant<code>?st_join</code> dans la console R.</p>
</div>
</div>
<div id="sect0126" class="section level3 hasAnchor" number="1.2.6">
<h3><span class="header-section-number">1.2.6</span> Requêtes spatiales<a href="sect012.html#sect0126" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans un logiciel SIG, la sélection d’entités spatiales par localisation est une opération courante, équivalente à <em>Select By Location</em> dans ArcGis Pro ou <em>Sélection par localisation</em> dans QGIS.</p>
<p>Le <em>package</em> <code>sf</code> permet de réaliser des requêtes spatiales avec notamment les méthodes suivantes :</p>
<ul>
<li><p><code>st_contains(x, y)</code> renvoie les géométries de <code>x</code> qui contiennent celles de <code>y</code>. Cette fonction est donc l’inverse de <code>st_within</code>.</p></li>
<li><p><code>st_disjoint(x, y)</code> renvoie les géométries de <code>x</code> qui ne partagent aucune portion de celles de <code>y</code>. Cette fonction est donc l’inverse de <code>st_intersects(x, y)</code>.</p></li>
<li><p><code>st_equals(x, y)</code> renvoie les géométries de <code>x</code> qui sont identiques à celles de <code>y</code>.</p></li>
<li><p><code>st_intersects(x, y)</code> renvoie les géométries de <code>x</code> qui partagent au moins une partie de celles de <code>y</code>. Elle est donc l’inverse de <code>st_disjoints(x, y)</code>.</p></li>
<li><p><code>st_nearest_feature(x, y)</code> renvoie pour chaque géométrie <code>x</code>, la géométrie de <code>y</code> qui est la plus proche.</p></li>
<li><p><code>st_overlaps(x, y)</code> cette fonction est très semblable à <code>st_intersects(x, y)</code>. Toutefois, les types de géométries de <code>x</code> et de <code>y</code> doivent être identiques, c’est-à-dire deux couches de lignes ou de couches de polygones. Aussi, une géométrie ne peut pas contenir complètement l’autre comme avec <code>st_within(x, y)</code> et <code>st_contains(x, y)</code>.</p></li>
<li><p><code>st_touches(x, y)</code> renvoie les géométries de <code>x</code> qui sont tangentes à celles de <code>x</code> sans qu’elles se chevauchent. Par exemple, deux arrondissements peuvent se toucher, c’est-à-dire qu’ils partagent une frontière commune sans que l’un chevauche l’autre.</p></li>
<li><p><code>st_within(x, y)</code> renvoie les géométries de <code>x</code> qui sont comprises intégralement dans celles de <code>y</code>. Cette fonction est donc l’inverse de <code>st_contains(x, y)</code>.</p></li>
<li><p><code>st_within_distance(x, y, dist =)</code> renvoie les géométries de <code>x</code> qui sont situées à une certaine distance euclidienne de celles de <code>y</code>.</p></li>
</ul>
<div class="bloc_astuce">
<p><strong>Modification de l’affichage du résultat de la requête spatiale : le paramètre</strong> <code>sparse</code></p>
<p>Par défaut, le résultat d’une requête spatiale renvoie une liste d’indices pour les géométries <code>x</code> et <code>y</code>. Il est aussi possible de renvoyer la matrice complète entre <code>x</code> et <code>y</code>, avec les valeurs <code>TRUE</code> quand la relation spatiale est vérifiée et <code>FALSE</code> pour une situation inverse.</p>
<p>Prenons deux exemples pour illustrer le tout.</p>
<p>La figure ci-dessous représente les quatre arrondissements de la ville de Sherbrooke. Notez que les numéros correspondent aux indices des géométries.</p>
<pre><code>##   NUMERO                                                         NOM
## 1      1 Arrondissement de Brompton–Rock Forest–Saint-Élie–Deauville
## 2      4                                  Arrondissement des Nations
## 3      3                               Arrondissement de Lennoxville
## 4      2                                Arrondissement de Fleurimont</code></pre>
<p><img src="GMQ405_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>Appliquons une requête spatiale entre les arrondissements avec <code>st_intersects</code> et <code>sparse = TRUE</code>. Pour chaque arrondissement, nous obtenons une liste des arrondissements qui l’intersectent.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="sect012.html#cb85-1" tabindex="-1"></a><span class="fu">st_intersects</span>(Arrondissements, Arrondissements, <span class="at">sparse =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Sparse geometry binary predicate list of length 4, where the predicate
## was `intersects&#39;
##  1: 1, 2, 4
##  2: 1, 2, 3, 4
##  3: 2, 3, 4
##  4: 1, 2, 3, 4</code></pre>
<p>Avec <code>sparse = FALSE</code>, nous obtenons une matrice complète de dimension 4 X 4 arrondissements. Nous constatons que l’arrondissement <code>1</code> intersecte lui-même (évidemment!) et les arrondissements <code>2</code> et <code>4</code>, mais il n’intersecte pas le <code>3</code>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="sect012.html#cb87-1" tabindex="-1"></a><span class="fu">st_intersects</span>(Arrondissements, Arrondissements, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##       [,1] [,2]  [,3] [,4]
## [1,]  TRUE TRUE FALSE TRUE
## [2,]  TRUE TRUE  TRUE TRUE
## [3,] FALSE TRUE  TRUE TRUE
## [4,]  TRUE TRUE  TRUE TRUE</code></pre>
</div>
<p>Construisons des requêtes plus complexes comprenant deux couches.</p>
<p>Premièrement, écrivons une requête spatiale pour sélectionner les segments des pistes cyclables qui intersectent le parc du Mont-Bellevue. Pour ce faire, nous utilisons la fonction <code>st_intersects</code> avec l’argument <code>sparse = FALSE</code> et enregistrons le résultat dans un nouveau champ dénommé <code>ParcMB.intersect</code> qui prendra les valeurs <code>TRUE</code> ou <code>FALSE</code>.</p>
<p><img src="GMQ405_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="sect012.html#cb89-1" tabindex="-1"></a><span class="do">## Intersection</span></span>
<span id="cb89-2"><a href="sect012.html#cb89-2" tabindex="-1"></a>RequeteSpatiale <span class="ot">&lt;-</span> <span class="fu">st_intersects</span>(PistesCyclables, MontBellevue, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-3"><a href="sect012.html#cb89-3" tabindex="-1"></a><span class="fu">head</span>(RequeteSpatiale)</span></code></pre></div>
<pre><code>##       [,1]
## [1,] FALSE
## [2,] FALSE
## [3,] FALSE
## [4,] FALSE
## [5,] FALSE
## [6,] FALSE</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="sect012.html#cb91-1" tabindex="-1"></a><span class="do">## Création d&#39;un nouveau champ</span></span>
<span id="cb91-2"><a href="sect012.html#cb91-2" tabindex="-1"></a>PistesCyclables<span class="sc">$</span>ParcMB.intersect <span class="ot">&lt;-</span> RequeteSpatiale[, <span class="dv">1</span>]</span>
<span id="cb91-3"><a href="sect012.html#cb91-3" tabindex="-1"></a><span class="fu">head</span>(PistesCyclables)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 6 fields
## Geometry type: MULTILINESTRING
## Dimension:     XY
## Bounding box:  xmin: -8010969 ymin: 5666202 xmax: -7997216 ymax: 5697954
## Projected CRS: WGS 84 / Pseudo-Mercator
##                        NOM OBJECTID  SHAPE__Len                       geometry
## 1     Axe de la Massawippi        1 13944.08678 MULTILINESTRING ((-8010969 ...
## 2 Axe de la Saint-François        2 19394.27693 MULTILINESTRING ((-8001909 ...
## 3   Axe du Ruisseau-Dorman        3 16337.23985 MULTILINESTRING ((-7999121 ...
## 4        Réseau utilitaire        4   467.23254 MULTILINESTRING ((-8000179 ...
## 5        Réseau utilitaire        5    15.57987 MULTILINESTRING ((-8004036 ...
## 6        Réseau utilitaire        6   823.83428 MULTILINESTRING ((-8003649 ...
##     longMetre      longKm ParcMB.intersect
## 1  9807.76890 0.980776890            FALSE
## 2 13602.32404 1.360232404            FALSE
## 3 11469.13476 1.146913476            FALSE
## 4   327.46928 0.032746928            FALSE
## 5    10.95083 0.001095083            FALSE
## 6   578.59143 0.057859143            FALSE</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="sect012.html#cb93-1" tabindex="-1"></a><span class="do">## Nous constatons qu&#39;un seul segment intersecte le parc</span></span>
<span id="cb93-2"><a href="sect012.html#cb93-2" tabindex="-1"></a><span class="fu">table</span>(PistesCyclables<span class="sc">$</span>ParcMB.intersect)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   272     1</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="sect012.html#cb95-1" tabindex="-1"></a><span class="do">## Création d&#39;une nouvelle couche pour la sélection</span></span>
<span id="cb95-2"><a href="sect012.html#cb95-2" tabindex="-1"></a>PistesCyclables.Selection <span class="ot">&lt;-</span> PistesCyclables[PistesCyclables<span class="sc">$</span>ParcMB.intersect<span class="sc">==</span> <span class="cn">TRUE</span>, ]</span>
<span id="cb95-3"><a href="sect012.html#cb95-3" tabindex="-1"></a><span class="do">## Visualisation</span></span>
<span id="cb95-4"><a href="sect012.html#cb95-4" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span>
<span id="cb95-5"><a href="sect012.html#cb95-5" tabindex="-1"></a><span class="fu">tm_shape</span>(MontBellevue) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="at">col=</span><span class="st">&quot;lightgreen&quot;</span>)<span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb95-6"><a href="sect012.html#cb95-6" tabindex="-1"></a><span class="fu">tm_shape</span>(PistesCyclables.Selection)<span class="sc">+</span><span class="fu">tm_lines</span>(<span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-84793d6f04bd623f354b" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-84793d6f04bd623f354b">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"createMapPane","args":["tmap402",402]},{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,"Esri.WorldGrayCanvas",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addPolygons","args":[[[[{"lng":[-71.9131628087156,-71.912965729122,-71.9129607102346,-71.9125720154993,-71.9124523464288,-71.9120118359696,-71.9117397407616,-71.9117224895149,-71.9112560572699,-71.9112505371225,-71.9110811355212,-71.9104943568759,-71.9104808578921,-71.9107150172457,-71.9106059959062,-71.9104851078217,-71.9102744331247,-71.9100181294011,-71.9100328626701,-71.9098383836993,-71.9096439038301,-71.9094494113846,-71.9092549315155,-71.9090604399683,-71.9088659600991,-71.9086714676536,-71.9084769913778,-71.9082825079154,-71.9080880154698,-71.9078935356007,-71.9076990431552,-71.9073100708405,-71.9071156035478,-71.907096200836,-71.9072894859458,-71.9072800787881,-71.9065030971528,-71.9061520885404,-71.9061621559598,-71.9061642292714,-71.906170342307,-71.9061808139682,-71.9058461708636,-71.9053367335711,-71.9053355819309,-71.9053343171029,-71.9053329417822,-71.9053314550705,-71.9053298587642,-71.9053281510668,-71.9053263346733,-71.9053244086854,-71.9053223748996,-71.9053202333159,-71.9053179839345,-71.9053156285518,-71.9053131671679,-71.9053106006811,-71.9053079299898,-71.9053051550939,-71.9053022795866,-71.9052993016715,-71.9052962222467,-71.9052930422106,-71.9052897660548,-71.9052863892876,-71.905282917299,-71.9052793491907,-71.905275685861,-71.9052719291065,-71.9052680807238,-71.9052641398146,-71.905260109074,-71.9052559894001,-71.9052517834879,-71.9052474904392,-71.9052431129488,-71.9052386510167,-71.9052341064397,-71.9052294810143,-71.9052247756389,-71.9052199939066,-71.9052151349193,-71.9052102004734,-71.9052051923657,-71.9052001123928,-71.9051949614529,-71.9051897404445,-71.905184453859,-71.9051791007983,-71.9051736848554,-71.9051682051322,-71.9051626643235,-71.905157064226,-71.9051514075347,-71.9051456942495,-71.9051399270654,-71.9051341077789,-71.9051282390852,-71.9051223200858,-71.9051163552723,-71.9051103446447,-71.9051042917963,-71.9050981976254,-71.9050920630304,-71.9050858907061,-71.9050796824491,-71.9050734409545,-71.9050671671206,-71.9050608645406,-71.9050545323161,-71.9050481740406,-71.9050417915105,-71.9050353865225,-71.9050289617716,-71.905022518156,-71.9050160583708,-71.9050095833143,-71.9050030965796,-71.9049965981668,-71.9049900925675,-71.9049835797817,-71.9049770625043,-71.9049705434303,-71.9049601984315,-71.9034022744888,-71.9033812952336,-71.9033656753275,-71.9033500599129,-71.9033344543798,-71.903318864118,-71.9033032927209,-71.9032877464766,-71.9032722280801,-71.9032567438195,-71.9032412972882,-71.9032258947743,-71.9032105389729,-71.903195236172,-71.903179989965,-71.9031648057418,-71.9031496879938,-71.9031346403145,-71.903119668992,-71.9031047767212,-71.9030899706887,-71.9030752526911,-71.9030606281182,-71.9030461023601,-71.9030316790099,-71.9030173616609,-71.903003155703,-71.9029890674244,-71.9029750968251,-71.9029612510916,-71.9029475329189,-71.9029339476969,-71.9029204981205,-71.9029071913761,-71.902894027464,-71.9028810144687,-71.9028681532888,-71.9028554484158,-71.9028429034428,-71.9028305246582,-71.9028183120619,-71.9028062728405,-71.9027944078922,-71.9027827235053,-71.9027712214764,-71.9027599053988,-71.9022578154269,-71.9020495823508,-71.9022086928522,-71.902522722316,-71.9026312558703,-71.9029534815627,-71.9028152820445,-71.9028918131168,-71.9030647693517,-71.9031776453621,-71.9032396336083,-71.9024957423148,-71.9025121042293,-71.902908592748,-71.9032680428291,-71.903331970538,-71.9038836016995,-71.9040415668489,-71.9033668440356,-71.9034888711839,-71.9037209329712,-71.9037946172824,-71.904078159722,-71.9042628623276,-71.9042874339456,-71.9043868325317,-71.9042201851651,-71.9044656605962,-71.9042784633691,-71.9043685060016,-71.9044213547881,-71.9046033354984,-71.9047593441171,-71.9048394262298,-71.9048959095999,-71.9049527325332,-71.905009876165,-71.9050673243258,-71.9051250608457,-71.9051830659619,-71.9052413226064,-71.9052998155078,-71.9053585231066,-71.9054174283347,-71.9054765141242,-71.9056709607557,-71.9057256645632,-71.9057431978809,-71.9062556166819,-71.9065118233875,-71.9067680318897,-71.9068961963279,-71.9069227595108,-71.9070519282655,-71.907308137666,-71.9074912834912,-71.9078227070338,-71.9082111816818,-71.9081937058563,-71.90817883784,-71.9081771301426,-71.9081934264802,-71.9083321389365,-71.9083398851092,-71.9083475845695,-71.9083552346225,-71.9083628325731,-71.9083703766249,-71.9083778631845,-71.9083852904552,-71.9083926584372,-71.9083999626388,-71.908407200365,-71.9084143707176,-71.9084214718999,-71.9084285003187,-71.908435453279,-71.9084423325775,-71.9084491310275,-71.9084558513242,-71.9084624871792,-71.9084690385925,-71.9084755028693,-71.9084818809078,-71.9084881637249,-71.9084943603038,-71.9085004589662,-71.9085064624073,-71.9085123679319,-71.908518171947,-71.9085238771474,-71.9085294772449,-71.9085349722395,-71.9085403612328,-71.9085456415301,-71.9085508131312,-71.9085558715445,-71.9085608176685,-71.9085656497064,-71.9085703658616,-71.9085775559772,-71.9085819487389,-71.9085862184315,-71.9085903677498,-71.9085943922022,-71.9085982926872,-71.9086020647131,-71.9086057118731,-71.9086092296758,-71.908612618121,-71.9086158754123,-71.9086190015494,-71.908621994736,-71.9086248567685,-71.9086275831554,-71.9086301729983,-71.908632628094,-71.908634947544,-71.9086371295519,-71.9086391714225,-71.9086410767492,-71.9086428419388,-71.9086444669911,-71.9086459528046,-71.9086472975826,-71.9086485004268,-71.908649564032,-71.9086504839069,-71.9086512636446,-71.9086518978551,-71.9086527278985,-71.9086587106782,-71.9086740053943,-71.9086829050038,-71.9087154321019,-71.9087469270358,-71.9087638243463,-71.9087773799239,-71.9088067799865,-71.9088351173422,-71.9088623874993,-71.9088885787797,-71.9089184199151,-71.9089197305571,-71.9089434658435,-71.9089660971005,-71.9089876198364,-71.9090080268647,-71.9090273101006,-71.9090454668491,-71.9090624890254,-71.9090783712396,-71.9090931098985,-71.9091148572132,-71.9091402022806,-71.9094489676169,-71.9095861295809,-71.9096341786689,-71.9096603259318,-71.9096878476172,-71.9097167329452,-71.9097469747292,-71.9097785621895,-71.909811486343,-71.9098457364098,-71.9101793868761,-71.9102411020344,-71.9102472761553,-71.9102899245718,-71.9103399274954,-71.9103910973306,-71.9110992078281,-71.9122220210849,-71.9132278781832,-71.9136648941959,-71.9149075804408,-71.9157186764974,-71.9184993512722,-71.9192618053528,-71.9204787377968,-71.9210997027285,-71.9240732413033,-71.9241247776512,-71.9285071647473,-71.9325919741258,-71.9325961027828,-71.9325918851926,-71.9326029371655,-71.9260413575644,-71.9201604134877,-71.9207220276269,-71.9210496144649,-71.9192937269864,-71.9169104300623,-71.9169750602537,-71.9163974300513,-71.9149441831954,-71.9149339352146,-71.9149321817032,-71.9149303886659,-71.9149214369541,-71.9149092054932,-71.9145026450635,-71.9141144273337,-71.9141346196647,-71.913551543875,-71.9131628087156],"lat":[45.3847940937772,45.3847857908096,45.3848509842152,45.3848374698233,45.385042355102,45.3850270337954,45.3850175750127,45.3852915358472,45.3852753174411,45.3852751256417,45.3852692360108,45.3852488232459,45.3849751252991,45.3849837153087,45.3848079861032,45.3847214004968,45.3847220225892,45.3847245992883,45.3850429008493,45.3850472908028,45.3850516712922,45.3850560606141,45.3850604404718,45.3850648291622,45.3850692172212,45.385073596447,45.3850779838744,45.3850823706706,45.3850867486336,45.3850911265962,45.3850955215933,45.385104284457,45.3851086605255,45.3848344603155,45.3848221541396,45.3846414300199,45.3846573463942,45.384644841438,45.3842335511302,45.3841492896275,45.3839004016485,45.3834734933341,45.3834790531708,45.3834875191127,45.3834829965408,45.3834784884802,45.3834739968236,45.383469522833,45.3834650677702,45.3834606322662,45.3834562194756,45.3834518293986,45.3834474632968,45.3834431230633,45.3834388099599,45.3834345252484,45.3834302701907,45.3834260460488,45.3834218540845,45.3834176949287,45.3834135711053,45.3834094838762,45.3834054326103,45.3834014204624,45.3833974486944,45.3833935173063,45.3833896275599,45.3833857813481,45.3833819805639,45.3833782239452,45.3833745152776,45.3833708532995,45.3833672411654,45.3833636788753,45.3833601683223,45.383356710137,45.3833533043195,45.3833499533938,45.3833466573597,45.38334341811,45.3833402362757,45.3833371137497,45.3833340486392,45.3833310447298,45.3833281026524,45.3833252217762,45.3833224033629,45.3833196493054,45.3833169602349,45.383314336151,45.383311777685,45.3833092873604,45.3833068645464,45.383304509874,45.3833022246051,45.3833000093705,45.3832978648012,45.3832957908973,45.3832937889206,45.383291860764,45.3832900039037,45.3832882214943,45.3832865135361,45.3832848800289,45.3832833216036,45.3832818388913,45.3832804325228,45.3832791024982,45.3832778500794,45.3832766740045,45.3832755767973,45.3832745559339,45.3832736152001,45.3832727514412,45.3832719678118,45.3832712630501,45.3832706371561,45.3832700913916,45.3832696251258,45.3832692389896,45.3832689329829,45.3832687064749,45.3832685607274,45.3832684938476,45.383268553787,45.383292785093,45.3832929377808,45.3832928273661,45.3832925232523,45.3832920285944,45.3832913408683,45.383290462598,45.3832893918906,45.3832881312698,45.3832866788427,45.3832850365023,45.3832832048794,45.383281184605,45.3832789744171,45.3832765768395,45.3832739918722,45.3832712220389,45.3832682654467,45.3832651239885,45.3832617995571,45.3832582921523,45.3832546036671,45.3832507334704,45.3832466853478,45.3832424586684,45.383238055325,45.3832334765793,45.3832287236933,45.3832237985597,45.3832187018093,45.383213435966,45.3832080022917,45.383202402048,45.3831966371278,45.3831907094238,45.3831846214598,45.3831783732358,45.3831719685373,45.3831654086262,45.3831586960261,45.3831518307371,45.3831448171757,45.3831376559727,45.3831303502827,45.3831229026297,45.3831153142754,45.3827727015694,45.3826667528317,45.3825114352323,45.3822168054103,45.3821030071873,45.3817651268441,45.3817649836165,45.3816694640124,45.3814535852512,45.3813126931919,45.3812353250375,45.3808887826267,45.3808470074731,45.3810320809868,45.3811998629418,45.3811902495634,45.3811071792048,45.3804738823297,45.3803360196606,45.3800612492447,45.3797455047642,45.3797796906676,45.3799112417482,45.3796216342457,45.3796415429949,45.3795727589686,45.3793466742174,45.379235437702,45.3789950092178,45.3789591942556,45.3789393237566,45.3789071022487,45.3788308993981,45.3788096248982,45.3787955771363,45.3787822247238,45.3787695733399,45.3787576274023,45.3787463894351,45.3787358632249,45.378726052558,45.3787169593277,45.3787085873203,45.3787009390601,45.3786940145475,45.3786794827854,45.3786673002064,45.3788405245355,45.3788154981652,45.378802984345,45.378790469891,45.3787842129784,45.3790578109136,45.3790515060755,45.3790389904145,45.3790300474099,45.3790146121579,45.3789966062516,45.3786421753245,45.3783406424289,45.3783060095406,45.3782444828869,45.3782122672931,45.378210407111,45.3782084510171,45.3782064009044,45.3782042586659,45.3782020211466,45.3781996927635,45.3781972709926,45.3781947608818,45.3781921573832,45.3781894661757,45.3781866866283,45.37818381811,45.3781808637758,45.3781778229947,45.3781746963976,45.3781714865085,45.3781681945895,45.3781648187474,45.3781613633994,45.3781578260213,45.3781542103992,45.3781505171639,45.3781467463156,45.3781429010092,45.3781389806137,45.378134988284,45.3781309227582,45.3781267859292,45.378122581583,45.3781183065645,45.3781139659219,45.3781095596551,45.3781050890259,45.3781005565585,45.3780959597288,45.3780913048468,45.3780865906504,45.378079047683,45.3780741807838,45.3780692608801,45.378064289234,45.3780592671076,45.3780541957627,45.3780490783544,45.3780439142516,45.3780387085023,45.3780334573206,45.3780281651234,45.3780228356966,45.3780174671474,45.3780120638926,45.3780066246703,45.3780011538975,45.3779956528361,45.3779901202242,45.3779845617406,45.3779789767546,45.3779733677899,45.3779677348467,45.3779620829728,45.3779564109064,45.3779507211714,45.3779450162918,45.3779392975296,45.3779335667777,45.3779278246674,45.3779220737224,45.3779108620912,45.3777868676629,45.3774698005126,45.3772853349887,45.3772438114692,45.3772018954315,45.3771784262986,45.3771595982329,45.3771169318616,45.3770739108301,45.3770305471268,45.3769868558952,45.3769342200317,45.3769319067407,45.3768875232118,45.3768428544302,45.3767979149083,45.3767527166348,45.3767072747535,45.3766616018841,45.3766157131704,45.3765696218632,45.3765233431064,45.3764468379409,45.3763517598996,45.3751934481009,45.3749022054023,45.374790324059,45.3747347234332,45.3746794521542,45.3746245285232,45.3745699689482,45.3745157892061,45.3744620063363,45.3744086373777,45.3739344715983,45.373871158744,45.3738650918632,45.3738231663795,45.3737757810419,45.373729017878,45.3732589715957,45.3726872287588,45.3720445993916,45.3716923008215,45.3710369893651,45.3705153125847,45.3694789358646,45.3692634561159,45.3693798026728,45.3692758982088,45.369086667028,45.3710149849307,45.3710462138325,45.3731012989288,45.373188273391,45.3733684257872,45.3734265873009,45.3735086542144,45.3799505283827,45.3816630042495,45.3830284875795,45.3830034094326,45.3844957906017,45.3858388320838,45.3858322119145,45.3857802719809,45.3855121084838,45.3854574319685,45.3854024727493,45.3851276209613,45.3851272108628,45.3851135785547,45.3851005601297,45.3848266974249,45.384807145081,45.3847940937772]}]]],"X1506","MontBellevue",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#000000","weight":2,"opacity":1,"fill":true,"fillColor":"#90EE90","fillOpacity":1,"dashArray":"none","smoothFactor":1,"noClip":false},"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>1506<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ID<\/nobr><\/td><td align=\"right\"><nobr>1,506<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>MUNICIPALI<\/nobr><\/td><td align=\"right\"><nobr>43027<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>NOM<\/nobr><\/td><td align=\"right\"><nobr>Parc du Mont-Bellevue<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>TYPE<\/nobr><\/td><td align=\"right\"><nobr>Parc urbain<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>OBJECTID<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>SHAPE__Are<\/nobr><\/td><td align=\"right\"><nobr>4,091,158<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>SHAPE__Len<\/nobr><\/td><td align=\"right\"><nobr>11,274<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>geom_Length<\/nobr><\/td><td align=\"right\"><nobr>11,274<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>geom_Area<\/nobr><\/td><td align=\"right\"><nobr>4,091,158<\/nobr><\/td><\/tr><\/table><\/div>",null,"1506",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolylines","args":[[[[{"lng":[-71.908580085633,-71.9093567097388,-71.9096015311965,-71.9098636030025,-71.9101840706919,-71.910617768328,-71.9116722548259,-71.912585286311,-71.9133343527989,-71.9134273149561,-71.9142370276071,-71.9147337519417,-71.9150376996131,-71.9152258265965,-71.9154664214807,-71.9155207587756,-71.9159737091048,-71.9162981751956,-71.9165867410143,-71.916795141177,-71.9169656126719,-71.9172997841609,-71.9177918713921,-71.9185652876141,-71.918633210131,-71.9187295885812,-71.9189513368108,-71.9191023876275,-71.9193409181832,-71.9195892035446,-71.9197621130671,-71.9199265936973,-71.9200164189375,-71.9200359276506,-71.9201271650424,-71.9200856314352,-71.9203963209628,-71.9205481092963,-71.9209037630971,-71.9209974286351,-71.9211310081179,-71.9212617848569,-71.9214965712345,-71.9216887388401],"lat":[45.3772354209445,45.3775401665039,45.3775845324834,45.377586380066,45.3776051486752,45.3776332851712,45.3776201646939,45.3778589924932,45.3781567047368,45.3782021221063,45.37873076607,45.3789141258007,45.3789711275309,45.3790272066979,45.3793406893211,45.3793905882563,45.3795724422152,45.3796384284674,45.3796580564238,45.3797695653224,45.3798547463804,45.3799431326819,45.3800602245375,45.3804694623653,45.3805268493135,45.3805808945781,45.3805871203743,45.3805935398779,45.3805580634982,45.3805970821514,45.3805513701487,45.3805683571717,45.3805228230799,45.3804574568443,45.3804193201956,45.3803715498124,45.3803423458086,45.3802879955552,45.3803211942865,45.3803754422903,45.3803903736538,45.3803867304116,45.3803649921002,45.3803220334825]}]]],"Réseau.utilitaire","PistesCyclables.Selection",{"interactive":true,"className":"","pane":"tmap402","stroke":true,"color":"#FF0000","weight":1,"opacity":1,"fill":false,"fillColor":"#FF0000","fillOpacity":0.2,"dashArray":"none","smoothFactor":1,"noClip":false},"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>Réseau utilitaire<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>NOM<\/nobr><\/td><td align=\"right\"><nobr>Réseau utilitaire<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>OBJECTID<\/nobr><\/td><td align=\"right\"><nobr>61<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>SHAPE__Len<\/nobr><\/td><td align=\"right\"><nobr>1,661<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>longMetre<\/nobr><\/td><td align=\"right\"><nobr>1,168<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>longKm<\/nobr><\/td><td align=\"right\"><nobr>0.117<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>ParcMB.intersect<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>",null,"Réseau utilitaire",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Esri.WorldGrayCanvas","OpenStreetMap","Esri.WorldTopoMap"],["MontBellevue","PistesCyclables.Selection"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[45.369086667028,45.3858388320838],"lng":[-71.9326029371655,-71.9020495823508]},"fitBounds":[45.369086667028,-71.9326029371655,45.3858388320838,-71.9020495823508,[]]},"evals":[],"jsHooks":[]}</script>
<p>Créons une deuxième requête spatiale pour sélectionner les points GPS situés à moins de cinq kilomètres de l’hôtel de ville de Sherbrooke avec la méthode <code>st_is_within_distance</code>.</p>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-38483cce3fad1ae6ce2e" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-38483cce3fad1ae6ce2e">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"createMapPane","args":["tmap402",402]},{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,"Esri.WorldGrayCanvas",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircleMarkers","args":[[45.360097229426,45.3753535888635,45.4696425283716,45.3712601652043,45.4103518023825,45.3257028718887,45.3481132339541,45.3705115941606,45.4286324512364,45.3820901924324,45.4058510310396,45.4251754211016,45.4537449977643,45.333534052091,45.3232787835646,45.3451050148227,45.4221449906495,45.336374787191,45.452690272711,45.4713666410107,45.4206560871241,45.3670043615157,45.3823438253454,45.3864441040817,45.4187630999049,45.4035408917733,45.4120824425087,45.4008935041602,45.4334645948616,45.420498088092,45.3984117286895,45.4028786200922,45.3924726080341,45.3837055612493,45.3793756182764,45.4134115712412,45.3972689690453,45.3617441489195,45.3525039383069,45.367905244104,45.3704581726354,45.325282123232,45.3592805471183,45.375625280846,45.3516798768153,45.351794742868,45.3968480170286,45.3757894449789,45.3795915227538,45.38458826714,45.3497257678817,45.3991379198954,45.3787789066069,45.3492452508234,45.3605755694218,45.3548365131885,45.3704064053476,45.36451068864,45.3743831585317,45.3578439856466,45.4023340850702,45.4284726873291,45.4407264043673,45.4424052919038,45.4304844116031,45.4305167638142,45.4079768436252,45.390540315357,45.4239714049877,45.404287756488,45.3954506436582,45.4273438237423,45.4239050396855,45.4088483125584,45.4067817620411,45.4278316018928,45.4070412631231,45.4487255311342,45.4487169104388,45.3996549661563,45.4515296787761,45.4615707274839,45.4772835621294,45.4624437776572,45.349708686263,45.3387727865314,45.3208333377283,45.3295849981819,45.3221461729887],[-71.9998529072272,-71.9909558006383,-71.9844364024145,-72.0987286171694,-72.0487954404394,-71.9500012569733,-72.0067876301985,-72.0154450616453,-71.999202634286,-72.0674798199903,-72.0387592305415,-72.0415456645301,-71.9870075869469,-71.9502897336682,-72.0086978482076,-72.0625491469246,-72.0300608616843,-72.025128904933,-71.9537300135158,-71.942152464399,-71.9348516761361,-71.9406337437461,-71.914208364128,-71.9572031682921,-71.9727614922159,-71.9483627281527,-71.912300828418,-71.9304766317987,-71.9159728392191,-71.9146370028228,-71.9272944202808,-71.9281009631363,-71.9011615996281,-71.9209352197383,-71.9178144833691,-71.959246500755,-71.9497917737627,-71.926472229175,-71.9439974472063,-71.9326254904194,-71.8512527320743,-71.8249858418608,-71.8297888335724,-71.8315695140746,-71.8400742319138,-71.8297959931385,-71.8131973061841,-71.8246801838582,-71.8192731454855,-71.8816132469368,-71.8543102731978,-71.8173275124781,-71.8241883891396,-71.8279757708992,-71.8704912311682,-71.8565843610845,-71.8764670719627,-71.8704145214698,-71.845429534478,-71.8279335631127,-71.8747817954333,-71.9050531396907,-71.8437435562254,-71.8908015063169,-71.8572809872545,-71.8436822967185,-71.8132073436235,-71.8743001803073,-71.8268836504732,-71.8757620488701,-71.8748320474265,-71.8330144010169,-71.8862403307076,-71.8844960950343,-71.8226405371,-71.8602361567618,-71.8367542726324,-71.8506380641791,-71.8697951139531,-71.8197385260804,-72.0272206504753,-72.0508710317864,-71.8641574951201,-71.8454861414535,-71.8865631195201,-71.9207939345756,-71.8865631195201,-71.8666470089424,-71.9151925284756],[4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958],["X1","X2","X3","X4","X5","X6","X7","X8","X9","X10","X11","X12","X13","X14","X15","X16","X17","X18","X19","X20","X21","X22","X23","X24","X25","X26","X27","X28","X29","X30","X31","X32","X33","X34","X35","X36","X37","X38","X39","X40","X41","X42","X43","X44","X45","X46","X47","X48","X49","X50","X51","X52","X53","X54","X55","X56","X57","X58","X59","X60","X61","X62","X63","X64","X65","X66","X67","X68","X69","X70","X71","X72","X73","X74","X75","X76","X77","X78","X79","X80","X81","X82","X83","X84","X85","X86","X87","X88","X89"],"PointsGPS",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},null,null,["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>2<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>4<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>5<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>6<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>8<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>9<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>9<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>10<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>10<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>11<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>11<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>12<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>12<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>13<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>13<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>14<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>14<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>15<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>15<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>16<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>16<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>17<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>17<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>18<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>18<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>19<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>19<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>20<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>20<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>21<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>21<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>22<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>22<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>23<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>23<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>24<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>24<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>25<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>25<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>26<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>26<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>27<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>27<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>28<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>28<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>29<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>29<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>30<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>30<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>31<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>31<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>32<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>32<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>33<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>34<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>34<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>35<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>35<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>36<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>36<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>37<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>37<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>38<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>38<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>39<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>39<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>40<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>40<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>41<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>41<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>42<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>42<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>43<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>43<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>44<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>44<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>45<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>45<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>46<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>46<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>47<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>47<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>48<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>48<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>49<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>49<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>50<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>50<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>51<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>51<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>52<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>52<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>53<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>53<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>54<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>54<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>55<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>55<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>56<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>56<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>57<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>57<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>58<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>58<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>59<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>59<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>60<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>60<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>61<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>61<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>62<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>62<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>63<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>63<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>64<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>64<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>65<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>65<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>66<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>66<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>67<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>67<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>68<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>68<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>69<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>69<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>70<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>70<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>71<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>71<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>72<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>72<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>73<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>73<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>74<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>74<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>75<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>75<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>76<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>76<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>77<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>77<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>78<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>78<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>79<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>79<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>80<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>80<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>81<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>81<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>82<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>82<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>83<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>83<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>84<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>84<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>85<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>85<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>86<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>86<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>87<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>87<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>88<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>88<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>89<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>89<\/nobr><\/td><\/tr><\/table><\/div>"],null,["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[45.40417,-71.89306,10,"X1.1","HotelVille",{"interactive":true,"className":"","pane":"tmap402","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":"#000000","fillOpacity":1},null,null,"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ID<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Nom<\/nobr><\/td><td align=\"right\"><nobr>Hôtel de ville<\/nobr><\/td><\/tr><\/table><\/div>",null,"1",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Esri.WorldGrayCanvas","OpenStreetMap","Esri.WorldTopoMap"],["PointsGPS","HotelVille"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[45.3208333377283,45.4772835621294],"lng":[-72.0987286171694,-71.8131973061841]},"fitBounds":[45.3208333377283,-72.0987286171694,45.4772835621294,-71.8131973061841,[]]},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="sect012.html#cb96-1" tabindex="-1"></a><span class="do">## Requête spatiale</span></span>
<span id="cb96-2"><a href="sect012.html#cb96-2" tabindex="-1"></a>RequeteSpatiale <span class="ot">&lt;-</span> <span class="fu">st_is_within_distance</span>(PointsGPS, HotelVille, </span>
<span id="cb96-3"><a href="sect012.html#cb96-3" tabindex="-1"></a>                                         <span class="dv">5000</span>, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-4"><a href="sect012.html#cb96-4" tabindex="-1"></a><span class="do">## Ajout d&#39;un champ pour la requête</span></span>
<span id="cb96-5"><a href="sect012.html#cb96-5" tabindex="-1"></a>PointsGPS<span class="sc">$</span>HotelVille2km <span class="ot">&lt;-</span> RequeteSpatiale[, <span class="dv">1</span>]</span>
<span id="cb96-6"><a href="sect012.html#cb96-6" tabindex="-1"></a><span class="do">## Nous constatons que 17 points GPS sont à moins de 5 km</span></span>
<span id="cb96-7"><a href="sect012.html#cb96-7" tabindex="-1"></a><span class="fu">table</span>(PointsGPS<span class="sc">$</span>HotelVille2km)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##    72    17</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="sect012.html#cb98-1" tabindex="-1"></a><span class="do">## Création d&#39;une nouvelle couche pour la sélection</span></span>
<span id="cb98-2"><a href="sect012.html#cb98-2" tabindex="-1"></a>PointsGPS.selection <span class="ot">&lt;-</span> PointsGPS[PointsGPS<span class="sc">$</span>HotelVille2km<span class="sc">==</span> <span class="cn">TRUE</span>, ]</span>
<span id="cb98-3"><a href="sect012.html#cb98-3" tabindex="-1"></a><span class="do">## Visualisation</span></span>
<span id="cb98-4"><a href="sect012.html#cb98-4" tabindex="-1"></a><span class="fu">tm_shape</span>(PointsGPS.selection) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">size =</span> .<span class="dv">05</span>)<span class="sc">+</span></span>
<span id="cb98-5"><a href="sect012.html#cb98-5" tabindex="-1"></a><span class="fu">tm_shape</span>(HotelVille)<span class="sc">+</span><span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">size =</span> .<span class="dv">25</span>)</span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-04622c877b0195733c19" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-04622c877b0195733c19">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"createMapPane","args":["tmap402",402]},{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,"Esri.WorldGrayCanvas",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircleMarkers","args":[[45.3823438253454,45.4120824425087,45.4008935041602,45.420498088092,45.3984117286895,45.4028786200922,45.3924726080341,45.3837055612493,45.3793756182764,45.38458826714,45.4023340850702,45.4284726873291,45.390540315357,45.404287756488,45.3954506436582,45.4239050396855,45.4088483125584],[-71.914208364128,-71.912300828418,-71.9304766317987,-71.9146370028228,-71.9272944202808,-71.9281009631363,-71.9011615996281,-71.9209352197383,-71.9178144833691,-71.8816132469368,-71.8747817954333,-71.9050531396907,-71.8743001803073,-71.8757620488701,-71.8748320474265,-71.8862403307076,-71.8844960950343],[4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958,4.47213595499958],["X23","X27","X28","X30","X31","X32","X33","X34","X35","X50","X61","X62","X68","X70","X71","X73","X74"],"PointsGPS.selection",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},null,null,["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>23<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>23<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>27<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>27<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>28<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>28<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>30<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>30<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>31<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>31<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>32<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>32<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>33<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>33<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>34<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>34<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>35<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>35<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>50<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>50<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>61<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>61<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>62<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>62<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>68<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>68<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>70<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>70<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>71<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>71<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>73<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>73<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>74<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>74<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>HotelVille2km<\/nobr><\/td><td align=\"right\"><nobr>TRUE<\/nobr><\/td><\/tr><\/table><\/div>"],null,["23","27","28","30","31","32","33","34","35","50","61","62","68","70","71","73","74"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[45.40417,-71.89306,10,"X1","HotelVille",{"interactive":true,"className":"","pane":"tmap402","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":"#000000","fillOpacity":1},null,null,"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ID<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Nom<\/nobr><\/td><td align=\"right\"><nobr>Hôtel de ville<\/nobr><\/td><\/tr><\/table><\/div>",null,"1",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Esri.WorldGrayCanvas","OpenStreetMap","Esri.WorldTopoMap"],["PointsGPS.selection","HotelVille"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[45.3793756182764,45.4284726873291],"lng":[-71.9304766317987,-71.8743001803073]},"fitBounds":[45.3793756182764,-71.9304766317987,45.4284726873291,-71.8743001803073,[]]},"evals":[],"jsHooks":[]}</script>
<p>Finalement, avec la méthode <code>st_within</code>, nous constatons que seuls deux points GPS sont situés dans le parc du Mont-Bellevue.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="sect012.html#cb99-1" tabindex="-1"></a><span class="do">## Requête spatiale</span></span>
<span id="cb99-2"><a href="sect012.html#cb99-2" tabindex="-1"></a>RequeteSpatiale <span class="ot">&lt;-</span> <span class="fu">st_within</span>(<span class="fu">st_transform</span>(PointsGPS, <span class="fu">st_crs</span>(MontBellevue)),</span>
<span id="cb99-3"><a href="sect012.html#cb99-3" tabindex="-1"></a>                             MontBellevue, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb99-4"><a href="sect012.html#cb99-4" tabindex="-1"></a><span class="fu">table</span>(RequeteSpatiale[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##    87     2</code></pre>
</div>
<div id="sect0127" class="section level3 hasAnchor" number="1.2.7">
<h3><span class="header-section-number">1.2.7</span> Manipulation des données attributaires<a href="sect012.html#sect0127" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans cette section, nous verrons comment importer une table attributaire, puis la joindre à une couche géographique, ajouter et calculer de nouveaux champs et réaliser des requêtes attributaires.</p>
<div id="sect01271" class="section level4 hasAnchor" number="1.2.7.1">
<h4><span class="header-section-number">1.2.7.1</span> Importation d’une table attributaire<a href="sect012.html#sect01271" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="bloc_objectif">
<p><strong>Joindre les attributs d’une table externe à une couche vectorielle <code>sf</code></strong></p>
<p>En SIG, joindre une table à une couche géographique vectorielle est une opération courante. Par exemple, il est fréquent de joindre des données socioéconomiques issues d’un recensement à une couche géographique (divisions de recensement, subdivisions de recensement, secteurs de recensement, aires de diffusion, etc.).</p>
<p>Pour ce faire, vous devez importer les données dans un <em>DataFrame</em> de R. Ces données peuvent être stockées dans différents formats de fichiers (texte délimité par des virgules (extension <em>csv</em>), <em>dBase</em> (<em>dbf</em>), Excel (<em>xlsx</em>)) ou dans des fichiers provenant de logiciels statistiques commerciaux comme Stata, SAS et SPSS (<em>dta</em>, <em>sas7bdat</em>, <em>sav</em>).</p>
<p>Dans cette section, nous voyons seulement l’importation de fichiers texte délimités par des virgules, de fichiers Excel et <em>dBase</em>. Concernant ce dernier type de fichier, notez que la table attributaire d’une couche Esri Shapefile est stockée dans un fichier <em>dBase</em>! Il peut être intéressant d’importer la table sans les géométries.</p>
<p>Pour une description détaillée de l’importation d’autres fichiers (entre autres Stata, SAS et SPSS), consultez la section intitulée <a href="https://laeq.github.io/LivreMethoQuantBolR/sect014.html#0141"><em>Manipulation d’un DataFrame</em></a> <span class="citation">(<a href="#ref-RBoldAir">Apparicio et Gelb 2022</a>)</span>.</p>
</div>
<p>Dans le code ci-dessous, nous voyons comment importer trois types de fichiers :</p>
<ul>
<li><p><code>read.csv(file)</code> pour importer un fichier délimité par des virgules. Cette fonction est de base avec R, ce qui signifie qu’elle ne nécessite pas l’installation d’un <em>package</em>.</p></li>
<li><p><code>read.dbf(file)</code> pour importer un fichier <em>dBase</em>. Cette fonction est rattachée au <em>package</em> <code>foreign</code> que vous devez installer si ce n’est pas déjà fait (commande <code>install.packages("foreign")</code>) et le charger (commande <code>library("foreign")</code>).</p></li>
<li><p><code>read.xlsx(file)</code> pour importer un fichier Excel. Cette fonction est rattachée au <em>package</em> <code>xlsx</code> que vous devez installer si ce n’est pas déjà fait (commande <code>install.packages("xlsx")</code>) et le charger (commande <code>library("xlsx")</code>).</p></li>
</ul>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="sect012.html#cb101-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;xlsx&quot;</span>)      <span class="co"># package pour importer des fichiers Excel</span></span>
<span id="cb101-2"><a href="sect012.html#cb101-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;foreign&quot;</span>)   <span class="co"># package pour importer des fichiers dBase</span></span>
<span id="cb101-3"><a href="sect012.html#cb101-3" tabindex="-1"></a></span>
<span id="cb101-4"><a href="sect012.html#cb101-4" tabindex="-1"></a><span class="do">## Importation du fichier csv</span></span>
<span id="cb101-5"><a href="sect012.html#cb101-5" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb101-6"><a href="sect012.html#cb101-6" tabindex="-1"></a>dfCSV <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;data/chap01/tables/SRQC2021.csv&quot;</span>,</span>
<span id="cb101-7"><a href="sect012.html#cb101-7" tabindex="-1"></a>                    <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-8"><a href="sect012.html#cb101-8" tabindex="-1"></a>                    <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>,    <span class="co"># séparateur de décimales qui peut être remplacé par ,</span></span>
<span id="cb101-9"><a href="sect012.html#cb101-9" tabindex="-1"></a>                    <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>     <span class="co"># séparateur des champs qui peut être remplacé par ;</span></span>
<span id="cb101-10"><a href="sect012.html#cb101-10" tabindex="-1"></a>                    )</span>
<span id="cb101-11"><a href="sect012.html#cb101-11" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb101-12"><a href="sect012.html#cb101-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;temps de traitement (CSV) : &quot;</span>, </span>
<span id="cb101-13"><a href="sect012.html#cb101-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>)),</span>
<span id="cb101-14"><a href="sect012.html#cb101-14" tabindex="-1"></a>    <span class="st">&quot; secondes&quot;</span>)</span></code></pre></div>
<pre><code>## temps de traitement (CSV) :  0.02902603  secondes</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="sect012.html#cb103-1" tabindex="-1"></a><span class="do">## Importation d&#39;un fichier Excel avec le nom de fichier et de la feuille Excel</span></span>
<span id="cb103-2"><a href="sect012.html#cb103-2" tabindex="-1"></a><span class="do">## sheetIndex = 1 signale l&#39;importation de la première feuille Excel</span></span>
<span id="cb103-3"><a href="sect012.html#cb103-3" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb103-4"><a href="sect012.html#cb103-4" tabindex="-1"></a>dfExcel <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="at">file =</span> <span class="st">&quot;data/chap01/tables/ADSRQC2021.xlsx&quot;</span>,</span>
<span id="cb103-5"><a href="sect012.html#cb103-5" tabindex="-1"></a>                      <span class="at">sheetIndex =</span> <span class="dv">2</span>)</span>
<span id="cb103-6"><a href="sect012.html#cb103-6" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb103-7"><a href="sect012.html#cb103-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;temps de traitement (Excel) : &quot;</span>, </span>
<span id="cb103-8"><a href="sect012.html#cb103-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>)),</span>
<span id="cb103-9"><a href="sect012.html#cb103-9" tabindex="-1"></a>    <span class="st">&quot; secondes&quot;</span>)</span></code></pre></div>
<pre><code>## temps de traitement (Excel) :  7.782371  secondes</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="sect012.html#cb105-1" tabindex="-1"></a><span class="do">## Importation du fichier dBase</span></span>
<span id="cb105-2"><a href="sect012.html#cb105-2" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb105-3"><a href="sect012.html#cb105-3" tabindex="-1"></a>dfDbf <span class="ot">&lt;-</span> <span class="fu">read.dbf</span>(<span class="at">file =</span> <span class="st">&quot;data/chap01/tables/ADQC2021.dbf&quot;</span>)</span>
<span id="cb105-4"><a href="sect012.html#cb105-4" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb105-5"><a href="sect012.html#cb105-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;temps de traitement (dBase) : &quot;</span>, </span>
<span id="cb105-6"><a href="sect012.html#cb105-6" tabindex="-1"></a>    <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>)),</span>
<span id="cb105-7"><a href="sect012.html#cb105-7" tabindex="-1"></a>    <span class="st">&quot; secondes&quot;</span>)</span></code></pre></div>
<pre><code>## temps de traitement (dBase) :  0.131705  secondes</code></pre>
<div class="bloc_astuce">
<p>Le temps nécessaire pour importer un fichier Excel est bien plus long que pour des fichiers texte et <em>dBase</em>! Par conséquent, si vous travaillez avec Excel, il est vivement conseillé de l’exporter vers un fichier texte (dans Excel, <code>Fichier/Enregistrer sous/type de fichier CSV</code>).</p>
</div>
<p>Quelques lignes suffisent pour explorer la structure des données importées avec les fonctions <code>nrow</code>, <code>ncol</code>, <code>colnames</code> (respectivement le nombre de lignes, le nombre de colonnes et les noms des colonnes du <code>dataframe</code>).</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="sect012.html#cb107-1" tabindex="-1"></a><span class="do">## Nombre de lignes et de colonnes</span></span>
<span id="cb107-2"><a href="sect012.html#cb107-2" tabindex="-1"></a><span class="fu">nrow</span>(dfCSV)</span></code></pre></div>
<pre><code>## [1] 2245</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="sect012.html#cb109-1" tabindex="-1"></a><span class="fu">ncol</span>(dfCSV)</span></code></pre></div>
<pre><code>## [1] 40</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="sect012.html#cb111-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;le DataFrame dfCSV a&quot;</span>, <span class="fu">nrow</span>(dfCSV), <span class="st">&quot;lignes (observations)&quot;</span>,</span>
<span id="cb111-2"><a href="sect012.html#cb111-2" tabindex="-1"></a>    <span class="st">&#39;et&#39;</span>, <span class="fu">ncol</span>(dfCSV), <span class="st">&quot;colonnes</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## le DataFrame dfCSV a 2245 lignes (observations) et 40 colonnes</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="sect012.html#cb113-1" tabindex="-1"></a><span class="do">## Noms des champs</span></span>
<span id="cb113-2"><a href="sect012.html#cb113-2" tabindex="-1"></a><span class="fu">colnames</span>(dfCSV)</span></code></pre></div>
<pre><code>##  [1] &quot;SRIDU&quot;                     &quot;PopTotAge&quot;                
##  [3] &quot;Pop0_14&quot;                   &quot;Pop15_64&quot;                 
##  [5] &quot;Pop65plus&quot;                 &quot;TotalLog&quot;                 
##  [7] &quot;MaisonIndiv&quot;               &quot;MaisonJumulee&quot;            
##  [9] &quot;MaisonRangee&quot;              &quot;AppartDuplex&quot;             
## [11] &quot;AppartMoins5E&quot;             &quot;Appart5EtPlus&quot;            
## [13] &quot;AutreMaisonIndivAttenante&quot; &quot;LogementMobile&quot;           
## [15] &quot;TotalMenag&quot;                &quot;Menage1pers&quot;              
## [17] &quot;Menage2pers&quot;               &quot;Menage3pers&quot;              
## [19] &quot;Menage4pers&quot;               &quot;Menage5pPlus&quot;             
## [21] &quot;RevMedMenage&quot;              &quot;PopTotMFRApI&quot;             
## [23] &quot;PopTotMFR&quot;                 &quot;PopTotMFRPct&quot;             
## [25] &quot;TotalMenag2&quot;               &quot;Proprietaire&quot;             
## [27] &quot;Locataire&quot;                 &quot;TotalLog2&quot;                
## [29] &quot;Log1960ouAv&quot;               &quot;Log1961_80&quot;               
## [31] &quot;Log1981_90&quot;                &quot;Log1991_00&quot;               
## [33] &quot;Log2001_05&quot;                &quot;Log2006_10&quot;               
## [35] &quot;Log2011_15&quot;                &quot;Log2016_21&quot;               
## [37] &quot;ValeurMedLog&quot;              &quot;ValeurMoyLog&quot;             
## [39] &quot;LoyerMedian&quot;               &quot;LoyerMoyen&quot;</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="sect012.html#cb115-1" tabindex="-1"></a><span class="do">## Affichage des deux premières observations</span></span>
<span id="cb115-2"><a href="sect012.html#cb115-2" tabindex="-1"></a><span class="fu">head</span>(dfCSV, <span class="at">n=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                                                       SRIDU PopTotAge Pop0_14
## 1 4470001.01 (SR), Drummondville (RMR) (4470001.01) (00000)      5080     810
## 2 4470001.02 (SR), Drummondville (RMR) (4470001.02) (00000)      3400     175
##   Pop15_64 Pop65plus TotalLog MaisonIndiv MaisonJumulee MaisonRangee
## 1     3285       985     2280        1290           185          210
## 2     1305      1920     1815         155            75           85
##   AppartDuplex AppartMoins5E Appart5EtPlus AutreMaisonIndivAttenante
## 1           70           415             0                        15
## 2           15          1485             0                         5
##   LogementMobile TotalMenag Menage1pers Menage2pers Menage3pers Menage4pers
## 1            100       2285         705         895         325         225
## 2              0       1810         985         670         100          45
##   Menage5pPlus RevMedMenage PopTotMFRApI PopTotMFR PopTotMFRPct TotalMenag2
## 1          130        69000         5085       520         10.2        2295
## 2           15        47600         2885       545         18.9        1820
##   Proprietaire Locataire TotalLog2 Log1960ouAv Log1961_80 Log1981_90 Log1991_00
## 1         1445       850      2295         115        590        535        485
## 2          485      1335      1820          50        310        375        405
##   Log2001_05 Log2006_10 Log2011_15 Log2016_21 ValeurMedLog ValeurMoyLog
## 1        155         70         75        265       250000       250200
## 2        215        200        120        140       250000       305000
##   LoyerMedian LoyerMoyen
## 1         695        742
## 2         740        737</code></pre>
</div>
<div id="sect01272" class="section level4 hasAnchor" number="1.2.7.2">
<h4><span class="header-section-number">1.2.7.2</span> Jointure attributaire avec la couche géographique <code>sf</code><a href="sect012.html#sect01272" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Les données importées dans la table attributive proviennent du recensement de Statistique Canada de 2021 et sont ancrées au niveau des secteurs de recensement (SR) des régions métropolitaines de recensement (RMR) et des agglomérations de recensement (AR) du Québec. Pour les SR de la RMR de Sherbrooke, les données de la couche géométrique sont importées à partir d’un fichier shapefile. Aussi, nous constatons que les deux sources de données ont un champ commun <code>SRIDU</code>, soit l’identifiant unique des SR, mais que l’information y est présentée différemment :</p>
<ul>
<li><p>Dans la couche géographique <code>SR.RMRSherb</code> (objet <em>sf</em>), nous avons une observation avec la valeur <code>4470001.01</code>, soit un champ avec dix caractères.</p></li>
<li><p>Dans la table attributaire <code>dfCSV</code> (<em>DataFrame</em>), nous avons une observation avec la valeur <code>4470001.01 (SR), Drummondville (RMR) (4470001.01) (00000)</code>.</p></li>
</ul>
<p>Par conséquent, avant d’appliquer une jointure, nous modifions le champ <code>SRIDU</code> de ce <em>DataFrame</em> afin qu’il ait aussi dix caractères avec la ligne de code suivante : <code>dfCSV$SRIDU &lt;- substr(dfCSV$SRIDU, 1, 10)</code>. De la sorte, nous récupérons uniquement les dix premiers caractères.</p>
<p>Finalement, la jointure est réalisée avec la fonction <code>merge</code> avec laquelle nous spécifions le résultat de la jointure (<code>SR.RMRSherbDonnees</code>), la couche géographique (<code>SR.RMRSherb</code>), la table attributaire (<code>dfCSV</code>) et le champ commun aux deux avec l’option (<code>by ="SRIDU"</code>) :</p>
<p><code>SR.RMRSherbDonnees &lt;- merge(SR.RMRSherb, dfCSV, by = "SRIDU").</code></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="sect012.html#cb117-1" tabindex="-1"></a><span class="do">## Importation des SR de la RMR de Sherbrooke</span></span>
<span id="cb117-2"><a href="sect012.html#cb117-2" tabindex="-1"></a>SR.RMRSherb <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap01/gpkg/Recen2021Sherbrooke.gpkg&quot;</span>, </span>
<span id="cb117-3"><a href="sect012.html#cb117-3" tabindex="-1"></a>                       <span class="at">layer =</span> <span class="st">&quot;SherbSR&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb117-4"><a href="sect012.html#cb117-4" tabindex="-1"></a><span class="do">## Visualisation des premiers enregistrements</span></span>
<span id="cb117-5"><a href="sect012.html#cb117-5" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">as.data.frame</span>(SR.RMRSherb), <span class="at">n=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                 IDUGD      SRIDU   SRNOM SUPTERRE PRIDU SRpop_2021 SRtlog_2021
## 1 2021S05074330001.00 4330001.00 0001.00   3.1882    24       5637        2918
## 2 2021S05074330002.00 4330002.00 0002.00   0.8727    24       1868        1169
##   SRrhlog_2021 RMRcode   HabKm2                           geom
## 1         2756     433 1768.082 MULTIPOLYGON (((7764998 127...
## 2         1063     433 2140.484 MULTIPOLYGON (((7763361 127...</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="sect012.html#cb119-1" tabindex="-1"></a><span class="fu">head</span>(dfCSV, <span class="at">n=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                                                       SRIDU PopTotAge Pop0_14
## 1 4470001.01 (SR), Drummondville (RMR) (4470001.01) (00000)      5080     810
## 2 4470001.02 (SR), Drummondville (RMR) (4470001.02) (00000)      3400     175
##   Pop15_64 Pop65plus TotalLog MaisonIndiv MaisonJumulee MaisonRangee
## 1     3285       985     2280        1290           185          210
## 2     1305      1920     1815         155            75           85
##   AppartDuplex AppartMoins5E Appart5EtPlus AutreMaisonIndivAttenante
## 1           70           415             0                        15
## 2           15          1485             0                         5
##   LogementMobile TotalMenag Menage1pers Menage2pers Menage3pers Menage4pers
## 1            100       2285         705         895         325         225
## 2              0       1810         985         670         100          45
##   Menage5pPlus RevMedMenage PopTotMFRApI PopTotMFR PopTotMFRPct TotalMenag2
## 1          130        69000         5085       520         10.2        2295
## 2           15        47600         2885       545         18.9        1820
##   Proprietaire Locataire TotalLog2 Log1960ouAv Log1961_80 Log1981_90 Log1991_00
## 1         1445       850      2295         115        590        535        485
## 2          485      1335      1820          50        310        375        405
##   Log2001_05 Log2006_10 Log2011_15 Log2016_21 ValeurMedLog ValeurMoyLog
## 1        155         70         75        265       250000       250200
## 2        215        200        120        140       250000       305000
##   LoyerMedian LoyerMoyen
## 1         695        742
## 2         740        737</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="sect012.html#cb121-1" tabindex="-1"></a><span class="do">## Modification du champ SRIDU du DataFrame dfCSV</span></span>
<span id="cb121-2"><a href="sect012.html#cb121-2" tabindex="-1"></a>dfCSV<span class="sc">$</span>SRIDU <span class="ot">&lt;-</span> <span class="fu">substr</span>(dfCSV<span class="sc">$</span>SRIDU, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb121-3"><a href="sect012.html#cb121-3" tabindex="-1"></a><span class="do">## Jointure attributaire avec la fonction merge</span></span>
<span id="cb121-4"><a href="sect012.html#cb121-4" tabindex="-1"></a>SR.RMRSherbDonnees <span class="ot">&lt;-</span> <span class="fu">merge</span>(SR.RMRSherb, </span>
<span id="cb121-5"><a href="sect012.html#cb121-5" tabindex="-1"></a>                           dfCSV, </span>
<span id="cb121-6"><a href="sect012.html#cb121-6" tabindex="-1"></a>                           <span class="at">by =</span> <span class="st">&quot;SRIDU&quot;</span>)</span></code></pre></div>
<div class="bloc_astuce">
<p><strong>Jointure avec deux champs ayant des noms différents</strong></p>
<p>En résumé, une jointure attributaire s’écrit alors :</p>
<p><code>NouvelObjetSf &lt;- merge(X, Y, by = "Nom du champ commun pour la jointure")</code></p>
<p>avec <code>X</code> et <code>Y</code> étant respectivement l’objet <code>sf</code> (couche géographique) et la table attributaire à joindre. Si les champs pour la jointure ont des noms différents, il est possible d’écrire :</p>
<p><code>NouvelObjetSf &lt;- merge(X, Y, by.x = "Champ X pour la jointure", by.y = "Champ Y pour la jointure")</code></p>
<p>Ce type de jointure conserve uniquement les observations qui sont communes à la couche géographique et à la table attributaire. Concrètement, si une couche comprend 100 entités spatiales et la table attributaire uniquement 80 observations, la couche résultante (<code>NouvelObjetSf</code>) aura uniquement 80 entités spatiales (bien entendu, quand les valeurs concordent…).</p>
<p>Lorsque vous souhaitez quand même conserver toutes les entités spatiales de la couche géographique de départ, écrivez alors :</p>
<p><code>NouvelObjetSf &lt;- merge(X, Y, by = "Nom du champ commun pour la jointure", all.x = TRUE)</code></p>
<p>Dans la nouvelle couche <code>Sf</code>, les entités spatiales de <code>X</code> qui n’ont pas été appariées avec les observations de la table attributaire <code>Y</code> auront des valeurs nulles (<code>NA</code>) pour les champs de <code>X</code> ajoutés au <code>NouvelObjetSf</code>.</p>
<p>Pour obtenir plus d’information sur les différentes variantes d’une jointure, tapez <code>?merge</code> dans la console.</p>
</div>
</div>
<div id="sect01273" class="section level4 hasAnchor" number="1.2.7.3">
<h4><span class="header-section-number">1.2.7.3</span> Ajout et calcul de champs<a href="sect012.html#sect01273" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dans la section <a href="sect012.html#sect0124">1.2.4</a>, nous avons vu comment ajouter des champs relatifs à la géométrie (aire, longueur, distance, coordonnées de centroïdes). Dans un SIG, il est courant de calculer de nouveaux champs à partir de champs existants dans la table attributaire (par exemple, avec les outils <em>Calculatrice de champ</em> dans QGIS ou <em>Calculate Field</em> dans ArcGIS Pro).</p>
<p>Ce type de traitement est aussi très simple à réaliser dans R. Pour ce faire, nous utilisons des <a href="https://laeq.github.io/LivreMethoQuantBolR/sect013.html#sect0135">opérateurs mathématiques, relationnels et logiques</a> comme dans n’importe quel logiciel de SIG. En guise d’exemple, nous calculons ci-dessous les pourcentages d’enfants de moins de 15 ans et de locataires. Ces pourcentages sont arrondis à deux décimales avec la fonction <code>round</code>.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="sect012.html#cb122-1" tabindex="-1"></a><span class="do">## Création et cacul de nouveau champs</span></span>
<span id="cb122-2"><a href="sect012.html#cb122-2" tabindex="-1"></a>SR.RMRSherbDonnees<span class="sc">$</span>PctPop0_14 <span class="ot">&lt;-</span> <span class="fu">round</span>(SR.RMRSherbDonnees<span class="sc">$</span>Pop0_14 <span class="sc">/</span> </span>
<span id="cb122-3"><a href="sect012.html#cb122-3" tabindex="-1"></a>                                     SR.RMRSherbDonnees<span class="sc">$</span>PopTotAge <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb122-4"><a href="sect012.html#cb122-4" tabindex="-1"></a></span>
<span id="cb122-5"><a href="sect012.html#cb122-5" tabindex="-1"></a>SR.RMRSherbDonnees<span class="sc">$</span>PctLocataire <span class="ot">&lt;-</span> <span class="fu">round</span>(SR.RMRSherbDonnees<span class="sc">$</span>Locataire <span class="sc">/</span> </span>
<span id="cb122-6"><a href="sect012.html#cb122-6" tabindex="-1"></a>                                     SR.RMRSherbDonnees<span class="sc">$</span>TotalMenag2 <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="sect01274" class="section level4 hasAnchor" number="1.2.7.4">
<h4><span class="header-section-number">1.2.7.4</span> Requêtes attributaires<a href="sect012.html#sect01274" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dans un SIG, il est fréquent de réaliser une requête attributaire pour explorer les données (par exemple, avec les outils <em>Select By Attributes</em> dans ArcGIS Pro et <em>Sélection avec expression</em> dans QGIS) et exporter le résultat de la requête dans une nouvelle couche (<em>Export Features</em> dans ArcGIS Pro et <em>Sauvegarder les entités sélectionnées sous…</em>).</p>
<p>Dans le code ci-dessous, vous trouverez plusieurs exemples de requêtes attributaires. Remarquez que les résultats des requêtes sont enregistrés dans de nouveaux objets <code>sf</code> (couches géographiques) dénommés <code>Requete1</code> à <code>Requete5</code>.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="sect012.html#cb123-1" tabindex="-1"></a><span class="do">## Sélection de l&#39;axe cyclable de la Magog</span></span>
<span id="cb123-2"><a href="sect012.html#cb123-2" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb123-3"><a href="sect012.html#cb123-3" tabindex="-1"></a><span class="co"># Affichage des valeurs uniques pour le champ NOM de la couche PistesCyclables</span></span>
<span id="cb123-4"><a href="sect012.html#cb123-4" tabindex="-1"></a><span class="fu">unique</span>(PistesCyclables<span class="sc">$</span>NOM)</span></code></pre></div>
<pre><code>##  [1] &quot;Axe de la Massawippi&quot;         &quot;Axe de la Saint-François&quot;    
##  [3] &quot;Axe du Ruisseau-Dorman&quot;       &quot;Réseau utilitaire&quot;           
##  [5] &quot;Tronçon fermé temporairement&quot; &quot;Détour&quot;                      
##  [7] &quot;Axe de la Magog&quot;              &quot;Axe du Ruisseau-Kee&quot;         
##  [9] &quot;Axe de la Magog Sud&quot;          NA                            
## [11] &quot;Axe du Sommet&quot;</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="sect012.html#cb125-1" tabindex="-1"></a><span class="do">## Requête attributaire et enregistrement du résultat dans un nouvel objet sf</span></span>
<span id="cb125-2"><a href="sect012.html#cb125-2" tabindex="-1"></a>Requete1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(PistesCyclables, NOM <span class="sc">==</span> <span class="st">&quot;Axe de la Magog&quot;</span>)</span>
<span id="cb125-3"><a href="sect012.html#cb125-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">nrow</span>(Requete1), <span class="st">&quot;enregistrements sélectionnés sur&quot;</span>, <span class="fu">nrow</span>(PistesCyclables))</span></code></pre></div>
<pre><code>## 15 enregistrements sélectionnés sur 273</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="sect012.html#cb127-1" tabindex="-1"></a><span class="do">## Si vous souhaitez connaître uniquement le nombre d&#39;enregistrements sélectionnés</span></span>
<span id="cb127-2"><a href="sect012.html#cb127-2" tabindex="-1"></a><span class="do">## sans créer un nouvel objet sf, il suffit d&#39;écrire :</span></span>
<span id="cb127-3"><a href="sect012.html#cb127-3" tabindex="-1"></a><span class="fu">nrow</span>(<span class="fu">subset</span>(PistesCyclables, NOM <span class="sc">==</span> <span class="st">&quot;Axe de la Magog&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="sect012.html#cb129-1" tabindex="-1"></a><span class="do">## Sélection des SR dont la moitié ou plus des logements sont en location</span></span>
<span id="cb129-2"><a href="sect012.html#cb129-2" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb129-3"><a href="sect012.html#cb129-3" tabindex="-1"></a><span class="do">## Sommaire statistique sur le champ pourcentage de locataires</span></span>
<span id="cb129-4"><a href="sect012.html#cb129-4" tabindex="-1"></a><span class="fu">summary</span>(SR.RMRSherbDonnees<span class="sc">$</span>PctLocataire)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    6.92   18.03   41.63   43.81   65.95   93.83</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="sect012.html#cb131-1" tabindex="-1"></a><span class="do">## Requête attributaire et enregistrement du résultat dans un nouvel objet sf</span></span>
<span id="cb131-2"><a href="sect012.html#cb131-2" tabindex="-1"></a>Requete2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(SR.RMRSherbDonnees, PctLocataire <span class="sc">&gt;=</span> <span class="dv">50</span>)</span>
<span id="cb131-3"><a href="sect012.html#cb131-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">nrow</span>(Requete2), <span class="st">&quot;enregistrements sélectionnés sur&quot;</span>, <span class="fu">nrow</span>(SR.RMRSherbDonnees))</span></code></pre></div>
<pre><code>## 20 enregistrements sélectionnés sur 50</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="sect012.html#cb133-1" tabindex="-1"></a><span class="do">## Sélection des installations sportives avec un éclairage dans </span></span>
<span id="cb133-2"><a href="sect012.html#cb133-2" tabindex="-1"></a><span class="do">## l&#39;arrondissement des Nations (deux critères dans la requête)</span></span>
<span id="cb133-3"><a href="sect012.html#cb133-3" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb133-4"><a href="sect012.html#cb133-4" tabindex="-1"></a><span class="fu">unique</span>(InstallS.join<span class="sc">$</span>NomArrondissement)</span></code></pre></div>
<pre><code>## [1] &quot;Arrondissement de Fleurimont&quot;                               
## [2] &quot;Arrondissement de Brompton–Rock Forest–Saint-Élie–Deauville&quot;
## [3] &quot;Arrondissement des Nations&quot;                                 
## [4] &quot;Arrondissement de Lennoxville&quot;</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="sect012.html#cb135-1" tabindex="-1"></a><span class="fu">table</span>(InstallS.join<span class="sc">$</span>ECLAIRAGE)</span></code></pre></div>
<pre><code>## 
## Non Oui 
##  46  85</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="sect012.html#cb137-1" tabindex="-1"></a><span class="do">## Requête attributaire avec un opérateur AND (&amp;)</span></span>
<span id="cb137-2"><a href="sect012.html#cb137-2" tabindex="-1"></a>Requete3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(InstallS.join,</span>
<span id="cb137-3"><a href="sect012.html#cb137-3" tabindex="-1"></a>                   NomArrondissement <span class="sc">==</span> <span class="st">&quot;Arrondissement des Nations&quot;</span> <span class="sc">&amp;</span> </span>
<span id="cb137-4"><a href="sect012.html#cb137-4" tabindex="-1"></a>                   ECLAIRAGE <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>)</span>
<span id="cb137-5"><a href="sect012.html#cb137-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">nrow</span>(Requete3), <span class="st">&quot;enregistrements sélectionnés sur&quot;</span>, <span class="fu">nrow</span>(InstallS.join))</span></code></pre></div>
<pre><code>## 30 enregistrements sélectionnés sur 436</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="sect012.html#cb139-1" tabindex="-1"></a><span class="do">## Sélection des SR avec deux critères et un opérateur OR (|)</span></span>
<span id="cb139-2"><a href="sect012.html#cb139-2" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb139-3"><a href="sect012.html#cb139-3" tabindex="-1"></a><span class="do">## Sommaires statistiques sur deux champs</span></span>
<span id="cb139-4"><a href="sect012.html#cb139-4" tabindex="-1"></a><span class="fu">summary</span>(SR.RMRSherbDonnees<span class="sc">$</span>LoyerMoyen)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   570.0   679.5   729.0   768.4   847.5  1200.0</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="sect012.html#cb141-1" tabindex="-1"></a><span class="fu">summary</span>(SR.RMRSherbDonnees<span class="sc">$</span>ValeurMedLog)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  200000  235500  250000  272520  300000  476000</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="sect012.html#cb143-1" tabindex="-1"></a><span class="do">## Requête attributaire avec un opérateur OR </span></span>
<span id="cb143-2"><a href="sect012.html#cb143-2" tabindex="-1"></a>Requete4 <span class="ot">&lt;-</span> <span class="fu">subset</span>(SR.RMRSherbDonnees,</span>
<span id="cb143-3"><a href="sect012.html#cb143-3" tabindex="-1"></a>                   LoyerMoyen <span class="sc">&lt;</span> <span class="dv">700</span> <span class="sc">|</span> ValeurMedLog <span class="sc">&lt;</span> <span class="dv">250000</span>)</span>
<span id="cb143-4"><a href="sect012.html#cb143-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">nrow</span>(Requete4), <span class="st">&quot;enregistrements sélectionnés sur&quot;</span>, <span class="fu">nrow</span>(SR.RMRSherbDonnees))</span></code></pre></div>
<pre><code>## 27 enregistrements sélectionnés sur 50</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="sect012.html#cb145-1" tabindex="-1"></a><span class="do">## Sélection de différents types d&#39;installations sportives</span></span>
<span id="cb145-2"><a href="sect012.html#cb145-2" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb145-3"><a href="sect012.html#cb145-3" tabindex="-1"></a><span class="fu">unique</span>(InstallS.join<span class="sc">$</span>TYPE)</span></code></pre></div>
<pre><code>##  [1] &quot;Aréna&quot;                          &quot;Tir à l&#39;arc&quot;                   
##  [3] &quot;Pétanque&quot;                       &quot;Jeu de galets&quot;                 
##  [5] &quot;Planche à roulettes&quot;            &quot;Préau et plancher de danse&quot;    
##  [7] &quot;Patinoire à bandes mobiles&quot;     &quot;Surface, anneau ou étang glacé&quot;
##  [9] &quot;Patinoire à bandes fixes&quot;       &quot;Plage&quot;                         
## [11] &quot;Jeu d&#39;eau&quot;                      &quot;Piste multifonctionnelle&quot;      
## [13] &quot;Glissade sur tube&quot;              &quot;Jeu de fers&quot;                   
## [15] &quot;Piscine&quot;                        &quot;Tennis&quot;                        
## [17] &quot;Baseball&quot;                       &quot;Basketball&quot;                    
## [19] &quot;Football&quot;                       &quot;Volleyball&quot;                    
## [21] &quot;Ultimate frisbee&quot;               &quot;Pickleball&quot;                    
## [23] &quot;Soccer&quot;                         &quot;Jeu modulaire&quot;</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="sect012.html#cb147-1" tabindex="-1"></a><span class="do">## Requête attributaire avec un opérateur %in%</span></span>
<span id="cb147-2"><a href="sect012.html#cb147-2" tabindex="-1"></a>Requete5 <span class="ot">&lt;-</span> <span class="fu">subset</span>(InstallS.join,</span>
<span id="cb147-3"><a href="sect012.html#cb147-3" tabindex="-1"></a>                             TYPE <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Aréna&quot;</span>, <span class="st">&quot;Piscine&quot;</span>, <span class="st">&quot;Jeu d&#39;eau&quot;</span>))</span>
<span id="cb147-4"><a href="sect012.html#cb147-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">nrow</span>(Requete5), <span class="st">&quot;enregistrements sélectionnés sur&quot;</span>, <span class="fu">nrow</span>(InstallS.join))</span></code></pre></div>
<pre><code>## 26 enregistrements sélectionnés sur 436</code></pre>
</div>
</div>
</div>
<h3>Références</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-RBoldAir" class="csl-entry">
Apparicio, Philippe et Jérémy Gelb. 2022. <em>Méthodes quantitatives en sciences sociales : un grand bol d’R</em>. FabriqueREL, Licence CC BY-SA. <a href="https://laeq.github.io/LivreMethoQuantBolR/">https://laeq.github.io/LivreMethoQuantBolR/</a>.
</div>
<div id="ref-douglas1973algorithms" class="csl-entry">
Douglas, David H et Thomas K Peucker. 1973. <span>« Algorithms for the reduction of the number of points required to represent a digitized line or its caricature. »</span> <em>Cartographica: the international journal for geographic information and geovisualization</em> 10 (2): 112‑122. <a href="https://doi.org/10.3138/FM57-6770-U75U-7727">https://doi.org/10.3138/FM57-6770-U75U-7727</a>.
</div>
<div id="ref-visvalingam1993line" class="csl-entry">
Visvalingam, Maheswari et James D Whyatt. 1993. <span>« Line generalisation by repeated elimination of points. »</span> <em>The cartographic journal</em> 30 (1): 46‑51. <a href="https://doi.org/10.3138/FM57-6770-U75U-7727">https://doi.org/10.3138/FM57-6770-U75U-7727</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect011.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect013.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["GMQ405.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
